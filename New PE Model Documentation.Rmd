---
title: "DEPEMap: An axiomatic, distributionally explicit partial equilibrium model with endogenous adoption rate"
subtitle: |
  | (Working Paper)
author: Benjamin Schiek, Senior Research Associate, Bioversity-CIAT Alliance
#  - name: Benjamin Schiek, Senior Research Associate
#     email: b.schiek@cgiar.org
#     affiliation: Alliance Bioversity-CIAT
#     corresponding: b.schiek@cgiar.org
# email: b.schiek@cgiar.org
# address:
#   - code: Alliance Bioversity-CIAT
#     address: Alliance Bioversity-CIAT, Km 17 Recta Cali-Palmira, Valle del Cauca, Colombia, CP 763537
date: "`r Sys.Date()`"
abstract: |
  This is the abstract.

  It consists of two paragraphs.
bibliography: New PE Model.bib
biblio-style: apalike
header-includes:
  - \usepackage{framed}
  - \usepackage{setspace}\doublespacing
  - \usepackage{float}
  - \floatplacement{figure}{H}
  - \usepackage{amsmath}
  - \numberwithin{equation}{section}
output: 
  pdf_document:
    fig_caption: true
    number_sections: true
    latex_engine: xelatex
mainfont: Garamond
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE,
                      dev = c("png", "tiff"),
                      dpi = 300)

```

# Introduction

**Lack of confidence in ex-ante impact assessment tools.**

[@alston2000research]
[@alston2000meta]
[@pardey2016shifting]
[@alston2001attribution]
[@hurley2014re; @hurley2016returns]




In a comprehensive review of... Alston et al. note an "apparent paradox" whereby "Support for international research is dwindling despite seemingly strong evidence that it pays off handsomely" [-@alston2000meta].

<!-- "In recent years, a paradox has become apparent. On the one hand, we have an ever-expanding volume of what appears to be generally consistent evidence that rates of return to public agricultural R&D are high-high enough to justify past support and an even greater investment of public funds. On the other hand, we have seen in recent years in most countries, rich and poor alike, a marked slowdown, if not an actual decline, in public funding for agricultural R&D" [@alston2000meta]. -->


Alston and Pardey observed  [-@alston2001attribution].

Subsequently, proved prophetic ... Hurley et al. [-@hurley2014re; -@hurley2016returns] note a growing "disconnect" between donor funding levels and modeled rates of return to agricultural research. They concede that this is likely because donors have simply stopped believing the steady stream of ex-ante impact assessments reporting implausibly high estimates of returns---59.5% on average---to AR4D investments.

>"Agricultural R&D spending by the United States Department of Agriculture and state agricultural experiment stations was $4.1 billion in 2000. With an annual rate of return equal to the average internal rate of return of 59.5 percent, such an investment would be worth $56.3 quintillion ($56.3 x 1018) in 2050---a value that is more than 2.3 million times the projected size of the global gross domestic product in 2050" [@hurley2016returns].

Hurley et al. [-@hurley2016returns] propose to correct for any methodological flaw in the modeling by replacing the internal rate of return (IRR) calculation with the more conservative "modified IRR". While this is may be an improvement over the cartoonishly exaggerated estimates of AR4D returns, it is a cosmetic change that leaves unaddressed the underlying theoretical or methodological issues responsible for the unrealistic impact estimates in the first place.

...well known problems...a cavalier approach...a collection of preferences translated into mathematical equations, not a coherent theory derived from axioms...

Moreover, current methods shed no light on basic areas of confusion encountered again and again in strategic research discussions:
<!-- In AR4D discussions there frequently arise questions or confusion regarding: -->

-the difference betwen experimental yields versus economic yields
-ambiguous benefits of increased efficiency --> Adoption rates less than 100%
-tech backlogs, yield gaps
-which centiles adopt (distributional question). The predominant PE model used for parsimonious ex-ante impact assessment of agricultural research offers no insight into this question. The model authors dismiss the distributional question as irrelevant to agricultural research.
<!-- Currently available tools are inadequate to address these issues. -->

"Research can have significant distributional implications, but this need not mean that research should be directed to pursue distributional objectives." [@alston1995science]

"Agricultural research is conducted in the context of other economic and agricultural policies, but research is only one instrument of social policy, and most non efficiency-related [i.e. non-distributional] objectives  are  more effectively pursued using other policy instruments." [@alston1995science]

"Many economists view agricultural research as a blunt instrument for achieving nonefficiency objectives." [@alston1995science]

Most people working in the field today disagree with this opinion. Even at the time, research stemming from the green revolution was infused with a pro-poor mandate.

Pareto efficiency counts for very little in pro-poor development (Sen, 2001).

"An economy can be optimal in this sense even when some people are rolling in luxury and others are near starvation as long as the starvers cannot be made better off without cutting into the pleasures of the rich. If preventing  the burning of Rome would have made Emperor Nero feel worse off, then letting him burn Rome would have been Pareto-optimal. In short, a society or an  economy can be Pareto-optimal and still be perfectly disgusting." [@sen2017collective]

and characterized Pareto-optimality as "an extremely limited way of assessing social achievement" (Sen 1999).


The new agricultural paradigm...engine of pro-poor growth [@byerlee2009agriculture]. Evidence now abounds that of high inequality and growth being co-dependent rather than mutually exclusive or unrelated objectives [@berg2017inequality].

inconsistent with a long history of responding to the needs of resource-poor farmers (IR20, cassava, beans, etc., smallholder focus), and, more recently with new research perspectives that cast agriculture as a potential engine of pro-poor growth [@byerlee2009agriculture], and with studies showing that economic growth and equitability are two sides of the same coin [@berg2017inequality; @ostry2014redistribution; @berg2012makes]

In its very earliest days, in Mexico, the green revolution was unabashedly oriented towards relatively wealthy, commercial farms. This quickly changed in the 60s and 70s. Scientists developed varieties oriented towards relatively poor farms. Biofortification (vit. A defficiency, malnutrition, stunting, these are pro-poor issues)

.	Recent studies confirm that labor intensive, inclusive growth is much more sustainable than capital intensive forms of growth (based, for eg., on natural resource rents); i.e. pro-poor and pro-growth are "two sides of the same coin" (Berg & Ostry, 2011; Berg, Ostry, & Zettelmeyer, 2012; Dabla-norris & Kochhar, 2015; Ostry, Berg, & Tsangarides, 2014). Agri-food systems are naturally labor-intensive sectors with high participation from lower income centiles, and thus uniquely suited to drive such pro-poor, sustainable growth.
.	After a long period of "agricultural pessimism" and  "urban bias" which has viewed agriculture as the "handmaiden of industrialization", there is now talk of a "new agricultural paradigm" of sustainable, equitable growth (Byerlee, de Janvry, & Sadoulet, 2009; Byerlee, Diao, & Jackson, 2005; Lipton, 2006; von Braun, 2009).

An initiative of the International Food Policy Research Institute (IFPRI) in the early 2000s called "A 2020 Vision for Food, Agriculture, and the Environment" was instrumental in focusing research and development policy attention on a broad approach to the three critical issues of securing future world food needs, reducing hunger and poverty, and protecting the environment. It aimed at developing a shared vision and a consensus for taking action. The summary of an international consultation process identifies five priority areas for action: i) focus on inclusive growth; ii) improve access to assets and markets; iii) phase in social protection; iv) accelerate investments in health and nutrition pro-grammes; and v) include the excluded .  (VON BRAUN and PANDYA-LORCH, 2007)

-Anchor ending of intro in Alston quote characterizing progress on the modeling front as next to impossible. The presentation here is essentially one long disagreement with this pessimistic assessment. Economic theory can tell us quite a lot about the nature of the research induced supply curve shift, among other things, if one only takes a moment to derive these results from the assumptions. [rather than assert them in one big petito principii.] What has been lacking is the patience to do so.

**The math sloppiness question**

lack of rigor, cavalier approach

In 1944, Von Neumann and Morgenstern observed that "part of the feeling of dissatisfaction with the mathematical treatment of economic theory derives largely from the fact that frequently one is offered not proofs but mere assertions which are really no better than the same assertions given in literary form" [@morgenstern1953theory]. The authors go on to suggest there is a "scientifically unsound" inclination among economists to confuse these formalized literary assertions, including "very valuable surmises and inspiring anticipations of results", with proofs or otherwise rigorously derived theoretical results [@morgenstern1953theory]. More recently, Romer has similarly criticized the rise of "mathiness" in economic modeling.
<!-- "There is no point in using exact methods where there is no clarity in the concepts and issues to which they are to be applied" [@morgenstern1953theory]. -->
<!-- "the economic problems were not formulated clearly and are often stated in such vague terms as to make mathematical treatment _a priori_ appear hopeless because it is quite uncertain what the problems really are" [@morgenstern1953theory]. -->

"[The style that I am calling mathiness lets academic politics masquerade as science.] Like mathematical theory, mathiness uses a mixture of words and symbols, but instead of making tight links, it leaves ample room for slippage between statements in the languages of words as opposed to symbols[, and between statements with theoretical as opposed to empirical content]". [@romer2015mathiness]

The slippage ... to confuse results with assumptions (petitio principii), or, as in the case of the economic surplus model, to infuse a collection of contradictory and/or unfounded assertions with an air of rigor and coherence.

The "Economic Surplus" model, pioneered by Gilriches [] and polished by Alston etc. [], may be considered a case in point. The model is not theoretically derived, but rather a collection of educated guesses or surmises translated into mathematical equations. Many of these surmises imply well documented contradictions of basic economic theory, and/or inconvenient ramifications vis-a-vis the supposed benefits of research and technology adoption []. The model has evolved into its present form not by force of logic, but as a matter of preference. For example, there was considerable debate in the 1970s over whether the research-induced supply curve shift should be modeled as a parallel shift or a pivot [@alston1995science; @norton1981evaluating; @lindner1978supply]. The debate was further complicated by differing views as to whether supply should be modeled as a linear or a curved function. Without a theoretical framework to link parameter values and functional forms to real world conditions, the debate was ultimately inconclusive. The answers to the questions left unresolved by the debate have come down to us today as a matter of preference. In their highly influential book, _Science Under Scarcity_, Alston et al. indicated their preference for the linear parallel shift [-@alston1995science]. This is a conspicuous choice, to put it mildly, considering that 1) it prefigures research impacts in the best possible light, and 2) by the authors' own admission, there are no theoretical or empirical grounds to justify this preference [@alston1995science; @alston2009economics]. AR4D partial equilibrium impact studies since then have generally follow suit.

"There has been a great deal of discussion in the literature about the effects of different types of research-induced supply shifts on the size and distribution of research benefits, and rightly so. This choice in the  analysis is crucially important[, and by comparison, the choices about functional forms and elasticities pale into insignificance.] For example, given a linear supply function, total benefits from a parallel shift are almost twice the size of total benefits from a pivotal shift [(of equal size at the preresearch equilibrium)]. When supply shifts in parallel, producers  always benefit from research unless supply is perfectly elastic or demand is perfectly inelastic, and even in these extreme cases, producers are no worse off as a result of research. On the other hand, [as noted above,] with a pivotal shift, producers benefit only when demand is elastic; when demand is inelastic, producers necessarily lose from a pivotal supply shift...." [sci under scarcity]

-[the other problems] There is also the issue of using supply curve functions that imply a positive intercept on the quantity axis,    In a footnote, Alston et al. acknowledge that.homothetic preferences. It can be added that.homothetic output. There is also the issue of applying a static model to long periods. Alston et al. find that the research period typically lasts 10-15 years, followed by a period of uptake and diffusion which can last 40 years. Ceteris paribus assumptions regarding GDP and population growth, among other things, over such long periods strain credibility. In a recent priority setting "control trial", Petsakos et al. (2018) compared output based on the static economic surplus model with output based on the dynamic IMPACT sector equilibrium model which accounts for changes in exogenous growth parameters, finding that the ceteris paribus assumptions of the economic surplus model led to output that overstated benefits by two orders of magnitude. / To recap the issues covered so far, this means that, in order to implement the economic surplus method in good conscience, conscientious researchers are effectively asked to accept the following premises:
.	There are farmers who are willing to produce a certain quantity of their commodity for free
.	Engel's Law is wrong (and perhaps Bennet's Law too)
.	OR all farms in the population have equal net revenue
.	Farm output is likewise homothetic
.	OR all farms have equal operating budgets
[.	GDP and population (among other things) remain static across the research and uptake time horizon]
+Also: the mysterious research induced supply curve shift "k"



-This collection of formalized surmises, already problematic in its own right, is in turn rooted in a set of surmises with an even longer history of controversy known as consumer's and producer's surplus (or, collectively, economic surplus).

-The fallacious equity-(Pareto) efficiency tradeoff shaping much of the assertions.

-Incredulity-Incredulous results - donors now weary of the cavalier approach

In contrast to the cavalier approach, here I take an axiomatic...

there is evidence that donor patience with the cavalier approach has worn thin. 




-Well known issues: homothetic pref or identical farms, pivot or shift, negative quantities,  




On the nature of the research-induced supply curve shift-- "The matter has never been resolved satisfactorily" [alston sci under scarcity].

"When  supply  shifts  in  parallel,  producers  always  benefit  from  research unless supply is perfectly elastic or demand is perfectly inelastic, and even in these extreme cases, producers are no worse off as a result of research. On the other hand, as noted above, with a pivotal shift, producers benefit only when demand is elastic; when demand is inelastic, producers necessarily lose from a pivotal supply shift (e.g., Lindner and Jarrett 1978)" [sci under scarcity].


<!-- Many of these problems are well known to the method's advocates and community of practice. In particular, it is unclear whether research impacts are most accurately represented by a parallel shift in the supply curve or a pivot about the origin. A pivot raises the contentious issue of tradeoffs between producer and consumer welfare gains, including the possibility of welfare losses for producers. A parallel shift, on the other hand, entails no such controversy, but benefits are double what they are in the case of a pivot. Practitioners are advised to sidestep the distributional complexity of a supply curve pivot by assuming a parallel shift, but empirical evidence justifying this choice "has been elusive to date" (Alston, Pardey, James, & Andersen, 2009).  -->







Axiom 1: the law of diminishing marginal returns
Axiom 2: Farms want to maximize their net benefit subject to a budget constraint
Axiom 3: Upward sloping supply curves
Axiom 4: Downward sloping demand curves
Axiom 5: Farms will not enter the market if their expected net benefit is negative.
Axiom 6: The functional form of the relation between consumer output price and farm output price
Axiom 7: The farm yield density function
Axiom 8: The consumer demand density function
Axiom 9: The consumer percentage markup density function
, consumer yield/utility, [technology adjusted price ratio]

The meaning of consumer yield and technology adjusted price ratio become evident below.

For some reason, the task of aggregation is viewed as a mathematically intractable.

To precisely determine the supply curve shift
"What  does  economic  theory  tell  us  about  the  nature  of these  shifts? Unfortunately,  not  very  much.  To  be  confident  about  this  aspect  of the problem would require either (a) precise econometric evidence or (b) detailed information on the effects on individual agents, details of industry structure including details on exit and entry of firms, and a complete theory of aggregation. This information is not available; assumptions are unavoidable" (Alston, Norton, & Pardey, 1995).

(b) is sort of what I'm after here.

"Unfortunately, economic theory is not informative about either the func-
tional form of supply and demand or the functional form (parallel, pivotal, 
proportional, or otherwise) of the research-induced supply shift. The indus-
try curve is based on the aggregation of supply curves for individual firms. 
Shifts in the industry curve depend on the effects of new technologies on the 
marginal costs of existing firms and on entry and exit of firms. One would 
need to examine the characteristics of individual firms that affect marginal 
costs and technology adoption in order to predict which types of firms would 
benefit from  a particular new  technology.  In  addition, with current techniques and typically available data, it is not possible to settle these questions econometrically. We might hope to obtain plausible estimates of elasticities at the data means, but definitive results concerning functional forms are unlikely and it is impossible to get statistical results that can be extrapolated to the price or quantity axes (i.e., the full length of the function) with any confidence. Thus, assumptions about the nature of the research-induced supply shift are unavoidable. Our conclusion is that it is important to be aware of the consequences of different assumptions" (Alston & Norton, 1995).




"Decorative math" (Dietz Volrath) or, worse, "mathiness" instead of codifying tight links between one step of logic and the next, has been deployed to introduce logical "slippage" between links and between "." (2015). In the case of the  to confuse results with assumptions (petitio principii), or, as in the case of the economic surplus model, to infuse a collection of contradictory and/or unfounded assertions with an air of rigor and coherence.










in search of the green revolution i.e. hype vs reality

[CRITICAL FOR FINAL SECTION on what drives changes in production (a la Paarlberger's statement about increasing production of diamonds etc.):
The decrease in grain stocks during the 1960s was due to a specific price policy with that specific aim. This ended with the Agricultural and Consumer Protection Act of 1973, after which stocks increased again. So, stocks never decreased due to a real physical incapacity of the world to feed itself. Cite "Langley et al USDA ERS cica 1984 Commodity Program Perspectives.pdf" in the USDA Data subfolder. Parallel to this, in India stocks and production fell because of a lack of price incentives in favor of industrialization. Also, use Ending Stocks, not Beginning Stocks.]

Found an enthusiastic audience in Lyndon Johnson, who was eager to advance his Food for Peace program, and the fledgling USAID he had founded... the Foreign Assistance Program for FY 1968 passed the House by just 8 votes [@gaud1968green]....Under enormous pressure to make something of a sensation out of the 1967 harvest.  Johnson wanted to send a message to Congress "that there were people dying, that people were being hauled 
away dead in trucks, and that they needed food" [@cullather2010hungry]. ...[@brass1986political]...FFP [@ahlberg2007machiavelli]... The "near famine" in Bihar...but then this doesn't serve as an argument in favor of GR because later there was a worse famine in Maharashtra when GR was in full swing [@dyson1992bihar]. As far back as 1951, President Truman viewed food aid as a "diplomatic weapon" against the spread of "Communism" [@mcmahon1987food].
PL-480 passed in 1954, becomes "Food for Peace" in 1959 (all under Eisenhower), Kennedy then gave it a "philosophical and organizational overhaul" via executive order in the 1961 Foreign Assistance Act, by which USAID was created [@ahlberg2007machiavelli]



If there were substance to these claims, then we should expect to see a trend of steadily declining food production and/or availability per capita, especially in former colonies such as India. Paddock has such a graph in his book "Famine 1975!" [Paddock (1967) in @trumbo1969critFamine].



Also, the Bihar drought was called "unprecedented" [@dyson1992bihar], but in fact there were similar droughts during the El Nino events of 1918 and 1900 [@parthasarathy1994all],   The 1966 Bihar famine of food crisis disputed [@brass1986political; @cullather2010hungry; @dyson1992bihar]. The one fact is that there was a severe drought which resulted in lower staple grain production. Maharashtra drought of 1970-1973 70,000 excess deaths, while none in Bihar according to [@dyson1992bihar]. Cullather: "My project was soon complicated by recorded observations and experiences that refused to conform to this story" [@cullather2010hungry]. The President's report [@president1967world]. Johnson announced a "War on Hunger" in a special address to Congress on Feb. 10, 1966, in which he ordered the report [@johnson1966WarHunger]. In his 1967 State of the Union Address, Johnson called this the second most imporant..."Next to the pursuit of peace, the really greatest challenge to the human family is the race between food supply and population increase. That race tonight is being lost." [@johnson1967StateUnion].

#https://www.livemint.com/Politics/1BowYWLsVzTEy22b32FPMI/How-an-American-with-a-knack-for-math-saved-India-from-famin.html
#"How an American with a knack for Math saved India from Famine" 2015 (referring to Lester Brown, foreign policy aid to Orville Freeman, Johnson's Secretary of Agriculture)
Brown predicted a 10 million ton grain production shortfall for 1965-6. Article says the shortfall ended up being 18 million (only 77 million mt harvested vs. demand of 95 million--FAO says about 80 million). But this does not account for stocks.
Lester's account: 10 million mt of wheat, 1/5 of the US wheat harvest (but just 8% of total US wheat supply (production + stocks)), shipped to India in 1965 (600 ships total, about twice a day, sailing from Galveston and New Orleans, the largest shipment ever), "saving it" from famine. In order to pull off this unprecedented logistical feat, Freeman drew on logistical experts in USDA who had formerly served in the Army Quartermaster Corps in WWII [@brown2013breaking]. FAO says total India wheat imports (from all countries) in 1965 were 6.6 million mt, 7.8 in 1966, 7.5 in 1967.

South Asian grain stocks could have covered about 13 of the 15 million mt production shortfall; curiously, there was no draw down of these stocks during any of the crisis years (Figure USDA).

Immediately following independence from Great Britain, up to the eve of the green revolution, India pursued a policy of industrialization, during which her agriculture fell into a state of neglect and disrepair. Even so, per capita grain production did not stagnate, but grew during this period, even when taking into consideration the disastrous weather in 1951 and 1965-6 [@hatti1977impact].


PL-480 wheat shipments to India were about 2-4 million mt, except during the crisis years 1965-1967 when they surged to about 7.5 million mt per year. 


another facet of the claims to address: the ag frontier had expanded to its fullest extent (Paddock says something like this). In fact US gov had some 60 million has in reserve, and was paying farmers to plant less area... FAO land use data.

India rain series 1873-1993 [@parthasarathy1994all]

Famines [@davis2002late]:
1876-1879
India: 6.1-10.3 million
China: 9.5-13 million
Brazil: 0.5-1 million

1896-1902
India: 6.1-19 million
China: 10 million
Brazil: no data

1918 El Nino event + Spanish Flu [@giese20101918]:
Drought in India and 18 million deaths

1943-1945 Bengal famine
India: 3 million [@sen1981ingredients]



Under East India Company rule (1770-1858), famines on the Indian subcontinent were "frequent and severe" [@dreze1991political]. By 1878, a British statistician counted 31 serious famines in 120 years of British rule (including East India Company rule) versus 17 famines in the previous two milennia [Walford (1878) in @davis2002late].

If there were any substance to Neo-Malthusian scaremongering, then we should expect to see a trend of declining food production per capita, especially in former colonies like India. The data show the exact opposite. Food grain production per capita in India and Pakistan exhibits a trend of steady increase since the end of World War II up through the present 
[@kurosaki1999agriculture].


Most tellings of the green revolution consistently revolve around three central claims or plot points:

1) In 1960, much of the world stood on the brink of famine.

2) There was a dramatic increase in the production of key staple crops which averted said catastrophe.

3) The dramatic increase in production of key staple crops is exclusively (or almost exclusively) attributable to crop genetic improvement.

A fourth, ecological claim is sometimes added:

4) The dramatic increase in yields has spared countless millions of hectares of forest and pristine wilderness from being brought into agricultural production.
<!-- (Implies a fourth:  4) The green revolution was the "big bang" of crop genetic improvements.) -->

In Khush's telling [@khush2001green], for example, we are told that 

>"The 1960s was a decade of despair with regard to the world's ability to cope with the food-population balance, particularly in developing countries. Most of the lands suitable for agriculture in Asian countries had been cultivated while population growth rates were accelerating".

Khush cites Paddock's Malthusian diatribe in support of this view:

>"Ten years from now, parts of the underdeveloped world will be suffering from famine. In 15 years, the famines will be catastrophic, and revolutions and social turmoil and economic upheavals will sweep areas of Asia, Africa and Latin America" [Paddock (1967) in @khush2001green].

Moving on to plot points 2 and 3, Khush then says:

>"Fortunately, large-scale famines, and social and economic upheavals, were averted, thanks to the marked increase in cereal-grain yields in many developing countries that began in the late 1960s [plot point 2]. This phenomenon---known as the 'green revolution'---was due largely to the widespread adoption of technology that was developed to generate genetically improved varieties of crops with increased yields [plot point 3]" [@khush2001green].

Such accounts from the literature are then reflected in popular media versions. In 2016, a BBC article entitled "IR8: The miracle rice that saved millions of lives", told us:

>"It is thought that IR8 saved many millions of lives and transformed the lives of hundreds of millions of people.

>"Back in the 1950s it was obvious that Asia, home to half the world's population, faced an impending food crisis.

>"[Y]ou only needed to plot population growth against rice production to see that, within a few years, there would not be enough to go around.

>"IR8 was so much better than traditional rice varieties that its use spread rapidly throughout Asia and output soared. Famine was averted.
BBC News Dec. 1, 2016. https://www.bbc.com/news/world-asia-india-38156350

<!-- >"Most farmers benefited from the increases in productivity and the vast increases in output drove down prices, which benefited consumers" -->
Likewise with the other green revolution crop, wheat, one does not wander far before running into assertions such as the following:

>"In 1968, Swaminathan's work caused [India's] wheat harvest to soar from 12 to 17 million tons" [Dan Gardner "The nation killing famine that never was" National Post 13/10/2010 https://dangardner.ca/mnt/volume_tor1_01/www/spark/dangardner.ca/web/article/beware-the-overconfident-expert]

<!-- Monkombu Sambasivan Swaminathan -->
<!-- "In 1968, Swaminathan’s work caused the country’s wheat harvest to soar from 12 to 17 million tons". http://webarchive.loc.gov/all/20101013131843/http://fullcomment.nationalpost.com/2010/10/13/dan-gardner-the-nation-killing-famine-that-never-was/#ixzz6U9q3QwPR -->
For plot point 4, we turn to the father of the Green Revolution, Norman Borlaug:

>"Had the global cereal yields of 1950 still prevailed in 1999, we would have needed nearly 1.8 billion ha of additional land of the same quality--instead of the 600 million that was used--to equal the current global harvest" [@borlaug2002green].

The impression conveyed, then, is one of improved seed "causing" a tremendous increase in wheat and rice production, which saved a good portion of the world from starvation, and conserved countless hundreds of millions of hectares (\@ref(fig:greenRevNarrative)). There is no mincing of words over counterfactuals, attribution problems, or the role of policy and institutions. These narrators of the green revolution clearly intend to draw a direct line of causation from research to impacts.


It is as Paarlberger said. We can create a surplus of anything if the incentives are in place. South Vietnam achieved record levels of rice production in the very midst of war and rampant corruption thanks to artificially high producer prices set by the government and underwritten by USAID [@logan1971deep]. Fertilizer use doubled, tractors, irrigation pumps and gasoline engines and gasoline all on government credit. Even the Viet Cong allowed U.S. Army personnel free passage through the Mekong Delta so long as they were bringing IR8 seed to the farmers [http://books.irri.org/RT_Supplement-IR8.pdf].^[Thomas Hargrove, later worked at CIAT in Colombia, kidnapped by the FARC, etc.] Honda rice.

the Philippine Government asked the United States for an advance of $100 million on its 1970 payments (due it for our use of military bases) in order to "stave off the emergency" arising from threatened bankruptcy [@paddock1970green].

early appraisals of the GR, good awareness of the equally as important role of the enabling environment: [@falcon1970green; @wharton1969green; @borlaug1969green; @pinstrup1985impact; @sen1970opportunities; @dalrymple1975measuring]

"Simultaneously, while introducing the new varieties, [the scientists] must win the battle at top government policy levels for attractive grain prices, while assuring availability at reasonable prices of such inputs as fertilizer, insecticides, and water (pumps, motors, etc.)" [@borlaug1969green]. (p. 2)
Green revolution proponents like to focus on production. A doubling of production in just a few years is certainly a feat. But across longer time frames, changes in production are a poor metric of performance since it becomes difficult to tease apart how much of the increase is due to improved technology and how much due to the ever increasing number of farmers and area converted into agricultural land. Green revolution scientists are surely aware of this obvious consideration, and yet they can often be caught taking credit for virtually all of the increase in food grain production since the 1960s. Here again is Khush, for example:

>"It took almost 10,000 years for food grain production to reach 1 billion tons, in 1960, and only 40 years to reach 2 billion tons, in 2000. This unprecedented increase, which has been named the 'green revolution', resulted from the creation of genetically improved crop varieties, combined with the application of improved agronomic practices" [@khush2001green].

Over the same period, the world's population also doubled (from about 3 billion to 6 billion). The corresponding doubling of agricultural output is thus, prima facie, no more "unprecedented" than agriculture itself. Scientists must present us with compeling evidence of the extent to which this increase is greater than it would have been without their technological interventions. They may not simply assume this to be true.

gr in africa

criticism, Gates quote [@dawson2016green].

There's the AGRA launch paper, and then from the BMGF AGRA website:

>"For the past 50 years, these farmers have been struggling to grow more and healthier food for their families and earn more income from their farms. They face significant challenges that have led to lower yields, including climate change, outdated seeds that are not adapted to withstand today’s pests and tough growing conditions, and a lack of access to new technologies and crop information. These farmers also lack access to finance, and because they live in rural areas, they have trouble getting modern seeds and fertilizers that are usually sold in the cities".

https://www.gatesfoundation.org/Where-We-Work/Africa-Office/AGRA#{5A0565E0-2E48-472F-9DA6-8658B4B2FB93}

Again, the problem is construed primarily as one of access to technology. (Access is about finance, infrastructure...)




confusion over if/how tech benefits (small) farmers--or rather productivity increases due to tech vs increases due to economic factors

Well, Evenson and Gollin found that:

>"For all developing countries, MVs accounted for 21% of the growth in yields and about 17% of production growth in the early Green Revolution period [1961-1980]. Area expansion accounted for about 20% of the increases in production; the rest came from intensification of input use" [@evenson2003assessing]. Clarify that input use is actually the residual. Everson and Golling interpret it as input use, but it may also stand for the enabling environment. Input use itself is arguably a proxy for the enabling environment, given the hundreds of millions of dollars in subsidies that made their acquisition by farmers possible. 




On the other hand, the father of the green revolution, Norman Borlaug, called the enabling environment "equally as important as" the scientific breakthroughs. Here is the full statement, from his 1970 Nobel Prize acceptance speech:

>"[E]qually as important as the transfer of the new seed and new technology...was the introduction...of a crop-production campaign strategy. This strategy harnessed the high grain-yield potential of the new seed and new technology to sound governmental economic policy which would assure the farmer a fair price for his grain, the availability of the necessary inputs---seed, fertilizers, insecticides, weed killers, and machinery---and the credit with which to buy them. Collectively these inputs and strategy became the base from which the green revolution evolved" [@borlaug1972norman].

Such things are not often heard today, and may even be considered controversial by some. But they were obvious to the key actors in the early days of the green revolution. USDA Chief Economist Don Paarlberg, in 1963:

>"This is the inescapable fact---that a price artificially held above the competitive level will stimulate production, retard consumption and create a surplus.... It is the product of human institutions, not simply a consequence of rapid, technological advance. It may or may not be accompanied by a scientific revolution. We could create a surplus of diamonds or uranium or of avocadoes or rutabagas simply by setting the price above where the market would have it and foregoing [sic] cost production control. A surplus is not so much a result of technology as it is a result of intervention in the market." (Paarlberg 1963 [in @paddock1970green]).



Such things are not often heard today, and may even be considered controversial by some. But they were obvious to the key actors in the early days of the green revolution. USDA Chief Economist Don Paarlberg, in 1963:

>"This is the inescapable fact---that a price artificially held above the competitive level will stimulate production, retard consumption and create a surplus.... It is the product of human institutions, not simply a consequence of rapid, technological advance. It may or may not be accompanied by a scientific revolution. We could create a surplus of diamonds or uranium or of avocadoes or rutabagas simply by setting the price above where the market would have it and foregoing [sic] cost production control. A surplus is not so much a result of technology as it is a result of intervention in the market." (Paarlberg 1963 [in @paddock1970green]).

In hearings on the Foreign Assistance Act of 1968, USAID Director William Gaud---the man who coined the term "green revolution"---was likewise at pains to assert the fundamental importance of the economic and institutional context:

>"[W]e have to keep in mind, I think, that it is impossible for the agricultural sector of any country's economy to grow, unless the entire economy is growing. The farmers can't buy fertilizer, they can't buy pesticides, they can't buy herbicides, they can't buy new seeds, unless the economy of the country is strong enough, or unless they have the resources to import these inputs.

>"At the same time, if the farmer produces more food, as we hope he will, there has to be an effective demand for that food at prices which are profitable for the farmer. By effective demand, I mean not that the people in a country must need more food, but that they must have the money to buy it. Their incomes must be high enough to buy it, and that means a healthy economy.

>"By the same token, if you expect a farmer to grow more food, he has got to have something on which to spend the money he makes for growing and selling it. He has got to be able to buy consumer goods. He has got to be able to buy things he did not have before. He has got to have an incentive to increase his income, and this again means a healthy economy, across the board" [@HearingOnFAAct1968].

The Chair of the Foregin Affairs Committee, Representative Thomas Morgan (D-PA), then engaged Gaud on this issue:

>"In the past, members of this committee have found that there were cases where assistance was applied to agriculture under the foreign assistance program, but the operation was frustrated because the farmers in that particular country were discouraged by price structure, or by a system of taxation, or by the system of collecting the rents.

>"These farmers really had no inducement to adopt improved methods, because they derived very little from their increased production.

>"Now we are financing this year the construction of fertilizer plants, and we plan to finance the shipment of millions of dollars worth of fertilizer. What measures do we take to determine in particular countries...whether these farmers will be ready to increase production?

>"Can you cite any cases where reforms in price structure or tax structure have actually occurred in any particular country where we have financed major programs?" [@HearingOnFAAct1968]

To which Gaud responded:

>"Yes, sir; I can cite several cases offhand. The Philipines, for example. I think it is generally agreed that one of the most important factors in the Philippines was a change in price policies in favor of the farmer.... All observers of the Philippine situation gave this change primary credit for providing the incentive to the Philippine farmer to grow more rice.

>"In Chile, there is a somewhat comparable situation. You have got problems of land tenure, and you have problems of pricing. We are making loans, agricultural sector loans to Chile, to help the Chilean Government achieve reforms which will give the farmer a greater incentive.

>"In India, we have been using our Public Law 480 and our fertilizer loans, and also giving technical assistance, in an effort to achieve changes in agricultural policy. One, the allocation of greater resources to the Government to agriculture rather than to industry. Two, a change in the pricing system, so that a greater incentive is provided to the producer. Three, agricultural credit, so that the farmer will be able to buy the fertilizer..." [@HearingOnFAAct1968].

Maybe mention vietnam/hargrove here too.

A few days after his congressional testimony, Gaud gave the famous speech wherein he coined the term "green revolution"; and wherein he affirmed once more:

>"To the farmer, the new seeds and fertilizer represent an untried and expensive investment. The high yields of IR-8 [rice] depend on a combination of intensive labor and materials which makes it four times as costly to grow as ordinary rice. Only when the farmer sees that the added investment will increase his profit will he give them a try....

>"The higher investments required by the new agriculture also make farm credit essential. In the Philippines, many of the IR-8 rice kits have been distributed on credit extended by private rural banks receiving A.I.D. support. Similarly, Turkish farmers now get high-yield seed on credit. And to get seed on credit, they must also take the necessary amount of fertilizer on credit.

>"Farmers are responding to these new opportunities. In Pakistan where they have never before paid a premium for seeds, they are now doing so. They want the high-yield varieties. There have been reports of seed riots in India. At times the demand for fertilizer in India has been strong enough to create a black market" [@gaud1968green].



[@morris2007fertilizer; @lipton2005family; @lipton2010policy]

>"[L]arge increases in staple food productivity would do little to cut mass dollar poverty if they were confined to large-scale farms, using tractors and combines but few workers, and selling at government-boosted prices that the underemployed and near-landless poor cannot afford.

>"The Green Revolution not only increased the supply of locally available staples but also the demand for farm labor, wage-rates, and thus the work-based income of the dollar-poor. The lesson for future crop science policy is clear. When choosing among research paths, a high employment share in extra science-induced farm income should normally be seen as a gain. For countries where the dollar-poor lose out if the demand for farm labor declines, aid-backed farm research should not support better combines, herbicides, mechanical transplanters-or varieties whose advantages depend on these-unless the results can beshown to be cost-effective ways to cut poverty" [@lipton2005family].

Confusion on this point: "When food production rises through...increases in land and labor productivity, the rural poor gain" [@toenniessen2008building]. (AGRA launch paper)

Such a narrative invariably prefigures policy recommendations towards "more funding for more research for more productivity" (as in for eg. [@jayne2010principal; @lipton2005family; pardey2013public]. Low adoption rates and yield gaps, meanwhile, are prefigured as a sort of mystery that is outside the purview of scientific responsibility to explain—and/or evidence of the need for more funding for more genetic gain ().
Always conclude more money for more crop genetic improvement research (the "bread and butter" of the CGIAR) [@renkow2010impacts].[@jayne2010principal; @lipton2005family; pardey2013public]

"[W]e believe it is reasonable to conclude that while NRM and policy research in the CGIAR remains under-evaluated, CGI research has nonetheless produced substantially larger net benefits. Given these uncertainties and the very strong record of positive impact attributable to CGI, it would appear that the CGIAR's port-folio of research allocations has become overly skewed toward NRM and policy research over time. Thus, a move toward restoring somewhat the share of resources allocated to CGI would seem warranted. In fact, this seems to be happening as the Bill and Melinda Gates Foundation have sharply stepped up their funding of CGIAR research, mostly in the area of CGI" [@renkow2010impacts].

The key phrase here is "the very strong record of positive impact attributable to CGI". Serious grounds for doubt.

>"Underlying all this is the need to reverse the recent downgrading of economic analysis in some CG institutions (and, even more important, to remedy its near absence from some key ones in NARSs) and to redirect such skills away from ex post complaining about research results toward direct involvement, alongside natural scientists, in research-planning choices" [@lipton2010policy].

The aim of research is multi-dimensional. Genetic gain (i.e. yield growth) cannot be the "holy grail" of research, as it has been and continues to be. Conway proposes four dimensions: Productivity (genetic gain), Stability ("the degree to which productivity remains constant in spite of normal, small-scale fluctuations in environment variables, such as climate, or in the economic conditions of the market."), Resilience ("the ability of a system to maintain its productivity when subject to stressor shock.") [@conway2007doubly].

Asking scientists to expand their purview beyond the lab and field trials is just to say: (is consistent with emerging holistic views on agricultural innovation as a system)
>"[P]roduction and exchange of (technical) knowledge are not the only prerequisites for innovation. Several additional factors play a key role, such as policy, legislation, infrastructure, funding, and market developments" [@klerkx2012evolution].

>"[A]gricultural innovation is not an inherently good and value free process, but normatively laden and driven by different worldviews and visions. Correspondingly, different development directions exist, each with its own winners and losers" [@klerkx2012evolution].

For example, big capital intensive farm or small labor intensive farm? Consumer or producer support? These fall roughly into two camps, SAI AEI [@mockshell2018beyond]. We have examples of both in places like Brazil [@rada2019agricultural; @rocha2012small]. These tradeoffs are never discussed in AR4D communities....SDGs, IFPRI 2020 Vision, PRSPs, etc. A shift in attitude that places smallholder livelihoods at the center (cue the Gates AGRA quote); a “new agricultural paradigm” (Byerlee 2009) arising from the ashes of the anti-poor Reagan-Thatcherite "Structural Adjustment" nihilism of the 1980s and 1990s [@easterly2000effect;@easterly2005national;@eicher1998international].

[@morris2007fertilizer; @lipton2005family; @lipton2010policy]


land sparing issue

Pingali revises this upward [-@pingali2012green] says 30% increase in area under cereal cultivation in developing countries between 1962 and 2012.

Borlaug once remarked that the green revolution had saved 1.8 billion hectares     FAOSTAT in fact shows nearly a 100% increase.---possibly due in part to a redefinition at FAO of "developing countries" between now and the time Pingali wrote his paper (8 years ago).

"Had the global cereal yields of 1950 still prevailed in 1999, we would have needed nearly 1.8 billion ha of additional land of the same quality – instead of the 600 million that was used – to equal the current global harvest" [@borlaug2002green]. He then revised this downward to 1.2 billion vs. 600 million [@borlaug2007feeding].

17.9 to 26.7 million hectares more [@stevenson2013green]

Gollin says only a 3%-5% increase in cropland under the No-green revolution counterfactual [@evenson2003assessing].

>"[The] Green Revolution...has doubled global food production on only 10% additional land area over the past 30 years or so" [@may2007theoretical].

>"Although populations had more than doubled [in developing countries from 1962 to 2012], the production of cereal crops tripled during this period, with only a 30% increase in land area cultivated" [@pingali2012green].


(99757069 - 50490961) / 50490961

"Between 1960 and 2000, yields for all de-veloping countries rose 208% for wheat,109% for rice, 157% for maize, 78% forpotatoes, and 36% for cassava", says Pingali [-@pingali2012green], citing a 2003-2004 FAO annual report [@fao2003stateFoodAg]. The "Developing Countries" category is no longer maintained by FAO, but a query for the "Least Developed Countries" indicates that...


Title: "The Green Revolution Arrives in Africa"
From the abstract:
>"The Green Revolution that brought advances in crop genetics to Asia and Latin America completely bypassed the African continent. Africa's smallholder farmers finally joined the movement in 2006, when the Bill and Melinda Gates Foundation joined the Rockefeller Foundation to create the Alliance for a Green Revolution in Africa" [@blaustein2008green].

Oh really? Well, in fact there was a green revolution in Africa prior to the revolutions in Asia and Latin America [@eicher1995zimbabwe].

"For Africa,... the limiting factor...is not the genetic yield potential of the crops currently being grown. The problem is that so little of their genetic yield potential is realized due to poor soils and crop losses" [@blaustein2008green].

The Malthusian outlook implies a _noblesse oblige_ mindset.... What are we going to do with all these additional people? But additional human beings are assets, not liabilities. Additional human beings means more brains and brawn, more teachers, more human capital, more partners... We must look at our new companions as assets, not liabilities. as partners in our project to live sustainably on planet Earth.

>"(i) the IARC should take aleading role in developing improved varieties such as the MV1 and MV2 types;(ii) the varietal research collaboration between IARC and NARS should be strengthenedand intensified; (iii) the NARS should play an active role in developing location-specificvarieties such as the MV3; and (iv) the application of fertilizer, be it chemical ororganic, must be increased to realize yield potential of MV" [@otsuka2006rice]. 

Twelve years later, a more qualified version: "Much of the success was caused by the combination of high rates of investment in crop research, infrastructure, and market development and appropriate policy support that took place during the...Green Revolution" [@pingali2012green].

"In many developing countries of Asia and Latin America, the genetic improvement of staple food crops, combined with complementary agronomic practices, supportive policies, and strengthened institutions, enabled overall food production to keep pace with population growth while both more than doubled" [@toenniessen2008building].

So now in this version a certain lip service is paid to the enabling environment, but the authors of this narrative clearly intend to leave the reader with the impression that the breeding science is the single driving force behind this increase.

policy/enabling environment

Rodrik observed that "the function that good institutions fulfil (about which we have a fairly good idea) do not map into unique forms (about which we know a lot less)"

[Pet 2: During the green revolution in Asia, "good policy and institutions" meant, evidently, a) massive government credit, subsidy, and price control programs, b) an eagerness to achieve self-sufficiency in rice production as a matter of national security, c) a dictatorial legal environment in which governments could easily assert their will over the objections of private sector actors (fertilizer companies) who lost out, and d) a fledgling USAID under congressional pressure to do something spectacular or lose funding, and hence eager to underwrite the otherwise fiscally unsustainable public programs. In today’s prevailing intellectual winds, of course, (a)-(d) are very nearly the exact hallmarks of bad policy and institutions. They were attractive at the time because they resonated with a conventional wisdom in which cold war fears of communist insurrection featured prominently, together with a Keynesian appetite for heavy-handed government intervention in the marketplace.

It involves taking up positions on a range of hotly debated issues. Does good policy mean public sector involvement? For which income percentiles? Does it come with trade liberalization? Does it mean removing safety nets? Is there a role for indigenous cooperative mechanisms and other forms of social capital? What is the relation between economic growth and poverty? The "correct" answers to these questions, to paraphrase Foucault, are "a thing of this world" ().


malthusian scaremongering malthusian pall

even relatively recently: "By the year 2020, there will be about an extra 1.5 billion mouths to feed. If the proportion of the population of the developing countries deprived of an adequate diet remains the same, the number undernourished 20 years from now could be well over one billion" [@conway1999food]. In fact it is at 820 million, down about 30 million from the 2000 level.


who are the stakeholders?

Stakeholder representation scientists, research director, government policymakers, highly influenceable by agribusiness. "i.e. the research directors, agricultural research boards, or other policymakers who are the 'clients' for the work" (Alston & Norton, 1995) "Typically, the preferences of research system directors, agriculture or finance ministry officials, or agricultural research system boards or councils, are deemed the most relevant in this regard" (Norton et al., 1992). Politically weighted average of vested interests, where the voice of the smallholders-who are the ostensible beneficiaries of the research-is given the smallest weight. 


Pingali CIMMYT yield gap paper "Farmer's maximize profit, not yields."

(In Philippines masagana 99) Smith found that the increase in production was mostly due to an increase in planted area, not an increase in yield [-@smith1989palay].


[Ingrid Palmer 1972, United Nations Research Institute for Social Development (UNRISD) Report No. 5.; UNRISD studies on the "green revolution" No. 72.9.]

# Derivation of the yield function from Axiom 1 (diminishing marginal returns)

Throughout much of written history, astute observers have noticed that the usefulness of increments in the quantity of an input (in the case of producer yield functions) or good or service (in the case of consumer utility functions) is inversely proportional to amount of the input or good or service already acquired [@kauder1953genesis]. In 1738, Daniel Bernoulli put it this way:

>\singlespacing "In the absence of the unusual, the utility resulting from any small increase in wealth will be inversely proportionate to the quantity of goods previously possessed" [@bernoulli1954exposition].

\doublespacing

Today, this is known as the "law of diminishing marginal returns".

\begin{framed}
   \textbf{Axiom 1} \\ The law of diminishing marginal returns.
\end{framed}

Formalization of Bernoulli's verbal statement of the law of diminishing marginal returns depends upon how one defines "small increase". If "small increase" means a marginal increase, then Bernoulli's statement can be written down as follows.^[Bernoulli himself could not have had "marginal increase" in mind per se, as calculus had not yet been invented.]

\begin{equation}
\frac{\partial \ln(y)}{\partial x} \sim \frac{1}{x}
\label{eq:dimUtilDefine}
\end{equation}

Where, to be clear, the term $\partial \ln(y) / \partial x$ is the percentage change in utility given a marginal increase in the quantity of good $x$, and "$\sim 1 / x$", means "inversely proportionate to the quantity of good $x$ already acquired". An expression $y(x)$ for the yield of good $x$ can then be obtained by integrating Bernoulli's statement.

\begin{equation}
\begin{split}
\int \frac{\partial \ln(y)}{\partial x} \: dx &= \int \alpha \frac{d \ln(x)}{dx} \: dx \\
\ln(y(x))  &= \alpha \ln(x) + k \\
y(x) &= e^k x^{\alpha}
\end{split}
\label{eq:integrate_lny}
\end{equation}

Where the proportionality constant $\alpha = \partial \ln(y)/ \partial \ln(x)$ is the input elasticity of yield, i.e., the percentage change in yield given a $1$ percent increase in input $x$.

In the multivariate case, an expression $y(\mathbf{x})$ for yield as a function of a vector of $n$ goods $\mathbf{x} = [x_1,x_2,...,x_n]$ can be obtained as follows.

\begin{equation}
\int \nabla_{\mathbf{x}} \ln(y) \cdot d \mathbf{x} = \int D(\boldsymbol{\alpha}) \nabla_{\mathbf{x}} \ln(\mathbf{x}) \cdot d \mathbf{x}
\end{equation}

\begin{equation}
\begin{split}
\ln(y(\mathbf{x})) &= \boldsymbol{\alpha} \cdot \ln(\mathbf{x}) + \alpha_0 \\
y &= e^{\alpha_0} \prod_i x_i^{\alpha_i}
\end{split}
\label{eq:cobbDoug}
\end{equation}

where $\boldsymbol{\alpha}$ is the vector of input elasticities corresponding to each $x_i$, the notation $D(\boldsymbol{\alpha})$ indicates a diagonal matrix with the elements of $\boldsymbol{\alpha}$ along its diagonal, and

\begin{equation}
\nabla_{\mathbf{x}} \ln(y) = \left[ \begin{matrix} \frac{\partial \ln(y)}{\partial x_1} \\
\frac{\partial \ln(y)}{\partial x_2} \\
\vdots \\
\frac{\partial \ln(y)}{\partial x_n}
\end{matrix} \right]
\end{equation}

Equation \ref{eq:cobbDoug} is well-known to economists as the Cobb-Douglas form. As mentioned above, this result depends on a definition of small increase as a marginal increase. Other forms result from other definitions of small increase. If small increase is defined as a percentage increase, for example, a functional form involving Lambert's W function results (left as an exercise for the reader). The Cobb-Douglas function is selected from among these two choices on empirical grounds. (The Cobb-Douglas function is famous for how well it fits economic data across many contexts and scales.)

[Some object to the Cobb-Douglas (log-log) model because they think it ignores dependencies between inputs [ref?]. This untrue because the log-log model is homogenous. By the definition of homogeneous fn the cross effects are implicitly included. I.e.,

\begin{equation}
\nabla^2 f \mathbf{x} (h - 1) = h \nabla f
\end{equation}
]

In an actual analysis, exogenously given control variables ($k_i$) are usually included in the model. These typically include demographic variables such as age, education, household size, as well as agroclimatic variables such as temperature, precipitation, soil attributes, and so forth. In some cases the $k_i$ might also include cell phone coverage, distance to input and/or output markets, distance to nearest paved road, and so forth. It really just depends on what data is available. Analysis is said to be "ceteris paribus" when these variables are held constant at a particular value across the population. Equation \ref{eq:cobbDoug} is thus henceforth rewritten as follows.

\begin{equation}
y = y_0 \prod_i x_i^{\alpha_i} \prod_i k_i^{\kappa_i}
\label{eq:cobbDoug2}
\end{equation}

where the $\kappa_i$ are the control variable elasticities of yield. Note that, by Axiom 2, the input elasticities $\alpha_i$ must be positive. (Farmers will not apply an input if it reduces yield.) But the control variable elasticities $\kappa_i$ may be positive or negative.

Address Antle's objection? Look to Just and Pope

In equation \ref{eq:cobbDoug2}, the shorthand $y_0 = e^{\alpha_0}$ has also been introduced. The scale factor $y_0$ is the yield when inputs $\mathbf{x}$ are set to 1 and the control variables $\mathbf{k}$ are also set to 1. It may thus be interpreted as the "unit input yield" or "unit input ceteris paribus yield", to be more precise. "Basal yield" is henceforth used as a shorthand.

Many economists prefer to call $y_0$ the "total factor productivity" (TFP). This is because $y_0$ equals, in some sense, the "yield per unit all inputs" when it is isolated on one side of the equation. However, the presence of control variables complicates this interpretation. Moreover, TFP implies bizarre and rather useless units of measurement. For example, if the inputs $x_i$ are labor and pesticide, while the control variables $k_i$ are rainfall, temperature, and farmer age, then the TFP $y_0$ has units of kg hectare$^{-1}$ manhour$^{-1}$ liter$^{-1}$ millimeter$^{-1}$ degree Celsius$^{-1}$ years$^{-1}$, each of which is raised to various exponents (the respective elasticities $\alpha_i$ and $\kappa_i$). Because of the exponents, a more accurate name for TFP would be the "technology adjusted total factor productivity".

Nonetheless, a very mature literature has developed around TFP, and the reader is encouraged to continue thinking of $y_0$ in terms of TFP if that is what they are most comfortable with. The "basal yield" interpretation is merely provided here as an alternative for those of us who wrestle with the idea of TFP or are not yet familiar with it.
<!-- exogenously given control variables like age, soil quality, or climate variables. -->

TFP vis-à-vis dimensional analysis
The (in)famous residual
“The rate of growth of total factor productivity is defined as the difference between the rate of growth of real product and the rate of growth of real factor input” (Jorgenson & Griliches, 1967). This definition violates dimensional analysis.
Given a yield function
y=Kx_1^(α_1 ) x_2^(α_2 )…x_n^(α_n )	(1)



"TFP"=K=y/(x_1^(α_1 ) x_2^(α_2 )…x_n^(α_n ) )	(2)


There are two problems with this expression from the point of view of dimensional analysis. First of all, the units in which “TFP” is expressed are impossible to make sense of. Say n=4, with x_1 standing for labor, x_2 for machinery, x_3 for fertilizer, and x_4 for pesticide. Then TFP has units of production per unit
area (man hour)^(α_1 ) (machine hour)^(α_2 )  (weight)^(α_3 )  (volume)^(α_4 )	(3)


The second, more serious, problem is that these units will always vary from one data set to another. Even if the variables x_1,x_2,…,x_n are the same across studies, and are expressed in the same units, the units in which the “residual” K is expressed will nonetheless vary because the estimated parameters α_i vary. It is therefore impossible to make meaningful comparisons of K across data sets.
On the other hand, it is possible to make meaningful comparisons of the residual in another sense. Define the parameter K as follows:
K=k/(x ̃_1^(α_1 ) x ̃_2^(α_2 )…x ̃_n^(α_n ) )	(3)


Where the x ̃_i are arbitrarily chosen reference values. Then the yield equation becomes:

y=ku_1^(α_1 ) u_2^(α_2 )… u_n^(α_n )  ;  u_i=x_i/x ̃_i 	(3)


It now becomes clear what the units of k are. Each x ̃_i has the same units as its respective x_i. This means that all of the u_i^(α_i ) terms on the right hand side of the equation are dimensionless. Therefore, the units of k must agree with the units of whatever is on the left hand side, which happens to be yield. 
k=y/(u_1^(α_1 ) u_2^(α_2 )… u_n^(α_n ) )	(5)


When interpreted in this way, it is now possible to make meaningful comparisons of the residual across data sets (if the reference values x ̃_i are harmonized across the data sets). However, the residual now has units of productivity with respect to land only, and not with respect to any other factor, much less the “total factor”.
Conclusion
Above I have shown that TFP (equation 2) is measured in units which 1) are virtually impossible to make sense of, and 2) cannot be compared across data sets. I have shown that it is possible to express the residual in straightforward units that are comparable across data sets, but that these are units of land productivity only. The residual may be interpreted as TFP only at the cost of nonsensical units and cross-study incompatibility. A residual with sensible units and comparability, on the other hand, comes at the cost of expressibility only in units of a single factor’s productivity—land in the case of farms, widget factories in the case of firms.



# Derivation of the yield envelope from Axiom 2 (net benefit maximization)

[The Cobb-Douglas function is frequently eschewed for a perceived lack of theoretical basis... It has persisted because of its strong empirical fit across contexts. It essentially an empirical law, like Engel's Law or Bennet's Law...]

Equation \ref{eq:cobbDoug2} captures yield response to inputs and control variables in accordance with Axiom 1, the law of diminishing marginal returns.

The next step in the theoretical derivation of the partial equilibrium model is based on the assumption that farmers want to maximize their net benefit subject to a budget constraint. (Consumers and firms on the demand side are assumed to be similarly motivated, but the present section focuses on the supply side.)

\begin{framed}
   \textbf{Axiom 2} \\ Farms, as well as firms and consumers on the demand side, maximize their net benefit subject to a budget constraint.
\end{framed}

Axiom 2 implies that farmers apply inputs such that revenue is maximized, given a budget constraint. The problem of finding the optimal input quantities that achieve this goal can be formalized as follows.

\begin{equation}
\max_{\mathbf{x}} Py \:\:\: s.t. \:\:\: C \leq B
\end{equation}

where $P$ is the output price, $B$ is the farmer's budget, $C$ is the cost function, defined

\begin{equation}
C = \mathbf{w} \cdot \mathbf{x}
\end{equation}

and $\mathbf{w}$ is the vector of input prices corresponding to each input in $\mathbf{x}$.

The Lagrangian is then

\begin{equation}
\mathcal{L} = Py - \lambda (C - B)
\end{equation}

Where $\lambda$ is the farm budget shadow price, that is, the marginal benefit to the farm of a marginal increase in budget.

\begin{equation}
\frac{\partial \mathcal{L}}{\partial B} = \lambda
\end{equation}

The first order conditions for a maximum work out to:

\begin{equation}
\nabla_{\mathbf{x}} \mathcal{L} = Py D(\mathbf{x})^{-1} \boldsymbol{\alpha} - \lambda \mathbf{x} = \mathbf{0}
\label{eq:eqFOC}
\end{equation}

Where the $\mathbf{0}$ indicates a vector of zeroes equal to the length of $\mathbf{x}$. This is then solved for the optimal input levels $\mathbf{x}^*$.

\begin{equation}
\mathbf{x}^* = P y^* / \lambda D(\mathbf{w})^{-1} \boldsymbol{\alpha}
\end{equation}

Or, alternatively,

\begin{equation}
x_v^* = \frac{P y^* \alpha_v}{\lambda w_v}
\label{eq:inputDem1}
\end{equation}

The optimal yield, or yield envelope, or economic yield, $y^*$ is then found by evaluating $y$ at $\mathbf{x}^*$.

\begin{equation}
y^* = y(\mathbf{x}^*; y_0, \boldsymbol{\alpha}, \mathbf{k}, \boldsymbol{\kappa}) = y_0 \prod_i \left(\frac{P y^* \alpha_i}{\lambda w_i} \right)^{\alpha_i} \prod_i k_i^{\kappa_i}
\end{equation}

Taking logs and factoring out $\ln (P y^*/\lambda)$,

\begin{equation}
\ln(y^*) = \alpha_0 + \ln \left(\frac{P y^*}{\lambda} \right) \sum_i \alpha_i + \sum_i \alpha_i \ln \left(\frac{\alpha_i}{w_i} \right) + \sum_i \kappa_i \ln(k_i) 
\end{equation}

But note that, by Euler's homogenous function theorem,

\begin{equation}
\sum_i \alpha_i = h
\end{equation}

where $h$ is the degree of homogeneity of $y$. Hence the previous equation can be rewritten

\begin{equation}
\ln(y^*) = \alpha_0 + h \ln \left(\frac{P y^*}{\lambda} \right) + \sum_i \alpha_i \ln \left(\frac{\alpha_i}{w_i} \right) + \sum_i \kappa_i \ln(k_i) 
\label{eq:eulerInvokd}
\end{equation}

Solving for $\ln(y^*)$,

\begin{equation}
\ln(y^*) = \frac{1}{1 - h} \left(\alpha_0 + h \ln \left(\frac{P}{\lambda} \right) + \sum_i \alpha_i \ln \left(\frac{\alpha_i}{w_i} \right) + \sum_i \kappa_i \ln(k_i) \right)
\end{equation}

And taking the exponential function of this then gives the yield envelope.

\begin{equation}
y^* =  \left(y_0 \left(\frac{P}{\lambda}\right)^h \prod_i \left(\frac{\alpha_i}{w_i}\right)^{\alpha_i} \prod_i k_i^{\kappa_i} \right)^{\frac{1}{1 - h}}
\label{eq:YdEnv1}
\end{equation}

Economic yield is thus a function of:

1) Input prices $\mathbf{w}$

2) The output price $P$

3) The input elasticities of yield $\boldsymbol{\alpha}$ (i.e. the technology)

4) The control variables $\mathbf{k}$

5) Their control variable elasticities of yield $\boldsymbol{\kappa}$

6) The farm budget shadow price $\lambda$

To reduce notational clutter, the yield envelope is henceforth rewritten as follows.

\begin{equation}
y^* = \left(y_0 \left(\frac{P}{\lambda} \right)^h \frac{\beta_x \beta_k}{\beta_w} \right)^{\frac{1}{1 - h}}
\label{eq:YdEnvCompact}
\end{equation}

Where the following shorthands have been introduced:
<!-- r &= \frac{P^h}{\beta_w} \:\:\:; \:\: \beta_w = \prod_i w_i^{\alpha_i} \\ -->

\begin{equation}
\begin{split}
\beta_w &= \prod_i {w_i}^{\alpha_i} \\
\beta_x &= \prod_i {\alpha_i}^{\alpha_i} \\
\beta_k &= \prod_i {k_i}^{\kappa_i}
\end{split}
\end{equation}

The steps followed above more or less align with the standard derivation of the Cobb-Douglas yield envelope found in textbooks, with the important exception of the invocation of Euler's homogeneous function theorem in equation \ref{eq:eulerInvokd}.

Note that the cost minimization problem gives the same result...

## The degree of homogeneity and output price elasticity of yield \label{sec:degHomog}

[The costStar^h  formulation of yield envelope]

[Put "certain useful elasticities/expressions" here maybe]

By invoking Euler's theorem in the derivation of the yield envelope above, the yield degree of homogeneity $h$ is made explicit in the yield envelope; and this lays bare some interesting critical properties. Note, first of all, that the yield envelope is undefined at $h = 1$. The theory constructed so far from Axioms 1 and 2 thus contradicts the deeply entrenched surmise among economists, going back to Solow [-@solow1957technical], that yield functions are homogeneous of degree 1.

The appearance of $h$ in the yield envelope also offers an instructive expression for the output price elasticity of yield,

\begin{equation}
\frac{\partial \ln(y^*)}{\partial \ln(P)} = \frac{h}{1 - h}
\label{eq:PelastYstar}
\end{equation}

Here another Axiom comes into play.

\begin{framed}
   \textbf{Axiom 3} \\ Supply curves are positively sloped. $\left( \frac{\partial \ln(y^*)}{\partial \ln(P)} > 0 \right)$ \\
\end{framed}

From equation \ref{eq:PelastYstar}, it is clear that Axiom 3 imposes the following domain on $h$.

\begin{equation}
h \in (0, 1)
\end{equation}

Farms are thus limited to decreasing returns to scale, since increasing returns to scale ($h > 1$) imply a negatively sloped supply curve, in violation of Axiom 3, and since the yield envelope is undefined at constant returns to scale ($h = 1$).

In section \ref{sec:PDfunP}, circumstances are explored under which increasing returns to scale are possible. However, these circumstances generally apply to firms---mills and factories, for example---and not to farms.

The domain of $h$ derived above in turn implies the following bounds on the price elasticity of yield.

\begin{equation}
\frac{\partial \ln(y^*)}{\partial \ln(P)} \in (0, \infty)
\end{equation}
<!-- Note, in passing, that the input price elasticity of yield likewise bears the expected sign only under decreasing returns to scale. -->

<!-- \begin{equation} -->
<!-- \frac{\partial \ln(y^*)}{\partial \ln(w_i)} = \frac{-\alpha_v}{1 - h} -->
<!-- \end{equation} -->

<!-- With domain -->

<!-- \begin{equation} -->
<!-- \frac{\partial \ln(y^*)}{\partial \ln(w_v)} \in (-\infty, -\alpha_v) -->
<!-- \end{equation} -->

The yield envelope derived in equation \ref{eq:YdEnvCompact} implies that the farm supply curve^["Farm supply curve" is used as a shorthand for the "yield envelope as a function of price $P$, with all other variables held constant".] is a power law---or, in economics jargon, a constant elasticity of supply curve. This becomes more evident if the yield envelope is rewritten in the following compact form.

\begin{equation}
y^* = t_S P^{\eta(P, y^*)}
\end{equation}

Where

\begin{equation}
t_S = \left(y_0 \frac{\beta_x \beta_k}{\lambda^h \beta_w} \right)^{\frac{1}{1 - h}}
\end{equation}

And $\eta(P, y^*)$ is the price elasticity of yield defined in equation \ref{eq:PelastYstar}.

<!-- Both the scale parameter $t$ and exponent $\eta(P, y^*)$ depend critically upon the degree of homogeneity. -->
The output price elasticity of yield implies that the farm supply curve is elastic for $h \in (1 / 2 , 1)$, and inelastic for $h \in (0, 1 / 2)$, and linear with slope $t_S \bigr|_{h = 1 / 2}$ when $h = 1 / 2$.

This is important information. This means that (insofar as Axioms 1-3 are true) for a given increase in output price, the supply response in a population of farms with inefficient input elasticities (such that $h < 1 / 2$) will be less than proportionate to the increase in price. In a population of relatively input-efficient farms (such that $h > 1 / 2$), on the other hand, the supply response will be more than proportionate to the increase in price.

The farm supply curve approaches perfect inelasticity as $h$ approaches $0$, and approaches (but never reaches) perfect elasticity as $h$ approaches $1$. The scale factor $t_S$ approaches $0$ as $h$ approaches $0$, and tends toward infinity as $h$ approaches $1$.

## Input demand \label{sec:inDem}

Using equation \ref{eq:YdEnvCompact} to substitute for $y^*$ in input demand (equation \ref{eq:inputDem1}) gives the following expression for input demand as a function of basal yield, prices, input elasticities, the budget shadow price, and control variables together with their respective elasticities.

\begin{equation}
x_v^* = \frac{\alpha_v}{w_v} \left( y_0 \frac{P \beta_x \beta_k}{\lambda \beta_w} \right)^{\frac{1}{1 - h}}
\label{eq:inputDem2}
\end{equation}

Note that input demand, like optimal yield, is undefined at $h = 1$. The own price elasticity of input demand is

\begin{equation}
\begin{split}
\frac{\partial \ln(x_v^*)}{\partial \ln(w_v)} &= - 1 - \frac{1}{1 - h} \frac{\partial \ln(\beta_w)}{\partial \ln(w_v)} \\
&= \frac{-\alpha_v}{1 - h} - 1
\end{split}
\label{eq:ownPriceElas}
\end{equation}

Here another Axiom comes into play.

\begin{framed}
   \textbf{Axiom 4} \\ Demand curves are negatively sloped. $\left( \frac{\partial \ln(x_v^*)}{\partial \ln(w_v)} < 0 \:\: \forall v \right)$
\end{framed}

From equation \ref{eq:ownPriceElas}, it is clear that Axiom 4 imposes the following domain on $h$.

\begin{equation}
h \in (-\infty, 1 + \underline{\alpha}) \:\:; \:\:\: \underline{\alpha} = \min(\boldsymbol{\alpha})
\end{equation}

Considering that $\underline{\alpha} > 0$, the effective domain of $h$ satisfying both Axioms 3 and 4 (upward sloping supply curves and downward sloping demand curves) is

\begin{equation}
h \in (0, 1)
\end{equation}

The effective domain of $h$ in turn implies the following bounds on the own price elasticity of input demand.

\begin{equation}
\frac{\partial \ln(x_v^*)}{\partial \ln(w_v)} \in (\infty, -1)
\end{equation}

The input demand curve is thus always elastic, such that the increase in farm level demand resulting from a decrease in the input price is always more than proportionate to the fall in price.

Note that the cross price elasticity of input demand also bears the expected sign under the effective domain of $h$,

\begin{equation}
\frac{\partial \ln(x_v^*)}{\partial \ln(w_{j \neq v})} = \frac{-\alpha_j}{1 - h}
\label{eq:CrossPriceElas}
\end{equation}

As does the output price elasticity of input demand,

\begin{equation}
\frac{\partial \ln(x_v^*)}{\partial \ln(P)} = \frac{1}{1 - h}
\end{equation}

Equation \ref{eq:inputDem2} implies that the input demand curve^["Input demand curve" is used as a shorthand for the "optimal input level as a function of its price, with all other variables held constant".] is a power law. This is more evident when expressed in the following compact form.

\begin{equation}
x_v^* = z w_v^{\eta(w_v, x_v^*)}
\end{equation}

Where

\begin{equation}
z = \left(y_0 \frac{\beta_x \beta_k}{\lambda^h \tilde{\beta}_w} \right)^{\frac{1}{1 - h}} \:\:;\:\:\: \tilde{\beta}_w = w_v^{-\alpha_v}\beta_w
\end{equation}

And $\eta(w_v, x_v^*)$ is the own price elasticity of input demand, derived in equation \ref{eq:ownPriceElas}.

## Domains of the budget shadow price, economic yield, and input demand

Dotting the first order conditions (equations \ref{eq:eqFOC}) through by $\mathbf{x}$ and rearranging gives the following formula for the farm budget shadow price.

\begin{equation}
\lambda = \frac{P y^*}{C^*} h
\label{eq:lambdaHandy}
\end{equation}

That is, a farm's budget shadow price is equal to its revenue to cost ratio, scaled by the degree of homogeneity.

Assuming that farms only enter production if their expected revenue is greater than their cost (Axiom 5), then the following lower bound on $\lambda$ may be readily deduced.

\begin{equation}
\lambda > h
\label{eq:lamLoBound}
\end{equation}

\begin{framed}
   \textbf{Axiom 5} \\ Farms, as well as firms and consumers on the demand side, enter production only if their expected revenue is greater than their cost.
\end{framed}

This, in turn, implies the following upper bound on optimal yield.

\begin{equation}
y^* <  \left(y_0 \left(\frac{P}{h} \right)^h \frac{\beta_x \beta_k}{\beta_w} \right)^{\frac{1}{1 - h}}
\label{eq:ydUpBound}
\end{equation}

Note, in passing, that the notion of an upper bound on economic yields agrees with empirical observation [@herdt1988increasing; @pingali2001cereal]. In Pingali and Heisey's words:

>\singlespacing "The best yields obtained on experiment stations are often used as the indicator of technology potential. Experiment stations are often located on the best lands within a region and have reliable irrigation water supplies. Agronomic yield potential determined on experiment stations, with no physical, biological, or economic constraints, is the maximum achievable yield.... When the objective of the experiment is changed from maximizing yields to maximizing profits, the yields obtained by experiment station researchers drop significantly..." [-@pingali2001cereal].

\doublespacing
The lower bound on $\lambda$ likewise implies the following upper bound on input demand.

\begin{equation}
x_v^* < \frac{\alpha_v}{w_v} \left(y_0 \frac{P \beta_x \beta_k}{h \beta_w} \right)
\label{eq:inputUpBound}
\end{equation}

Recall that the upper bound on optimal expenditure is not derived but assumed as Axiom 5: $C^* < Py^*$.

## Income elasticity of demand revisited

Using equation \ref{eq:lambdaHandy} to substitute for $\lambda$ in equation \ref{eq:inputDem1} gives yet another instructive expression for input demand.

\begin{equation}
x_v^* = \frac{C^* \alpha_v}{h w_v}
\end{equation}

By which it follows that

\begin{equation}
\frac{\partial \ln(x_v^*)}{\partial \ln(C^*)} = 1
\label{eq:optExpElasInpDem}
\end{equation}

Most economists interpret this as meaning that the income elasticity of demand is $1$. If this is true, then the Cobb-Douglas model contradicts well documented empirical laws, particularly Engel's law, that clearly indicate changing demand for different items in the consumer's basket as income changes. (See Figure \ref{fig:otherLaws}.)

```{r Fig10, fig.show = "hold", fig.width = 5, fig.height=6, fig.align="center", fig.cap="\\label{fig:otherLaws}A log-log relation exists between demand and GDP per capita for all major consumer good categories. World Bank International Comparison Program 2017 data for 152 countries. GDP is at the market exchange rate, current prices.", echo = FALSE}

#===========================================================================
# Create Engel's law graphic for next chunk, also get slope and N for text.
#===========================================================================
#this_file <- "Engels Law WB ICP data.csv"
this_file <- "https://raw.githubusercontent.com/BenjamS/Building-aggregate-supply-and-demand-curves-from-microeconomic-axioms/main/Engels%20Law%20WB%20ICP%20data.csv"
df_icp <- read.csv(this_file, stringsAsFactors = F)
colnames(df_icp) <- gsub("US\\.\\.", "US$", colnames(df_icp))
colnames(df_icp) <- gsub("\\.\\.", ", ", colnames(df_icp))
colnames(df_icp) <- gsub("\\.", " ", colnames(df_icp))
colnames(df_icp) <- gsub("billions ", "billions", colnames(df_icp))
#unique(df_icp$Element)
these_elements <- c("Expenditure per capita, market exchange rate-based (US$)",
                    "Expenditure component share of GDP (GDP = 100%)")
# these_elements <- c("Expenditure per capita, PPP-based (US$)",
#                     "Expenditure, PPP-based (US$, billions)")
df_icp <- subset(df_icp, Element %in% these_elements)

df_icp$Element[grep("share", df_icp$Element)] <- "Expenditure (as % of GDP)"
# df_icp$Element[grep("per capita", df_icp$Element)] <- "expenditure/capita (USD)"
# df_icp$Element[grep("billions", df_icp$Element)] <- "expenditure (billion USD)"


all_goods <- unique(df_icp$Good)
df_icpOther <- df_icp

df_icpOther$Good[grep("1101100:FOOD", df_icpOther$Good)] <- "Food"
df_icpOther$Good[grep("RESTAURANTS", df_icpOther$Good)] <- "Restaurants and hotels"
df_icpOther$Good[grep("EDUCATION", df_icpOther$Good)] <- "Education"
df_icpOther$Good[grep("RECREATION", df_icpOther$Good)] <- "Recreation and culture"
df_icpOther$Good[grep("CLOTHING", df_icpOther$Good)] <- "Clothing and footwear"
df_icpOther$Good[grep("CONSTRUCTION", df_icpOther$Good)] <- "Construction"
df_icpOther$Good[grep("MACHINERY", df_icpOther$Good)] <- "Machinery and equipment"
df_icpOther$Good[grep("FURNISHINGS", df_icpOther$Good)] <- "Furnishings, hh equip., &\nroutine hh maintenance"
df_icpOther$Good[grep("ACTUAL HOUSING", df_icpOther$Good)] <- "Housing, electricity,\n& other utilities"
df_icpOther$Good[grep("VEHICLES", df_icpOther$Good)] <- "Purchase of vehicles"
df_icpOther$Good[grep("1107000:TRANSPORT", df_icpOther$Good)] <- "Transport" #"1107300:TRANSPORT SERVICES"
df_icpOther$Good[grep("COMMUNICATION", df_icpOther$Good)] <- "Communication"
df_icpOther$Good[grep("HEALTH", df_icpOther$Good)] <- "Health"

not_these <- all_goods[grep("[0-9]", all_goods)]
not_these <- c(not_these, "Communication", "Purchase of vehicles",
               "Furnishings, hh equip., &\nroutine hh maintenance",
               "Machinery and equipment", "Construction", "Transport")
#not_these <- c(not_these, "Food")
this_element <- "Expenditure per capita, market exchange rate-based (US$)"
# this_element <- "Expenditure (as % of GDP)"
df_plot <- subset(df_icpOther, !(Good %in% not_these) &
                    Element == this_element &
                    Region != "Aggregated")
#unique(df_icpOther$Good)
#colnames(df_icpOther)
#unique(df_icpOther$Element)

df_plot$`GDP/capita (USD), logged` <- log(df_plot$`GDP per capita, market exchange rate based, US$`)

these_goods <- unique(df_plot$Good)
facet_labels <- c()
adjR2_vec <- c()
for(i in 1:length(these_goods)){
  this_good <- these_goods[i]
  this_df_plot <- subset(df_plot, Good == this_good)
  mod <- lm(`Expenditure, logged` ~ `GDP/capita (USD), logged`, this_df_plot)
  #summary(mod)
  m <- round(mod$coefficients[2], 3)
  b <- round(mod$coefficients[1], 3)
  df_out <- as.data.frame(broom::glance(mod))
  adjR2 <- round(df_out$adj.r.squared, 2)
  N <- df.residual(mod)
  facet_labels[i] <- paste0(this_good, "\nAdj. R-squared = ", adjR2, "\nSlope = ", m, "\nY intercept = ", b)
  adjR2_vec[i] <- adjR2
  #print(N)
}

names(facet_labels) <- these_goods

library(tidyverse)
shape_vec <- c(21:24, 4)
# point_size <- 1.5
smallPoint_size <- 1
# label_size <- 2.5
# smallLabel_size <- 2
# title_size <- 8
# subtitle_size <- 7
legendText_size <- 7
axisText_size <- 6
axisTitle_size <- 7
facetTitle_size <- 7
n <- length(unique(df_plot$Good))
bag_of_colors <- randomcoloR::distinctColorPalette(k = 2 * n)
color_vec <- sample(bag_of_colors, n)

shift_legend2 <- function(p) {
  # ...
  # to grob
  gp <- ggplotGrob(p)
  facet.panels <- grep("^panel", gp[["layout"]][["name"]])
  empty.facet.panels <- sapply(facet.panels, function(i) "zeroGrob" %in% class(gp[["grobs"]][[i]]))
  empty.facet.panels <- facet.panels[empty.facet.panels]
  
  # establish name of empty panels
  empty.facet.panels <- gp[["layout"]][empty.facet.panels, ]
  names <- empty.facet.panels$name
  # example of names:
  #[1] "panel-3-2" "panel-3-3"
  
  # now we just need a simple call to reposition the legend
  #lemon::reposition_legend(p, 'center', panel=names)
  p_out <- lemon::reposition_legend(p, 'center', panel=names)
  #class(lemon::reposition_legend(p, 'center', panel=names))
  return(p_out)
}



colnames(df_plot) <- gsub("Expenditure, logged", "Expenditure/capita (USD), logged", colnames(df_plot))
gg <- ggplot(df_plot, aes(x = `GDP/capita (USD), logged`,
                          y = `Expenditure/capita (USD), logged`,
                          #label = label_these,
                          group = Region, fill = Region, shape = Region))
gg <- gg + geom_point(alpha = 0.6, size = smallPoint_size, color = "black", stroke = 0.5)
gg <- gg + scale_fill_manual(values = color_vec)
gg <- gg + scale_shape_manual(values = shape_vec)
#gg <- gg + geom_smooth(method = lm, se = F)
gg <- gg + facet_wrap(~Good, ncol = 3,
                      labeller = labeller(Good = facet_labels))
#gg <- gg + geom_text_repel(color = "black", size = smallLabel_size)
gg <- gg + theme(strip.background = element_blank(),
                 strip.text.x = element_text(hjust = -0.01, size = facetTitle_size),
                 legend.position = "bottom",
                 legend.spacing.x = unit(0.25, 'cm'),
                 legend.title = element_blank(),
                 legend.text = element_text(size = legendText_size),
                 axis.text = element_text(size = axisText_size),
                 axis.title = element_text(size = axisTitle_size))
gg <- gg + guides(fill = guide_legend(nrow = 3, byrow = T, override.aes = list(linetype = 0)),
                  color = guide_legend(override.aes = list(linetype = 0)))
gg <- shift_legend2(gg)
gg <- ggplotify::as.ggplot(gg)





# Look at food groups
#unique(df_icp$Good)
# all_goods <- unique(df_icp$Good)
# df_icpOtherFood <- df_icp
# u <- df_icpOtherFood$Good
# df_icpOtherFood$Good[which(u == "1101190:Food products n.e.c. (Class)")] <- "Other food"
# df_icpOtherFood$Good[grep("Oils and fats", u)] <- "Oils and fats"
# df_icpOtherFood$Good[grep("Sugar, jam", u)] <- "Sugary and sweet"
# df_icpOtherFood$Good[grep("Milk, cheese and eggs", u)] <- "Milk, cheese and eggs"
# df_icpOtherFood$Good[grep("Fish and seafood", u)] <- "Fish and seafood"
# df_icpOtherFood$Good[grep("Meat", u)] <- "Meat"
# df_icpOtherFood$Good[grep("Vegetable", u)] <- "Bread, cereals, and vegetables"
# df_icpOtherFood$Good[grep("Bread", u)] <- "Bread, cereals, and vegetables"
# df_icpOtherFood$Good[grep("Fruit", u)] <- "Fruit"
# df_icpOtherFood$Good[grep("1101100:FOOD", u)] <- "Food"
# 
# not_these <- all_goods[grep("[0-9]", all_goods)]
# not_these <- c(not_these, "Food")
# #unique(df_icpOtherFood$Element)
# #this_element <- "Expenditure (as % of GDP)"
# this_element <- "Expenditure per capita, market exchange rate-based (US$)"
# df_plot <- subset(df_icpOtherFood, !(Good %in% not_these) &
#                     Element == this_element &
#                     Region != "Aggregated")
# #colnames(df_plot)
# df_plot$`GDP/capita (USD), logged` <- log(df_plot$`GDP per capita, market exchange rate based, US$`)
# 
# 
# gg <- ggplot(df_plot, aes(x = `GDP/capita (USD), logged`,
#                           y = `Expenditure, logged`,
#                           #label = label_these,
#                           group = Region, fill = Region, shape = Region))
# gg <- gg + geom_point(alpha = 0.6, size = smallPoint_size, color = "black", stroke = 0.5)
# gg <- gg + scale_fill_manual(values = color_vec)
# gg <- gg + scale_shape_manual(values = shape_vec)
# #gg <- gg + geom_smooth(method = lm, se = F)
# gg <- gg + facet_wrap(~Good, ncol = 4)#,
#                       #labeller = labeller(Good = facet_labels))
# #gg <- gg + geom_text_repel(color = "black", size = smallLabel_size)
# gg <- gg + theme(strip.background = element_blank(),
#                  strip.text.x = element_text(hjust = -0.01, size = facetTitle_size),
#                  #legend.direction = "vertical",
#                  #legend.spacing.y = unit(1, 'cm'),
#                  legend.title = element_blank(),
#                  legend.text = element_text(size = legendText_size),
#                  axis.text = element_text(size = axisText_size),
#                  axis.title = element_text(size = axisTitle_size))
# gg <- gg + guides(fill = guide_legend(#nrow = 2,
#   override.aes = list(linetype = 0)),
#   color = guide_legend(override.aes = list(linetype = 0)))
# gg

```


However, no such contradiction in fact arises since $C^*$ does not represent income or budget ($B$), but rather _optimal expenditure_. Optimal expenditure is defined as

\begin{equation}
C^* = \sum_i x_i^* w_i
\end{equation}

Or, rearranging equation \ref{eq:lambdaHandy},

\begin{equation}
C^* = Py^* h / \lambda
\label{eq:cStar}
\end{equation}

In either case, it is straightforward to see that $C^*$ is a function of basal yield, prices, the budget shadow price, input elasticities, and control variables together with their respective elasticities, in which income $B$ plays no part. $C^*$ is therefore something very different from $B$, and may be greater or less than $B$.
<!-- equations \ref{eq:inputDem2} and \ref{eq:YdEnvCompact} clearly demonstrate that -->
<!-- More generally, the forgoing sections demonstrate that, under Axioms 1 and 2, optimal yield, input demand, and expenditure are all invariant under changes in $B$. -->

To be clear, then, equation \ref{eq:optExpElasInpDem} says that the income elsticity of _optimal expenditure_, _not of income_, is equal to $1$. A relationship between demand $x_v^*$ and budget $B$ does not follow from Axioms 2 and 3. However, the empirical consumer expenditure laws observed in Figure \ref{fig:otherLaws} can be derived from Axiom 1 alone.

_Proof:_

The net change in utility given a change in expenditure on good $x_v$ is the change in utility resulting from the acquisition of the good minus the change in utility resulting from the corresponding depletion of the budget. This may be formally expressed as follows. 

\begin{equation}
\frac{\partial \ln(U)}{\partial (w_v x_v)} = \frac{\partial \ln(U)}{\partial x_v} - \frac{\partial \ln(U)}{\partial B}
\end{equation}

Applying the first order condition for a maximum ($\partial \ln(U) / \partial (w_v x_v) = 0$) and rearranging,
<!-- Assuming that a consumer will part with money ($B$) for a good $x_v$ only such that the decrease in utility resulting from the loss of money is offset by the increase in utility resulting from the acquisition of the good, then -->

\begin{equation}
\frac{\partial \ln(U)}{\partial x_v} = \frac{\partial \ln(U)}{\partial B}
\end{equation}

By Axiom 1 (equation \ref{eq:dimUtilDefine}), this can be rewritten

\begin{equation}
\alpha_B \frac{d \ln(B)}{d B} = \alpha_v \frac{d \ln(x_v)}{d x_v}
\end{equation}

But note that, assuming expenditures on other goods or inputs are held constant,

\begin{equation}
\frac{d \ln(B)}{d B} = \frac{\partial \ln(B)}{\partial (w_v x_v)}
\end{equation}

And so the previous equation can again be rewritten,

\begin{equation}
\begin{split}
\alpha_B \frac{\partial \ln(B)}{\partial (w_v x_v)} &= \alpha_v \frac{d \ln(x_v)}{dx_v} \\
\frac{\alpha_B}{w_v} \frac{\partial \ln(B)}{\partial x_v} &= \alpha_v \frac{d \ln(x_v)}{dx_v}
\end{split}
\label{eq:margUtilAssump}
\end{equation}

Integrating both sides then gives

\begin{equation}
\begin{split}
\frac{\alpha_B}{w_v} \int \frac{d \ln(B)}{d x_v} \: dx_v &= \alpha_v \int \frac{d \ln(x_v)}{d x_v} \: dx_v \\
\frac{\alpha_B}{w_B} (\ln(B) + k_B)  &= \alpha_v (\ln(x_v) + k_v)
\end{split}
\end{equation}

Where $k_B$ and $k_v$ are constants of integration. This can then be rearranged into the familiar double log expression seen in Figure \ref{fig:otherLaws}.

\begin{equation}
\ln(x_v) = m_v \ln(B) + b_v
\label{eq:generalLaw}
\end{equation}

Where the income elasticity of good $x_v$ (i.e. slope) $m_v$ and y intercept $b_v$ are defined

\begin{equation}
m_v = \frac{\alpha_B}{w_v \alpha_v}, \:\:\: b_v = \frac{\alpha_B}{w_v\alpha_v} k_B - k_v
\label{eq:incomElast}
\end{equation}
<!-- The double log consumer expenditure laws thus follow from Axiom 1 and the consumer's conservation of utility condition (equation \ref{eq:condEqualU}). Bennett's law may likewise be derived if income $B$ is constrained to refer to the consumer's food budget, and goods are limited to food items. -->

$\blacksquare$

## Marginal cost

From equation \ref{eq:cStar} it follows that the marginal cost of output is

\begin{equation}
\frac{\partial C^*}{\partial y^*} = \frac{P h}{\lambda} = \frac{C^*}{y^*}
\end{equation}

Under Axioms 1 and 2, then, the marginal cost of output is constant with respect to output. This agrees with empirical evidence [@lavoie2014post]. It also contradicts the theory of the firm presented in most microeconomic textbooks, which assumes (with no evidentiary basis) increasing marginal cost as output rises.

## The farm net benefit envelope

The optimized objective function or "net benefit envelope" $\mathcal{L}^*$ is just the objective function $\mathcal{L}$ evaluated at the optimal yield $y^*$.

\begin{equation}
\mathcal{L}^* = \mathcal{L} \bigr|_{y = y^*} = P y^* - \lambda (C^* - B)
\end{equation}

Note that, applying the handy relation in equation \ref{eq:lambdaHandy}, the net benefit envelope can be rewritten without the optimal expenditure term $C^*$.

\begin{equation}
\mathcal{L}^* = (1 - h) P y^* + \lambda B
\label{eq:NBenv}
\end{equation}

# Consumer utility and demand \label{sec:consDem}

The Axioms from which the equations of supply side behavior are derived also apply to the demand side. This means that the consumer utility, utility envelope, and demand equations take the same form as the producer yield, yield envelope, and input demand equations, respectively.^["Consumer" here can refer to individual people or to demand side firms (mills, factories, etc.). Likewise, consumer utility can refer either to the utility of individual people, or to mill or factory yield.]

Consumer utility (or yield, in the case of mills, factories, etc.) is therefore just the demand side analogue of the farm yield envelope derived in equation \ref{eq:YdEnvCompact}.

\begin{equation}
y_D^* = \left(y_0^D \left( \frac{P_D}{\lambda_D} \right)^{h_D} \frac{\beta_x^D \beta_k^D}{\beta_w^D} \right)^{\frac{1}{1 - h_D}}
\end{equation}

Where $y_D^*$, $y_0^D$, $P_D$, $\lambda_D$, $h_D$, $\beta_x^D$, $\beta_k^D$, and $\beta_w^D$, are the respective demand side analogues of $y^*$, $y_0$, $P$, $\lambda$, $h$, $\beta_x$, $\beta_k$, and $\beta_w$.

Consumer demand for the given farm output $x_v^{D*}$ is likewise just the demand side analogue of farm input demand, which was derived above in equation \ref{eq:inputDem2}.

\begin{equation}
\begin{split}
x_v^{D*} &= \frac{P_D y_D^* \alpha_v^D}{\lambda_D P} \\
&= \frac{\alpha_v^D}{P} \left (y_0^D \frac{P_D \beta_x^D \beta_k^D}{\lambda_D  \beta_w^D} \right)^{\frac{1}{1 - h_D}}
\end{split}
\end{equation}

Where $w_v^D$ and $\alpha_v^D$ are the respective demand side analogues of $w_v$ and $\alpha_v$.

But note that the consumer's input price $w_v^D$ is just the producer's output price $P$. Substituting $P$ for $w_v^D$ and factoring out $P$, then, optimal consumer yield and demand can be rewritten in a way that clarifies the role of farm output price $P$.

\begin{equation}
y_D^* = P^{\frac{-\alpha_D}{1 - h_D}} \left(y_0^D \left( \frac{P_D}{\lambda_D} \right)^h_D \frac{\beta_x^D \beta_k^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}}
\label{eq:consYdEnv0}
\end{equation}

\begin{equation}
x_D^* = \alpha_D P^{\frac{-\alpha_D}{1 - h_D} - 1} \left(y_0^D \frac{P_D}{\lambda_D} \frac{\beta_x^D \beta_k^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}}
\label{eq:inputDemDEM0}
\end{equation}

Where, to reduce notational clutter, the index $v$ has been dropped such that $x_v^{D*}$ is replaced with $x_D^*$ and $\alpha_v^D$ is replaced with $\alpha_D$; and where $\tilde{\beta}_w^D = P^{-\alpha_D}\beta_w^D$.

Note that the consumer demand curve (equation \ref{eq:inputDemDEM0}) is a power law. This becomes more evident if the equation is written in the following compact form.

\begin{equation}
x_D^* = t_D P^{\eta(P, x_D^*)}
\end{equation}

Where

\begin{equation}
t_D = \alpha_D \left(y_0^D \frac{P_D}{\lambda_D} \frac{\beta_x^D \beta_k^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}}
\end{equation}

And $\eta(P, x_D^*)$ is the farm price elasticity of consumer demand.

\begin{equation}
\begin{split}
\eta(P, x_D^*) &= \frac{\partial \ln(x_D^*)}{\partial \ln(P)} \\
&= \frac{-\alpha_D}{1 - h_D} - 1
\end{split}
\end{equation}

Which is just the demand side analogue of the own price elasticity of input demand derived in equation \ref{eq:ownPriceElas}.

The domain $h_D \in (0, 1)$ implies that the consumer demand curve is always inelastic.

\begin{equation}
\frac{\partial \ln(x_D^*)}{\partial \ln(P)} \in (-1, 0)
\end{equation}

Note that changes in the price of other goods in the consumer's basket also influence their demand for a given farm output of interest.

\begin{equation}
\frac{\partial \ln(x_D*)}{\partial \ln(w_{j \neq i}^D)} = \frac{-\alpha_D}{1 - h_D}
\label{eq:crossPelasDem}
\end{equation}

Where this is just the demand side analogue of the cross price elasticity of farm input demand derived in equation \ref{eq:CrossPriceElas}.
<!-- The output price elasticity of yield implies that the farm supply curve is elastic for $h \in (1 / 2 , 1)$, and inelastic for $h \in (0, 1 / 2)$, and linear with slope $t \bigr|_{h = 1 / 2}$ when $h = 1 / 2$. -->

<!-- This is important information. This means that (insofar as Axioms 1-3 are true) for a given increase in output price, the supply response in a population of farms with inefficient input elasticities (such that $h < 1 / 2$) will be less than proportionate to the increase in price. In a population of relatively input-efficient farms (such that $h > 1 / 2$), on the other hand, the supply response will be more than proportionate to the increase in price. -->

<!-- The farm supply curve approaches perfect inelasticity as $h$ approaches $0$, and approaches perfect elasticity as $h$ approaches $1$. However, the scale factor $t$ approaches $0$ as $h$ approaches $0$, and tends toward infinity as $h$ approaches $1$, such that neither perfect elasticity nor inelasticity are ever reached; but rather farm supply is $0$ at $h = 0$ and infinite at $h = 1$. -->

## Consumer output price as a function of the farm output price \label{sec:PDfunP}

When $x_D$ is feedstock in some consumer's production process (as in the case of mills and factories, for example), then a close relationship often exists between $P$ and $P_D$. A reasonable first attempt at formalization of this relation is $P_D = b P$, where $b > 1$ is the factory markup. However, substituting $b P$ for $P_D$ in equation \ref{eq:inputDemDEM0} results in the following price elasticity of demand,

\begin{equation}
\frac{\partial \ln(x_D*)}{\partial \ln(P)} = \frac{1 - \alpha_D}{1 - h_D} - 1
\end{equation}

Which is impossible under Axiom 4 since the assumption that $\frac{\partial \ln(x_D*)}{\partial \ln(P)} < 0$ (negatively sloped demand curves) would thereby imply that $\alpha_D > h_D$, when in fact $h_D = \sum_i \alpha_i^D$ (and $\alpha_i^D > 0$ for all $i$).

This consideration leads to a more informed second attempt at formalization of the relation between $P$ and $P_D$.

\begin{equation}
P_D = b P^{\varepsilon} \:\:;\:\:\:P_D > P
\label{eq:PDasFunOfP}
\end{equation}

Where the exponent $\varepsilon$ is the percentage change in the consumer's output price $P_D$ given a $1$% increase in the farm product price $P$.

\begin{equation}
\frac{\partial \ln(P_D)}{\partial \ln(P)} = \varepsilon
\end{equation}

Equation \ref{eq:PDasFunOfP} is an ansatz, and not a result derived from the Axioms. For this reason, it takes its place among the Axioms.

\begin{framed}
   \textbf{Axiom 6} \\ The demand side firm output price $P_D$ is often related to the supply side output price $P$ by the equation $P_D = b P^{\varepsilon}$. \\ (Where $b > 0$, and the domain of $\varepsilon$ is derived from Axioms 3 and 4 below.)
\end{framed}

Using equation \ref{eq:PDasFunOfP} to substitute for $P$ in equation \ref{eq:consYdEnv0} and factoring out $P_D$ gives the following modified form of consumer yield.

\begin{equation}
y_D^* = P_D^{\frac{h_D - \alpha_D / \varepsilon}{1 - h_D}} \left(y_0^D b^{\alpha_D / \varepsilon} \frac{\beta_k^D \beta_x^D}{\lambda_D^{h_D} \tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}}
\label{eq:consYdEnv}
\end{equation}

The consumer's output price ($P_D$) elasticity of yield then follows as

\begin{equation}
\frac{\partial \ln(y_D^*)}{\partial \ln(P_D)} = \frac{h_D - \alpha_D / \varepsilon}{1 - h_D}
\label{eq:PDelasydD}
\end{equation}

Axiom 3 (positively sloped supply curves) thus imposes the following upper/lower bound on $\varepsilon$, depending on whether demand side returns to scale are decreasing/increasing.

\begin{equation}
\varepsilon
\begin{cases}
< 1 + \alpha_D - h_D, & \text{if $h_D < 1$} \\
> 1 + \alpha_D - h_D, & \text{if $h_D > 1$}
\end{cases}
\label{eq:ax3boundEps}
\end{equation}

Using equation \ref{eq:PDasFunOfP} to substitute for $P_D$ in equation \ref{eq:inputDemDEM0} and factoring out $P$ then gives the following modified version of consumer demand $x_D^*$.

\begin{equation}
x_D^* = \alpha_D P^{\frac{\varepsilon - \alpha_D}{1 - h_D} - 1} \left(y_0^D b \frac{\beta_x^D  \beta_k^D}{\lambda_D \tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}}
\label{eq:inputDemDEM}
\end{equation}

(If there is no relation between $P$ and $P_D$, then the original consumer yield and demand expressions in equations \ref{eq:consYdEnv0} and \ref{eq:inputDemDEM0} are recovered by setting $b = P_D$ and $\varepsilon = 0$.)

In the compact power law formulation of consumer demand, the scale parameter $t_D$ then becomes

\begin{equation}
t_D = \alpha_D \left(y_0^D b \frac{\beta_x^D \beta_k^D}{\lambda_D \tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}}
\end{equation}

And the farm output price ($P$) elasticity of demand $\eta(P, x_D^*)$ becomes

\begin{equation}
\begin{split}
\eta(P, x_D^*) &= \frac{\partial \ln(x_D^*)}{\partial \ln(P)} \\
&= \frac{\varepsilon - \alpha_D}{1 - h_D} - 1
\end{split}
\label{eq:PelasDem}
\end{equation}

Axiom 4 (negatively sloped demand curves) thus imposes the following lower/upper bound on $\varepsilon$, depending on whether demand side returns to scale are decreasing/increasing.

\begin{equation}
\varepsilon
\begin{cases}
> \alpha_D / h_D, & \text{if $h_D < 1$} \\
< \alpha_D / h_D, & \text{if $h_D > 1$}
\end{cases}
\label{eq:ax4boundEps}
\end{equation}

Taken together, then, inequalities \ref{eq:ax3boundEps} and \ref{eq:ax4boundEps} impose the following domain on $\varepsilon$.

\begin{equation}
\varepsilon \in
\begin{cases}
(\alpha_D / h_D, 1 + \alpha_D - h_D), & \text{if $h_D < 1$} \\
(1 + \alpha_D - h_D, \alpha_D / h_D), & \text{if $h_D > 1$}
\end{cases}
\label{eq:domEpsilon}
\end{equation}

Considering that $h_D = \sum_i \alpha_i^D$ and $\alpha_v^D > 0$ for all $v$, the term $\alpha_D / h_D$ is always greater than $0$ and less than $1$. By the same token, $\alpha_D - h_D < 0$, and so the term $1 + \alpha_D - h_D$ is also less than $1$.

Is the upper bound of $\varepsilon$ always greater than its lower bound? Supposing it is, then, for decreasing returns to scale ($h_D < 1$),

\begin{equation}
\begin{split}
\alpha_D / h_D &< 1 + \alpha_D - h_D \\
\alpha_D (1 / h_D - 1) &< 1 - h_D \\
\alpha_D / h_D (1 - h_D) &< 1 - h_D \\
\alpha_D / h_D &< 1
\end{split}
\end{equation}

And, for increasing returns to scale, ($h_D > 1$),

\begin{equation}
\begin{split}
\alpha_D / h_D &> 1 + \alpha_D - h_D \\
\alpha_D (1 / h_D - 1) &> 1 - h_D \\
\alpha_D / h_D (1 - h_D) &> 1 - h_D \\
\alpha_D / h_D &< 1
\end{split}
\end{equation}

Which is true in both cases by the definition of $h_D$ as the sum of the $\alpha_i$. Therefore, the supposition that $\varepsilon$'s upper bound is always greater than its lower bound is true.

### Domain of demand side degree of homogeneity when consumer output price is a function of farm output price

The domain of $\varepsilon$ derived above (inequality \ref{eq:domEpsilon}) implies the following bounds on $h_D$.

\begin{equation}
h_D \in
\begin{cases}
(\alpha_D / \varepsilon, 1 - \varepsilon + \alpha_D), & \text{if $\varepsilon > \alpha_D$} \\
(1 - \varepsilon + \alpha_D, \alpha_D / \varepsilon), & \text{if $\varepsilon < \alpha_D$}
\end{cases}
\label{eq:domHD}
\end{equation}

But note that Axiom 4 must hold true for all inputs, not just the primary input or feedstock $x_D^*$. Therefore,

\begin{equation}
h_D
\begin{cases}
< 1 + \underline{\alpha}_D, & \text{if $h_D < 1$} \\
> 1 + \underline{\alpha}_D, & \text{if $h_D > 1$}
\end{cases}
\label{eq:otherBoundhD0}
\end{equation}

Where $\underline{\alpha}_D$ is the smallest demand side input elasticity (typically smaller than $\alpha_D$).

Note also that inequality \ref{eq:ax4boundEps} implies that $h_D < 1 \rightarrow \varepsilon > \alpha_D$ and $h_D < 1 \rightarrow \varepsilon < \alpha_D$, so the inequality can be rewritten

\begin{equation}
h_D
\begin{cases}
< 1 + \underline{\alpha}_D, & \text{if $\varepsilon > \alpha_D$} \\
> 1 + \underline{\alpha}_D, & \text{if $\varepsilon < \alpha_D$}
\end{cases}
\label{eq:otherBoundhD}
\end{equation}

The question thus arises: which of the upper/lower bounds in inequalities \ref{eq:domHD} and \ref{eq:otherBoundhD} is more restrictive?

Since the input elasticities ($\boldsymbol{\alpha}$, $\boldsymbol{\alpha}_D$) are assumed to be positive, the first case in inequality \ref{eq:otherBoundhD} is trivially true (this is easier to see by looking at the previous formulation in inequality \ref{eq:otherBoundhD0}). The question remains, however, which of the lower bounds in inequalities \ref{eq:domHD} and \ref{eq:otherBoundhD} is more restrictive. Mathematically, this question can be expressed as follows.

\begin{equation}
\max(1 + \alpha_D - \varepsilon, 1 + \underline{\alpha}_D) \bigr|_{\varepsilon < \alpha_D}
\end{equation}

The question is resolved by evaluating this expression at the minimum possible value for $\varepsilon$ (derived in inequality \ref{eq:domEpsilon}). The result will then be true across all other possible values of $\varepsilon$.

\begin{equation}
\max(1 + \alpha_D - \max(\varepsilon), 1 + \underline{\alpha}_D) \bigr|_{\varepsilon < \alpha_D} = \max(h_D, 1 + \underline{\alpha}_D) \bigr|_{\varepsilon < \alpha_D}
\end{equation}

By Axiom 4, $h_D > 1 + \underline{\alpha}_D$ when $\varepsilon < \alpha_D$. Therefore,

\begin{equation}
\begin{split}
\max(h_D, 1 + \underline{\alpha}_D) \bigr|_{\varepsilon < \alpha_D} &= h_D \\
&= 1 + \alpha_D - \max(\varepsilon) \bigr|_{\varepsilon < \alpha_D}
\end{split}
\end{equation}

And hence, generally,

\begin{equation}
\max(1 + \alpha_D - \varepsilon, 1 + \underline{\alpha}_D) \bigr|_{\varepsilon < \alpha_D} = 1 + \alpha_D - \varepsilon
\end{equation}

The lower bound of $h_D$ given in inequality \ref{eq:domHD} is thus more restrictive than the lower bound given in inequality \ref{eq:otherBoundhD}. Inequality \ref{eq:domHD} is thus the domain of $h_D$.

Under Axiom 6, then, increasing returns to scale are possible if $\varepsilon < \alpha_D$. Note that, as a general rule, Axiom 6 applies to mills and factories, but not to farms. Farms are generally not at liberty to lower the price they pay for, say, fertilizer, in response to a decrease in their output price, especially not in the developing world. An important asymmetry is thereby introduced between the supply and demand side of the primary sector, whereby producers are limited to decreasing returns to scale while consumers may attain increasing returns to scale if the condition $\varepsilon < \alpha_D$ is met.

### Domain of price elasticities of consumer supply and demand when consumer output price is a function of farm output price

The domain of $h_D$ derived in the previous section then imposes the following domains on the consumer's feedstock price ($P$) elasticity of demand and output price ($P_D$) elasticity of supply, respectively.

\begin{equation}
\frac{\partial \ln(x_D^*)}{\partial \ln(P)} \in (\varepsilon - 1, 0)
\label{eq:domainEtaD}
\end{equation}

\begin{equation}
\frac{\partial \ln(y_D^*)}{\partial \ln(P_D)} \in (0, 1 / \varepsilon - 1)
\end{equation}

Since $\varepsilon < 1$, this implies:

* Inelastic consumer demand

* Consumer demand is more inelastic as $\varepsilon$ is higher

* Consumer demand elasticity cannot be less than $\varepsilon - 1$

* The possibility of elastic consumer output, with maximum elasticity at $1 / \varepsilon - 1$.

## Upper bound on consumer demand

Assuming consumers enter the market only if they expect to increase their net utility (Axiom 4), then

\begin{equation}
\lambda_D > h_D
\label{eq:lamLoBoundDEM}
\end{equation}

Which in turn implies the following upper bound on any individual consumer's demand for a given product.

\begin{equation}
x_D^* < \left( \frac{\alpha_D}{P} \right)^{\frac{\alpha_D - \varepsilon}{1 - h_D} + 1} \left(\frac{y_0^D b \beta_x^D \beta_k^D}{h_D \tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}}
\label{eq:inputUpBoundDEM}
\end{equation}

The last two inequalities are the demand side analogues of the results derived in equations \ref{eq:lamLoBound} and \ref{eq:inputUpBound}, respectively.

<!-- ### Proportionality of changes in consumer demand to changes in price -->

<!-- The consumer demand curve derived in equation \ref{eq:inputDemDEM} is a power law. This becomes clearer if the equation is written in the following more compact form. -->

<!-- \begin{equation} -->
<!-- \x_D^* = t_D P^{\eta(P, x_D^*)} -->
<!-- \label{eq:inputDemDEMpwrLaw} -->
<!-- \end{equation} -->

<!-- Where -->

<!-- \begin{equation} -->
<!-- t_D = \alpha_D^{\frac{\alpha_D - \varepsilon}{1 - h_D} + 1} \left(y_0^D \frac{b \beta_x^D  \beta_k^D}{\lambda_D \tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}} -->
<!-- \end{equation} -->

<!-- And where the exponent $\eta(P, x_D^*)$ stands for the consumer's price elasticity of demand, derived in equation \ref{eq:PelasDem}. -->

<!-- By the definition of $\eta(P, x_D^*)$ it is evident that, for consumers with $\varepsilon$ such that $\alpha_D / h_D < \varepsilon < \alpha_D$, the increase in consumer demand resulting from a decrease in price is more than proportionate to the fall in price ($\frac{\partial \ln(x_D^*)}{\partial \ln(P)} < -1$); whereas, for consumers with $\varepsilon$ such that $\alpha_D < \varepsilon < 1 - h_D + \alpha_D$, the increase in consumer demand resulting from a decrease in price is less than proportionate to the fall in price ($0 > \frac{\partial \ln(x_D^*)}{\partial \ln(P)} > -1$). For consumers with $\varepsilon = \alpha_D$, the increase in demand is exactly proportionate to the fall in price. -->

## The demand side net benefit envelope

The demand side net benefit envelope is the optimized demand side objective function, that is, the consumer's objective function evaluated at $x_D^*$.

\begin{equation}
\mathcal{L}_D^* = \mathcal{L_D} \bigr|_{x_D = x_D^*} = P_D y_D^* - \lambda_D (C_D^* - B_D)
\end{equation}

As in equation \ref{eq:NBenv}, the demand side analogue of the handy relation in equation \ref{eq:lambdaHandy} can be applied to rewrite this without the optimal expenditure term $C_D^*$.

\begin{equation}
\mathcal{L}_D^* = (1 - h_D) P_D y_D^* + \lambda_D B_D
\end{equation}

Using equations \ref{eq:consYdEnv} and \ref{eq:PDasFunOfP} to substitute for $y_D^*$ and $P_D$, respectively, this can be rewritten as follows.

\begin{equation}
\mathcal{L}_D^* = (1 - h_D) P^{\frac{\varepsilon - \alpha_D}{1 - h_D}} \left(y_0^D b \frac{\beta_x^D \beta_k^D}{\tilde{\beta}_w^D \lambda^{h_D}} \right) + \lambda_D B_D
\label{eq:NBenvDem}
\end{equation}

# The ambiguous benefits of technological change

New technology can be modeled either as a change in the basal yield $y_0$, or as a change in one of the input elasticities $\alpha_i$. Generally speaking, a change in basal yield implies planting an improved variety, whereas a change in one of the input elasticities implies the application of a more efficient input (or a more efficient way of applying the status quo input).

Mathematically, the change in farm level net benefit resulting from introduction of the new technology is measured as the change in the farm's net benefit envelope $\mathcal{L}^*$ (derived in equation \ref{eq:NBenv}).

By Axiom 2, it is assumed that a farm adopts a given new technology only if the expected change in net benefit is positive. Formally, this condition can be expressed for basal yield and input enhancing technology, respectively,

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} &> 0 \\
\frac{\partial \mathcal{L}^*}{\partial \ln(y_v)} &> 0
\label{eq:adoptCondBasic}
\end{split}
\end{equation}

Below, these two conditions are explored in more detail.

## Technology change as a change in basal yield

In most impact assessment studies, technology change comes in the form of a new cultivar with improved germplasm, and/or a package of new management practices, which do not act upon any single input in particular, but generally raise the basal yield. Many such studies specify a Cobb-Douglas yield function and report a statistically significant dummy variable that equals 1 on adopting farms and 0 otherwise. The dummy variable coefficient may then be interpreted as the increase in yield resulting from technology adoption.

The marginal change in farm net benefit given a $1$% increase basal yield is expressed as follows.

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} &= (1 - h) \left( \frac{y^* \partial P}{\partial \ln(y_0)} + P \frac{\partial y^*}{\partial \ln(y_0)} \right) \\
&= (1 - h) P y^* \left( \frac{\partial \ln(P)}{\partial \ln(y_0)}  + \frac{\partial \ln(y^*)}{\partial \ln(y_0)} \right)
\end{split}
\end{equation}

Where

\begin{equation}
\frac{\partial \ln(y^*)}{\partial \ln(y_0)} = \frac{1}{1 - h} \left(1 + h \frac{\partial \ln(P)}{\partial \ln(y_0)} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right)
\label{eq:dLnYstardLny0}
\end{equation}

Substituting this for $\frac{\partial \ln(y^*)}{\partial \ln(y_0)}$ in the previous equation gives

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} &= (1 - h) P y^* \left( \frac{\partial \ln(P)}{\partial \ln(y_0)}  + \frac{1}{1 - h} \left(1 + h \frac{\partial \ln(P)}{\partial \ln(y_0)} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right) \right) \\
&= P y^* \left( \frac{\partial \ln(P)}{\partial \ln(y_0)} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} + 1  \right)
\label{eq:prodNBy0}
\end{split}
\end{equation}

Applying the adoption condition (inequality \ref{eq:adoptCondBasic}) and rearranging,

\begin{equation}
\begin{split}
1 &> \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} - \frac{\partial \ln(P)}{\partial \ln(y_0)} \\
\partial \ln(y_0) &> \boldsymbol{\alpha} \cdot \partial \ln(\mathbf{w}) - \partial \ln(P)
\end{split}
\label{eq:ydAdoptCondy0}
\end{equation}

This condition says that a farm stands to increase its net benefit through adoption of basal yield enhancing technology only if the percentage increase in basal yield is greater than the corresponding percentage increase in input prices (scaled by their respective input elasticities) minus the corresponding percentage change in output price.
<!-- More compactly, it says that the percentage increase in basal yield must be greater than the absolute value of the corresponding percentage decrease in the technology adjusted output-input price ratio ($r$). -->

Here it is important to keep in mind that the release and uptake of yield enhancing technology tends to boost supply, which in turn (by Axiom 3) lowers the output price $P$. At the same time, uptake of the new technology usually implies increased use of (i.e. demand for) inputs, which (by Axiom 4) drives up input prices. Also, the price of improved seeds (an input) is typically higher than the price of the status quo seed variety.

Hence, the general expectation is

\begin{equation}
\begin{split}
\frac{\partial \ln(P)}{\partial \ln(y_0)} &< 0 \\
\frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} &> 0
\end{split}
\label{eq:expectedPwChange}
\end{equation}

Note that the adoption condition in inequality \ref{eq:ydAdoptCondy0} closely resembles the "price/productivity tightrope" formulated by Lipton:

>\singlespacing "New science usually raises farm supply of outputs and demand for inputs. That makes outputs cheaper and inputs more expensive; hence the ratio of farm output prices to input prices falls. Do small and poor farmers gain? If, and only if, this science-induced fall in their relative farm prices is slower than the science-induced rise in their conversion ratio of physical inputs into physical outputs (that is, TFP)" [-@lipton2005family].

\doublespacing
(Where "TFP" refers to the basal yield, $y_0$.)

The one substantive difference between Lipton's condition and the condition derived in inequality \ref{eq:ydAdoptCondy0}, is that the percentage change in input prices in the latter are scaled by the technology $\boldsymbol{\alpha}$. Inequality \ref{eq:ydAdoptCondy0} might thus be called the "technology adjusted price/productivity tightrope".
<!-- "For new science to help poor farmers and poor food consumers (a lot), it must cut staples prices (a lot) but must raise total factor productivity (TFP) on small farms (a lot) faster.19  -->
<!-- In contrast to the adoption condition derived in the previous section (inequality \ref{eq:ydAdoptCond}), the technology adjusted price/productivity tightrope implies that, for given prices and technology ($y_0$ and $\boldsymbol{\alpha}$), either all farms or no farms adopt.  -->

Since $y_0$ and $\boldsymbol{\alpha}$ are population level parameters (they do not vary from farm to farm), the technology adjusted price/productivity tightrope implies that, for a given set of prices $\{P, \mathbf{w} \}$, all farms in the given population will either adopt or not adopt. In other words, the adoption rate of basal yield enhancing technology must be either 0% or 100% if prices are the same for all farms (i.e., if Jevons' "law of indifference" holds). Conversely, it follows that adoption rates between 0% and 100% imply that prices vary within the farm population.

Evidence from Kenya suggests that prices may vary considerably from district to district (Figure \ref{fig:pricesVary}). Prices may even vary considerably from village to village [@kirimi2011farm].
<!-- Impact assessment studies that assume unique prices while also reporting an adoption rate between 0% and 100% possibly stand in violation of one or more of Axioms 1-3. -->
<!-- In fact, input and output prices often vary considerably within a given farm population, especially in the developing world.  and this is reflected in adoption rates falling somewhere between 0% and 100%. -->

```{r, fig.show = 'hold', fig.width=7, fig.height=4, fig.align='center', fig.cap="\\label{fig:pricesVary}Maize and input prices by district in Kenya, 2007 USAID Tegemeo Agricultural Monitoring and Policy Analysis Project data.", echo = F}
turn_on <- F
if(turn_on){
# Get Kenya price data
this_folder <- "C:/Users/bensc/OneDrive/Documents/Data/Tegemeo Data/"
this_file <- "Kenya Tegemeo all bean maize input prices long.csv"
this_filepath <- paste0(this_folder, this_file)
df_price <- read.csv(this_filepath, stringsAsFactors = F)
ind_rm <- grep("bean|day", df_price$Item)
df_price <- df_price[-ind_rm, ]
df_price$Item <- gsub(" \\(KES/kg\\)", "", df_price$Item)
df_price$Item <- gsub("fert", "fertilizer", df_price$Item)
df_price$Item <- gsub("synth", "synthetic", df_price$Item)
df_price$Item[which(df_price$Item == "maize seed price")] <- "non-hybrid maize seed price"
colnames(df_price)[ncol(df_price)] <- "KES / kg"
df_price <- subset(df_price, Item != "wage (KES/hour)")
#---------------------------------------------------------------------------
# Check variations in prices across districts
library(tidyverse)
gg <- ggplot(df_price, aes(x = District, y = `KES / kg`))
gg <- gg + geom_bar(stat = "identity")# + coord_flip()
gg <- gg + facet_wrap(~Item, ncol = 2, scales = "free_y")
gg <- gg + theme(axis.title.x = element_blank(),
                 axis.text.x = element_text(angle = 60, hjust = 1))
#gg <- gg + coord_flip()
gg
}
```

Do adopting farms always find it in their best economic interest to increase output? Note from equation \ref{eq:dLnYstardLny0} that the output expansion condition $\frac{\partial \ln(y^*)}{\partial \ln(y_0)} > 0$ implies

\begin{equation}
\partial \ln(y_0) > \boldsymbol{\alpha} \cdot \partial \ln(\mathbf{w}) - h \partial \ln(P)
\end{equation}

Considering the domain $h \in(0, 1)$ (derived in section \ref{sec:degHomog}, above), it follows that all adopting farms increase their output.

## Technology change as a change in input elasticity \label{sec:techChangeAi}

The change in farm net benefit resulting from input enhancing technology is considerably more complex than the change resulting from basal yield enhancing technology due to the presence of $\alpha_v$ in multiple terms ($h$, $\beta_w$, $\beta_x$) within the net benefit envelope.

The marginal change in net benefit given a $1$% increase in one of the partial yields is expressed as follows.

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}^*}{\partial \ln(y_v)} &= \frac{\partial \mathcal{L}^*}{\partial \alpha_v} \\
&= (1 - h) \left(y^* \frac{\partial P}{\partial \alpha_i} + P \frac{\partial y^*}{\partial \alpha_v} \right) + P y^* \frac{\partial}{\partial \alpha_v} (1 - h) \\
&= (1 - h) P y^* \left(\frac{\partial \ln(y^*)}{\partial \alpha_v} + \frac{\partial \ln(P)}{\partial \alpha_v} - \frac{1}{1 - h} \right)
\label{eq:dLdai}
\end{split}
\end{equation}
<!-- Note that multiplying this through by $\alpha_i$ gives an instructive alternative expression. -->

<!-- \begin{equation} -->
<!-- \frac{\partial \mathcal{L}^*}{\partial \ln(\alpha_i)} = P y^* (1 - h) (\frac{\partial \ln(y^*)}{\partial \ln(\alpha_i)} + \frac{\partial \ln(y^*)}{\partial \ln(w_i)} - 1) -->
<!-- \end{equation} -->

<!-- Where (recall from section \ref{sec:inDem}) $\frac{\partial \ln(y^*)}{\partial \ln(w_i)}$ is the own price elasicity of demand for the input in question. -->

Where

\begin{equation}
\begin{split}
\frac{\partial \ln(y^*)}{\partial \alpha_v} &= \frac{\ln(y^*)}{1 - h} + \frac{1}{1 - h} \left(\ln \left(\frac{P}{\lambda} \right) + h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \ln(w_v) + \ln(\alpha_v) + 1 \right) \\
&= \frac{1}{1 - h} \left( \ln(y^*) + \ln \left(\frac{P}{\lambda} \right) + \ln \left(\frac{\alpha_v}{w_v} \right) + h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} + 1\right)
\end{split}
\end{equation}

But note from equation \ref{eq:YdEnvCompact} that

\begin{equation}
\ln \left( \frac{P}{\lambda} \right) = \frac{1}{h} ((1 - h) \ln(y^*) - \ln(y_0) - \ln(\beta)) \:\:; \:\:\: \beta = \frac{\beta_x \beta_k}{\beta_w}
\end{equation}

Substituting for $\ln(P / \lambda)$ in the previous equation then gives an expression in prices and population level parameters only.

\begin{equation}
\begin{split}
\frac{\partial \ln(y^*)}{\partial \alpha_v} &= \frac{1}{1 - h} \left(\ln(y^*) + \frac{1}{h} ((1 - h) \ln(y^*) - \ln(y_0) - \ln(\beta)) + \ln \left(\frac{\alpha_v}{w_v} \right) + h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} + 1 \right) \\
&= \frac{1}{1 - h} \left( \frac{1}{h} (\ln(y^*) - \ln(y_0) - \ln(\beta)) + \ln \left( \frac{\alpha_i}{w_v} \right) + h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} + 1 \right)
\end{split}
\label{eq:dLnyStardav}
\end{equation}

Substituting this expression for $\frac{\partial \ln(y^*)}{\partial \alpha_v}$ in equation \ref{eq:dLdai} then gives

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}^*}{\partial \ln(y_v)} &= \frac{\partial \mathcal{L}^*}{\partial \alpha_v} \\
&= (1 - h) Py^* \left[ \frac{1}{1 - h} \left( \frac{1}{h} (\ln(y^*) - \ln(y_0) - \ln(\beta)) + \ln \left( \frac{\alpha_v}{w_v} \right) + h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} + 1 \right) + \frac{\partial \ln(P)}{\partial \alpha_v} - \frac{1}{1 - h} \right] \\
&= Py^* \left[ \frac{1}{h} (\ln(y^*) - \ln(y_0) - \ln(\beta)) + \ln \left( \frac{\alpha_v}{w_v} \right) + h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} + (1 - h) \frac{\partial \ln(P)}{\partial \alpha_v} \right] \\
&= Py^* \left[ \frac{1}{h} (\ln(y^*) - \ln(y_0) - \ln(\beta)) + \ln \left(\frac{\alpha_v}{w_v} \right) + \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} \right]
\end{split}
\label{eq:dlnLstardlnav}
\end{equation}

The adoption condition $\frac{\partial \mathcal{L}^*}{\partial \ln(y_v)} > 0$ then implies

\begin{equation}
\frac{1}{h} (\ln(y^*) - \ln(y_0) - \ln(\beta)) + \ln \left(\frac{\alpha_v}{w_v} \right) + \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} > 0
\end{equation}

Which can be rearranged

\begin{equation}
\begin{split}
\frac{1}{h} (\ln(y^*) - \ln(y_0) - \ln(\beta)) &> \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \frac{\partial \ln(P)}{\partial \alpha_v} - \ln \left(\frac{\alpha_v}{w_v} \right) \\
\ln(y^*) &> h \left( \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \frac{\partial \ln(P)}{\partial \alpha_v} + \ln \left(\frac{w_v}{\alpha_v} \right) \right) + \ln(y_0) + \ln(\beta) \\
y^* &> y_0 \beta \left(\frac{w_v}{\alpha_v} \right)^h e^{h \left( \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \frac{\partial \ln(P)}{\partial \alpha_v} \right)}
\label{eq:adoptCondai}
\end{split}
\end{equation}
<!-- Now, it is not immediately self-evident from either of these equations whether $\frac{\partial \mathcal{L}^*}{\partial \alpha_i}$ is positive or negative for a given farm. By Axiom 2, only farms that stand to increase their net benefit will be interested in adoption of the new technology. That is, a farm is assumed to adopt only if $\frac{\partial \mathcal{L}^*}{\partial \ln(\alpha_i)} > 0$. Below, this condition is applied to equation \ref{eq:dLdai} to derive a measurable baseline yield adoption threshold. -->

That is to say, under Axioms 1-3, only farms with baseline yields greater than the righthand side of this inequality find it in their best economic interest to adopt the input enhancing technology. Farms with a baseline yield less than this would incur a decrease in their net benefit if they were to adopt.

How do adopting farms change their output given the new technology? Equation \ref{eq:dLnyStardav} together with the output expansion condition $\frac{\partial \ln(y^*)}{\partial \alpha_v} > 0$ imply that adopting farms increase output if

\begin{equation}
\begin{split}
\frac{1}{h} (\ln(y^*)) - \ln(y_0) - \ln(\beta) &> \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \frac{\partial \ln(P)}{\partial \alpha_v} + \ln \left(\frac{w_v}{\alpha_v} \right) - 1 \\
\ln(y^*) &> h \left( \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \frac{\partial \ln(P)}{\partial \alpha_v} + \ln \left(\frac{w_v}{\alpha_v} \right) - 1 \right) + \ln(y_0) + \ln(\beta) \\
y^* &> y_0 \beta \left(\frac{w_v}{\alpha_v} \right)^h e^{h \left( \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \frac{\partial \ln(P)}{\partial \alpha_v} + \ln \left(\frac{w_v}{\alpha_v} \right) - 1 \right)}
\label{eq:ydIncCondai}
\end{split}
\end{equation}

Which differs from the righthand side of inequality \ref{eq:adoptCondai} by a factor of

\begin{equation}
e^{h \left( (1 - h)\frac{\partial \ln(P)}{\partial \alpha_v} - 1 \right)}
\end{equation}

That is, letting $y^*_y$ denote the righthand side of inequality \ref{eq:ydIncCondai} and $y^*_{\mathcal{L}}$ the righthand side of inequality \ref{eq:adoptCondai},

\begin{equation}
y^*_y = e^{h \left( (1 - h)\frac{\partial \ln(P)}{\partial \alpha_v} - 1 \right)} y^*_{\mathcal{L}}
\label{eq:compLoBounds}
\end{equation}

If $y^*_y < y^*_{\mathcal{L}}$, then all adopting farms find it in their best economic interest to increase output. From equation \ref{eq:compLoBounds} it is clear that this is true if

\begin{equation}
\frac{\partial \ln(P)}{\partial \alpha_v} < \frac{1}{1 - h}
\end{equation}

Which is generally true given the domain of $h$ derived from Axioms 1-3 in section \ref{sec:degHomog}, and since it is generally expected that $\frac{\partial \ln(P)}{\partial \alpha_v} < 0$ (recall expression \ref{eq:expectedPwChange}).

Under circumstances of an exogenously imposed, involuntary increase in one of the input elasticities of yield, condition \ref{eq:ydIncCondai} implies that farms with baseline yields less than $y^*_y$ would choose to reduce ouput. Condition \ref{eq:adoptCondai} likewise implies a reduction in net benefit for farms with baseline yields less than $y^*_{\mathcal{L}}$. Farms with baseline yields between $y^*_y$ and $y^*_{\mathcal{L}}$, meanwhile, would suffer a decrease in net benefit but choose to increase output.
<!-- Note that, in some analyses, technology change may not be voluntary. A study may examine, for example, the possibility of increased fertilizer efficiency resulting from a deterioration extension services. In such cases, the net benefit of both  -->

## The demand side impact of supply side technology change 

As a general rule, demand side technology is left unaltered by a change in farm technology.^[Although there are important exceptions. Small granule cassava simluaneously reduces farm basal yield and increases bioethanol factory efficiency.] However, new farm technology does have an indirect impact on demand side net benefit $\mathcal{L}_D^*$ through its influence on the farm output price. For basal yield enhancing technology, the change in consumer net benefit works out as follows.

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}_D^*}{\partial \ln(y_0)} &= \frac{\partial \mathcal{L}_D^*}{\partial \ln(P)} \frac{\partial \ln(P)}{\partial \ln(y_0)} \\
&= \frac{\partial}{\partial \ln(P)} ((1 - h_D) P_D y_D^* + \lambda_D B_D) \frac{\partial \ln(P)}{\partial \ln(y_0)} \\
&= (1 - h_D) P_D \frac{\partial y_D^*}{\partial \ln(P)} \frac{\partial \ln(P)}{\partial \ln(y_0)} \\
&= -\alpha_D P_D y_D^* \frac{\partial \ln(P)}{\partial \ln(y_0)}
\end{split}
\label{eq:consNBy0}
\end{equation}

For input enhancing technology, the change in consumer net benefit works out as follows.

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}_D^*}{\partial \alpha_v} &= (1 - h_D) P_D y_D^* \left( \frac{\partial \ln(y_D^*)}{\partial \alpha_v}  + \frac{\partial \ln(P_D)}{\partial \alpha_v}\right) \\
&= (1 - h_D) P_D y_D^* \left(\frac{h_D \varepsilon - \alpha_D}{1 - h_D} \frac{\partial \ln(P)}{\partial \alpha_v}  + \varepsilon \frac{\partial \ln(P)}{\partial \alpha_v}\right) \\
&= (\varepsilon - \alpha_D) P_D y_D^* \frac{\partial \ln(P)}{\partial \alpha_v}
\end{split}
\label{eq:consNByv}
\end{equation}

Considering the expectation that $\frac{\partial \ln(P)}{\partial \alpha_v} < 0$, this means that consumer net benefit resulting from input enhancing technology is positive only if $\varepsilon < \alpha_D$.

# Aggregate supply and demand

## Aggregate supply \label{sec:aggSupply}

Farm production $q^*$ is, of course, just farm yield envelope times farm area. If area is one of the control variables in the yield envelope, then $q^*$ is given by adding $1$ to the fitted exponent (call this $\kappa_a$) on area.

\begin{equation}
\begin{split}
q^* &= A y^* \\
&= y_0 \hat{\beta}^{\eta(D)} \left(\frac{E[P(T)]\bigr|_{t = 0}}{\lambda}\right)^{\eta(E[P(T)]\bigr|_{t = 0})}
\end{split}
\end{equation}

Where

\begin{equation}
\hat{\beta} &= \frac{\beta_x \hat{\beta_k}}{\beta_w} \\
\hat{\beta_k} &= A \beta_k = A^{\kappa_a + 1} \Prod_{i \neq a}^{n_k} k_i^{\kappa_i}
\end{equation}

And maximum economic production for given $A$, assuming farms only enter production if their expected revenue is greater than their cost (recall equation \ref{eq:ydUpBound}), is

\begin{equation}
\begin{split}
\bar{q}^* &= A \bar{y}^* \\
&= y_0 \hat{\beta}^{\eta(D)} \left(\frac{E[P(T)]\bigr|_{t = 0}}{h}\right)^{\eta(E[P(T)]\bigr|_{t = 0})}
\end{split}
\end{equation}

By definition, expected aggregate supply at or around the time of planting must be the definite integral of expected farm production over its density, from $0$ to maximum expected economic farm production $\bar{q}^*$.

\begin{equation}
Q_S = \int_{0}^{\bar{q}^*} q^* \rho(q^*) \: dq^*
\end{equation}

Where the farm density $\rho(q^*)$ function is defined such that

\begin{equation}
\rho(q^*) = \int_{0}^{\infty} \rho(q^*) \: dq^* = N_f
\end{equation}

Where $N_f$ is the number of farms in the population. The farm density may thus be rewritten in terms of a probability density function $f(q^*)$ as follows.

\begin{equation}
\rho(q^*) = N_f f(q^*)
\end{equation}

Supply can also of course be defined in terms of an integral of farm yield over its density.

\begin{equation}
Q_S = \int_{0}^{\bar{y}^*} y^* \rho(y^*) \: dq^*
\end{equation}

Where the yield density is defined such that

\begin{equation}
\rho(y^*) = \int_{0}^{\infty} \rho(y^*) \: dy^* = N_a
\end{equation}

Where $N_a$ is the number of acres (or whatever the unit of area is) in the population.

The latter expression may be more suitable when dealing with remote sensing data. The former is more suitable when dealing with farm survey data, as here.

\begin{equation}
\begin{split}
E[Q_S(T)]\bigr|_{t = 0} &= N_f \int_{0}^{\bar{q}^*} q^* f(q^*) \: dq^* \\
&= N_f y_0^{\eta(D)} E[\hat{\beta}^{\eta(D)}] E[P(T)]\bigr|_{t = 0}^{\eta(P)} \int_{0}^{h^{-\eta(P)}} \lambda^{-\eta(P)} f(q^*) \: dq^*
\end{split}
\label{eq:QSeq}
\end{equation}

By the law of the unconscious statistician, the integral in the expression above can be rewritten

\begin{equation}
\int_{0}^{h^{-\eta(P)}} \lambda^{-\eta(P)} f(q^*) \: dq^* = \int_{0}^{h^{-\eta(P)}} \lambda^{-\eta(P)} f(\lambda^{-\eta(P)}) \: d \lambda^{-\eta(P)}
\end{equation}

Which, by the Lemma given in the Appendix, then resolves as follows.

\begin{equation}
\int_{0}^{h^{-\eta(P)}} \lambda^{-\eta(P)} f(\lambda^{-\eta(P)}) \: d \lambda^{-\eta(P)} = E[\lambda^{-\eta(P)}] (1 - \Phi(z))
\end{equation}

Where

\begin{equation}
\begin{split}
z = \frac{\ln\left( \left( \frac{\mu_{\tilde{C}}(0)}{P(0)} \right)^{\eta(D)} \right) - \left(\eta(D) m_{\lambda} - \eta(D)^2 \frac{s_{\lambda}^2}{2} \right)T \right)}{s_{\lambda} \sqrt{T}}
\end{split}
\end{equation}

The term $1 - \Phi(z)$ may thus be interpreted as the probability, at planting time, that the elasticity adjusted output price at time of harvest and sale $P(T)^{\eta(P)}$ will be greater than the corresponding elasticity adjusted mean marginal cost of production $\mu_{\tilde{C}}(T)^{\eta(D)}$.

\begin{equation}
1 - \Phi(z) = \text{Prob}(P(T)^{\eta(D)} > \mu_{\tilde{C}}(T)^{\eta(D)})
\end{equation}

There are two sources of uncertainty. Price risk ...Marginal cost of production is a function of input quantities purchased, input prices, and yield. Input prices and quantities are not a source of risk here as all major expenditures have been made and are known by the time of planting, when the evaluation is made. This leaves agroclimatic risk surrounding yield as the major source of uncertainty surrounding the ultimate value of marginal cost of production.

The effect of $\eta(D)$ in this equation is to regulate the rate at which the condition $P(T)^{\eta(D)} > \mu_{\tilde{C}}(T)^{\eta(D)}$ is met (or fails) with changes in either $P(T)$ or $\mu_{\tilde{C}}(T)$. To see this, it may be helpful to rewrite the condition in terms of a "marginal benefit-cost" ratio $r$.

\begin{equation}
1 - \Phi(z) = \text{Prob}(r^{\eta(D)} > 1) \:\:;\:\:\: r = P(T) / \mu_{\tilde{C}}(T)
\end{equation}

As $\eta(D)$ is lower, $r^{\eta(D)}$ changes less when $r$ changes. As $\eta(D)$ is higher, movements of $r^{\eta(D)}$ become more pronounced in response to changes in $r$.







Using equation \ref{eq:YdEnvCompact} to substitute for $y^*$ and factoring out constants, the "ceteris paribus aggregate supply"---i.e., the aggregate supply for a given $\beta_k$---can be written as follows.

\begin{equation}
Q_S \bigr|_{\beta_k} = N_S \left(y_0 \frac{\beta_x \beta_k}{\beta_w} P^h \right)^{\frac{1}{1 - h}} \int_h^{\infty} \lambda^{\frac{-h}{1 - h}} f_{\lambda}(\lambda) \: d \lambda
\label{eq:QSeqPcetPar}
\end{equation}
<!-- Where -->
<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- \chi &= \lambda^{\frac{-h}{1 - h}} \\ -->
<!-- \bar{\chi} &= h^{\frac{-h}{1 - h}} -->
<!-- \end{split} -->
<!-- \end{equation} -->

Where the law of the unconscious statistician has been invoked to replace $f(y^*) \: dy^*$ with $f_{\lambda}(\lambda) \: d \lambda$.

Aggregate supply is then found by integrating eqaution \ref{eq:QSeqPcetPar} over the density of $\beta_k^{\frac{1}{1 - h}}$.

\begin{equation}
\begin{split}
Q_S &= \int_{0}^{\infty} \left[ N_S \left(y_0 \frac{\beta_x \beta_k}{\beta_w} P^h \right)^{\frac{1}{1 - h}} \int_{h}^{\infty} \lambda^{\frac{-h}{1 - h}} f_{\lambda}(\lambda) \: d \lambda \right] \: g_k(\beta_k^{\frac{1}{1 - h}}) d \beta_k^{\frac{1}{1 - h}} \\
&= N_S \left(y_0 \frac{\beta_x}{\beta_w} P^h \right)^{\frac{1}{1 - h}} \int_{0}^{\infty} \beta_k^{\frac{1}{1 - h}} f_k(\beta_k) \: d \beta_k \int_{h}^{\infty} \lambda^{\frac{-h}{1 - h}} f_{\lambda}(\lambda) \: d \lambda \\
&= N_S \left(y_0 \frac{\beta_x}{\beta_w} P^h \right)^{\frac{1}{1 - h}} \mu_{k*} \int_{h}^{\infty} \lambda^{\frac{-h}{1 - h}} f_{\lambda}(\lambda) \: d \lambda
\end{split}
\label{eq:QSeqP}
\end{equation}

Where $\mu_{k*} = E(\beta_k^{\frac{1}{1 - h}})$; and where the law of the unconscious statistician has again been invoked to replace $g_k(\beta_k^{\frac{1}{1 - h}}) \: d \beta_k^{\frac{1}{1 - h}}$ with $f_k(\beta_k) \: d \beta_k$.

Evaluation of aggregate supply thus appears to require the introduction of two
new Axioms: the density functions of $\lambda$ and $\beta_k$. However, note that $\lambda^{\frac{-h}{1 - h}}$ and $\beta_k^{\frac{1}{1 - h}}$ are proportionate to $y^*$. That is to say,

\begin{equation}
\begin{split}
\lambda^{\frac{-h}{1 - h}} &= V y^* \\
\beta_k^{\frac{1}{1 - h}} &= W y^*
\end{split}
\end{equation}

Where $V$ and $W$ are constants that can be worked out from equation \ref{eq:YdEnvCompact}. The density functions of $\lambda^{\frac{-h}{1 - h}}$ and $\beta_k^{\frac{1}{1 - h}}$ are thus related to the economic yield density function as follows.

\begin{equation}
\begin{split}
g_{\lambda}(\lambda^{\frac{-h}{1 - h}}) &= V f(y^*) \\
g_k(\beta_k^{\frac{1}{1 - h}}) &= W f(y^*)
\end{split}
\end{equation}

That is to say, the density functions of $\lambda^{\frac{-h}{1 - h}}$ and $\beta_k^{\frac{1}{1 - h}}$ are equal to the density function of $y^*$ up to a constant. Therefore, only one new Axiom is introduced in the derivation of the aggregate supply curve.

\begin{framed}
   \textbf{Axiom 7} \\ The economic yield density function, $f(y^*)$.
\end{framed}
<!-- This is something of a relief, as it is generally much easier, empirically speaking, to infer the density function $f(y^*)$ than it is to infer $g_{\lambda}(\lambda^{\frac{-h}{1 - h}})$ or $g_k(\beta_k^{\frac{1}{1 - h}})$. -->
<!-- (In the derivation of the aggregate supply curve above, the density functions $g_{\lambda}(\lambda^{\frac{-h}{1 - h}})$ and $g_k(\beta_k^{\frac{1}{1 - h}})$ are subsequently replaced by density functions $f_{\lambda}(\lambda)$ and $f_k(\beta_k)$ via the law of the unconscious statistician.) -->

In the developing world, economic yields often follow a right skewed distribution such as the lognormal distribution. If economic yield is lognormally distributed, then, by Hull's result^[See Appendix.], the last integral in equation \ref{eq:QSeqP} can be rewritten as follows.

\begin{equation}
\int_{h}^{\infty} \lambda^{\frac{-h}{1 - h}} f_{\lambda}(\lambda) \: d \lambda = \mu_{\ell} \Phi(\bar{\gamma})
\end{equation}

Where

\begin{equation}
\mu_{\ell} = e^{\frac{-h}{1 - h} m_{\lambda} + \frac{1}{2} \frac{h^2}{(1 - h)^2} s_{\lambda}^2} \:\:;\:\:\: m_{\lambda} = E(\ln(\lambda)) \:, \:\: s_{\lambda}^2 = Var(\ln(\lambda))
\end{equation}

And

\begin{equation}
\bar{\gamma} = -\frac{\ln(h) - m_{\lambda}}{s_{\lambda}} - \frac{h}{1 - h} s_{\lambda}
\end{equation}

And where $\Phi(\bar{\gamma})$ is the standard cumulative normal distribution function evaluated at $\bar{\gamma}$.

\begin{equation}
\Phi(\bar{\gamma}) = \frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\bar{\gamma}} e^{t^2/2} \: dt
\end{equation}

Note, moreover, that, assuming $y^*$ is lognormally distributed, $\mu_{\ell}$ and $\mu_{k*}$ reduce to more practical and instructive forms.

\begin{equation}
\begin{split}
\mu_{\ell} &= e^{\frac{h}{(1 - h)^2} \left( -(1 - h) m_{\lambda} + \frac{1}{2} h s_{\lambda}^2 \right)} \\
&= e^{\frac{h^2}{(1 - h)^2} \left( m_{\lambda} + \frac{1}{2} s_{\lambda}^2 \right)} e^{\frac{-h}{(1 - h)^2} m_{\lambda}} \\
&= \left( \frac{\mu_{\lambda}^h}{M_{\lambda}} \right)^{\frac{h}{(1 - h)^2}}
\end{split}
\end{equation}

Where $\mu_{\lambda} = E(\lambda)$, and $M_{\lambda}$ is the median of $\lambda$.

\begin{equation}
\begin{split}
\mu_{k*} &= e^{\frac{1}{1 - h} m_k + \frac{1}{2} \frac{1}{(1 - h)^2} s_k^2} \:\:;\:\:\: m_k = E(\ln(\beta_k)) \:, \:\: s_k^2 = Var(\ln(\beta_k)) \\
&= e^{\frac{1}{(1 - h)^2} \left( (1 - h) m_k + \frac{1}{2} s_k^2 \right) } \\
&= e^{\frac{1}{(1 - h)^2} \left(m_k + \frac{1}{2} s_k^2 \right) } e^{\frac{-h}{(1 - h)^2} m_k} \\
&= \left( \frac{\mu_k}{M_k^h} \right)^{\frac{1}{(1 - h)^2}}
\end{split}
\end{equation}

Where $\mu_k = E(\beta_k)$, and $M_k$ is the median of $\beta_k$.

Under the assumption of lognormally distributed economic yields, then, the aggregate supply curve may be rewritten as follows.

\begin{equation}
Q_S = N_S \left(y_0 \frac{\beta_x}{\beta_w} P^h \right)^{\frac{1}{1 - h}} \left( \frac{\mu_k}{M_k^h} \right)^{\frac{1}{(1 - h)^2}} \left( \frac{\mu_{\lambda}^h}{M_{\lambda}} \right)^{\frac{h}{(1 - h)^2}} \Phi(\bar{\gamma})
\label{eq:QSHull}
\end{equation}

### The output price elasticity of aggregate supply \label{sec:pElastQS}

In section \ref{sec:degHomog} it was shown that the farm supply curve is a power law. The aggregate supply curve derived in equation \ref{eq:QSeqP} is also a power law or constant elasticity of supply curve. This becomes more evident if the equation is expressed in the following compact form.

\begin{equation}
Q_S = \theta_S P^{\eta(P, Q_S)}
\label{eq:QSeqPcompact}
\end{equation}

Where

\begin{equation}
\theta_S = N_S \left(y_0 \frac{\beta_x}{\beta_w} \right)^{\frac{1}{1 - h}} \mu_{k*} \int_{h}^{\infty} \lambda^{\frac{-h}{1 - h}} f_{\lambda}(\lambda) \: d \lambda
\end{equation}

And $\eta(P, Q_S)$ is the output price elasticity of aggregate supply.

\begin{equation}
\begin{split}
\eta(P, Q_S) &= \frac{\partial \ln(Q_S)}{\partial \ln(P)} \\
&= \frac{h}{1 - h}
\end{split}
\label{eq:PelastQS}
\end{equation}

Which is the same as the output price elasticity of supply at the farm level (equation \ref{eq:PelastYstar}). The bounds on output price elasticity of supply at the farm level thus apply at the aggregate level as well. That is to say, the aggregate supply curve is elastic over $h \in (1 / 2, 1)$, inelastic over $h \in (0, 1 / 2)$, and linear with slope $\theta_S \bigr|_{h = 1 / 2}$ at $h = 1 / 2$.

This means that, for relatively input-efficient farm populations ($h > 1 / 2$), the aggregate supply response to an increase in output price is more than proportionate to the price increase; while, for relatively input-inefficient farm populations ($h < 1 / 2$), the aggregate supply response to an increase in output price is less than proportionate to the price increase.

Like the farm supply curve, the aggregate supply curve approaches perfect inelasticity as $h$ approaches $0$, and approaches perfect elasticity as $h$ approaches $1$. The scale factor $\theta_S$ approaches $0$ as $h$ approaches $0$, and tends toward infinity as $h$ approaches $1$.

### Two debates settled

The foregoing theoretical derivation of the aggregate supply curve (equation \ref{eq:QSeqP}) and the corresponding output price elasticity of aggregate supply (equation \ref{eq:PelastQS}) settles two longstanding debates.

First, it puts to rest the debate over whether or not the aggregate supply curve is linear. In section \ref{sec:pElastQS}, immediately above, it is demonstrated that, insofar as Axioms 1-4 are true, the widely held assumption that supply curves are linear is true only when $h = 1 / 2$.

The second debate put to rest by equation \ref{eq:QSeqP} concerns whether the research induced change in the supply curve is best modeled as a "shift" (i.e., a translation) of the curve, or as a "pivot".

If the new technology comes in the form of an increase in the basal yield, then from equation \ref{eq:QSeqPcompact} it is clear that the new technology results in an increase in $\theta_S$, which generates a pivot of the supply curve, not a shift.

If the new technology comes in the form of an increase in one of the input elasticities of yield, then the resulting change in the supply curve is considerably more complex since changes occur in both the scale parameter $\theta_S$ and in the exponent $\eta(P, Q_S)$. Nonetheless, even in these cases, it is straightforward to see that the change is never a shift, and can be characterized as a pivot except in cases where the change in the exponent results in a change from elastic to inelastic, or vice versa.
<!-- x <- seq(1, 100, 1) -->
<!-- y <- 1.5 * x^0.8 -->
<!-- y2 <-1.6 * x^1.2 -->
<!-- plot(x, y) -->
<!-- points(x, y2) -->

<!-- ### Aggregating supply over varying prices -->

<!-- Equations \ref{eq:QSeqP} and \ref{eq:QSeqPcompact} refer to the aggregate supply for a given set of output and input prices $\{P, \mathbf{w}\}$. As discussed above, output and input prices can vary considerably within a farm population (i.e., for a given technology $\{y_0, \boldsymbol{\alpha} \}$), especially in the developing world. -->

<!-- To evaluate aggregate supply across all prices, then, it is necessary to integrate aggregate supply over the density of input and output prices. This can be done by defining a new variable $r$, -->

<!-- \begin{equation} -->
<!-- r = \frac{P^h}{\prod_i w_i^{\alpha_i}} -->
<!-- \end{equation} -->

<!-- This may be thought of as the "technology adjusted output-input price ratio". Integrating equation \ref{eq:QSeqP} over the density of $r$, giving -->

<!-- \begin{equation} -->
<!-- Q_S = N_S (y_0 \beta_x)^{\frac{1}{1 - h}} \mu_r \mu_{k*} \int_{0}^{\bar{\chi}} \chi f_{\lambda}(\lambda) \: d\lambda -->
<!-- \end{equation} -->

<!-- Where -->

<!-- \begin{equation} -->
<!-- \mu_r = \int_0^{\infty} r^{\frac{1}{1 - h}} f_r(r) dr = E \left(r^{\frac{1}{1 - h}} \right) -->
<!-- \end{equation} -->

<!-- This requires the introduction of Axiom ..., $f_r(r)$, the assumed density function of $r$ (Axiom ...). -->

## Aggregate demand

Aggregate demand, is, by definition, the consumer demand envelope (equation \ref{eq:inputDemDEM}) integrated over its density $f_D \left(x_D^* \right)$.

\begin{equation}
Q_D = \int_0^{\bar{x}_D^*} x_D^* N_D f_D \left(x_D^* \right) d x_D^*
\end{equation}

Where the density is scaled by $N_D$, the number of consumers in the demand side population, and $\bar{x}_D^*$ is the upper bound on any individual consumer's demand (inequality \ref{eq:inputUpBoundDEM}).

Using equation \ref{eq:inputDemDEM} to substitute for $x_D^*$, and factoring out constants, the "ceteris paribus aggregate demand"---i.e., the aggregate demand for a given $\beta_k^D$---can be written as follows.

\begin{equation}
Q_D = N_D \alpha_D P^{\frac{\varepsilon - \alpha_D}{1 - h_D} + 1} \left( y_0^D b \frac{\beta_k^D \beta_x^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}} \int_{h_D}^{\infty} \lambda_D^{\frac{-h_D}{1 - h_D}} f_{\lambda}^D \left(\lambda_D \right) \: d \lambda_D
\label{eq:QDcetPar}
\end{equation}
<!-- Where -->
<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- \chi_D &= \lambda_D^{\frac{-h_D}{1 - h_D}} \\ -->
<!-- \bar{\chi}_D &= h_D^{\frac{-h_D}{1 - h_D}} -->
<!-- \end{split} -->
<!-- \end{equation} -->

Where the law of the unconscious statistician has been invoked to replace $f_D \left(x_D^* \right) \: dx_D^*$ with $f_{\lambda}^D \left( \lambda_D \right) \: d\chi_D$.

Aggregate demand is then found by integrating eqaution \ref{eq:QDcetPar} over the density of ${\beta_k^D}^{\frac{1}{1 - h_D}}$.

\begin{equation}
\begin{split}
Q_D &= \int_0^{\infty} \left[ N_D \alpha_D P^{\frac{\varepsilon - \alpha_D}{1 - h_D} + 1} \left( y_0^D b \frac{ \beta_k^D \beta_x^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}} \int_0^{\infty} {\beta_k^D}^{\frac{1}{1 - h_D}} \int_{h_D}^{\infty} \lambda_D^{\frac{-h_D}{1 - h_D}} f_{\lambda}^D \left(\lambda_D \right) \: d \lambda_D \right] g_k^D \left( {\beta_k^D}^{\frac{1}{1 - h}} \right) \: d \left( {\beta_k^D}^{\frac{1}{1 - h_D}} \right) \\
&= N_D \alpha_D P^{\frac{\varepsilon - \alpha_D}{1 - h_D} + 1} \left( y_0^D b \frac{ \beta_x^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}} \int_0^{\infty} {\beta_k^D}^{\frac{1}{1 - h_D}} g_k^D \left( {\beta_k^D}^{\frac{1}{1 - h_D}} \right) \: d \left( {\beta_k^D}^{\frac{1}{1 - h_D}} \right) \int_{h_D}^{\infty} \lambda_D^{\frac{-h_D}{1 - h_D}} f_{\lambda}^D \left(\lambda_D \right) \: d \lambda_D \\
&= N_D \alpha_D P^{\frac{\varepsilon - \alpha_D}{1 - h_D} + 1} \left( y_0^D b \frac{ \beta_x^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}} \int_0^{\infty} {\beta_k^D}^{\frac{1}{1 - h_D}} f_k^D \left( \beta_k^D \right) \: d \beta_k^D \int_{h_D}^{\infty} \lambda_D^{\frac{-h_D}{1 - h_D}} f_{\lambda}^D \left(\lambda_D \right) \: d \lambda_D \\
&= N_D \alpha_D P^{\frac{\varepsilon - \alpha_D}{1 - h_D} + 1} \left( y_0^D b \frac{ \beta_x^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}} \mu_{k*}^D \int_{h_D}^{\infty} \lambda_D^{\frac{-h_D}{1 - h_D}} f_{\lambda}^D \left(\lambda_D \right) \: d \lambda_D
\end{split}
\label{eq:QD}
\end{equation}

Where $\mu_{k*}^D = E({\beta_k^D}^{\frac{1}{1 - h_D}})$; and where the law of the unconscious statistician has again been invoked to replace $g_k^D({\beta_k^D}^{\frac{1}{1 - h_D}}) \: d {\beta_k^D}^{\frac{1}{1 - h_D}}$ with $f_k^D(\beta_k^D) \: d \beta_k^D$.

Noting that $\lambda_D^{\frac{-h_D}{1 - h_D}}$ and ${\beta_k^D}^{\frac{1}{1 - h_D}}$ are proportionate to $x_D^*$, the corresponding density functions are thus equal to the density function of $x_D^*$ up to a constant. Therefore, only one new Axiom is introduced in the derivation of the aggregate demand curve.

\begin{framed}
   \textbf{Axiom 8} \\ The consumer demand density function, $f_D(x_D^*)$.
\end{framed}

<!-- This is something of a relief, as it is generally much easier, empirically speaking, to infer the density function $f(y^*)$ than it is to infer $g_{\lambda}(\beta_k^{\frac{1}{1 - h}})$ or $g_k(\beta_k^{\frac{1}{1 - h}})$. -->
(In the derivation of the aggregate demand curve above, the density functions $g_{\lambda}^D({\lambda_D}{\frac{-h_D}{1 - h_D}})$ and $g_k^D(\beta_k^{\frac{1}{1 - h_D}})$ are subsequently replaced by density functions $f_{\lambda}^D(\lambda_D)$ and $f_k^D(\beta_k^D)$ via the law of the unconscious statistician.)

If consumer demand is lognormally distribution, then, by Hull's result^[See Appendix.], the last integral in equation \ref{eq:QD} can be rewritten as follows.

\begin{equation}
\int_{h_D}^{\infty} \lambda_D^{\frac{-h_D}{1 - h_D}} f_{\lambda}^D \left(\lambda_D \right) \: d \lambda_D = \mu_{\ell}^D \Phi(\bar{\gamma}_D)
\end{equation}

Where

\begin{equation}
\mu_{\ell}^D = e^{\frac{-h_D}{1 - h_D} m_{\lambda}^D + \frac{1}{2} \frac{h_D^2}{(1 - h_D)^2} {s_{\lambda}^D}^2} \:\:;\:\:\: m_{\lambda}^D = E(\ln(\lambda_D)) \:, \:\: {s_{\lambda}^D}^2 = Var(\ln(\lambda_D))
\end{equation}

And

\begin{equation}
\bar{\gamma}_D = -\frac{\ln(h_D) - m_{\lambda}^D}{s_{\lambda}^D} - \frac{h_D}{1 - h_D} s_{\lambda}^D
\end{equation}

And where $\Phi(\bar{\gamma}_D)$ is the standard cumulative normal distribution function evaluated at $\bar{\gamma}_D$.

\begin{equation}
\Phi(\bar{\gamma}_D) = \frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\bar{\gamma}_D} e^{t^2/2} \: dt
\end{equation}

Note, moreover, that, assuming $x_D^*$ is lognormally distributed, $\mu_{\ell}^D$ and $\mu_{k*}^D$ reduce to more practical and instructive forms.

\begin{equation}
\begin{split}
\mu_{\ell}^D &= e^{\frac{h_D}{(1 - h_D)^2} \left( -(1 - h_D) m_{\lambda}^D + \frac{1}{2} h_D {s_{\lambda}^D}^2 \right)} \\
&= e^{\frac{h_D^2}{(1 - h_D)^2} \left( m_{\lambda} + \frac{1}{2} {s_{\lambda}^D}^2 \right)} e^{\frac{-h_D}{(1 - h_D)^2} m_{\lambda}^D} \\
&= \left( \frac{{\mu_{\lambda}^D}^{h_D}}{M_{\lambda}^D} \right)^{\frac{h_D}{(1 - h_D)^2}}
\end{split}
\end{equation}

Where $\mu_{\lambda} = E(\lambda)$, and $M_{\lambda}$ is the median of $\lambda$.

\begin{equation}
\begin{split}
\mu_{k*}^D &= e^{\frac{1}{1 - h_D} m_k^D + \frac{1}{2} \frac{1}{(1 - h_D)^2} s_k^2} \:\:;\:\:\: m_k^D = E(\ln(\beta_k^D)) \:, \:\: {s_k^D}^2 = Var(\ln(\beta_k^D)) \\
&= e^{\frac{1}{(1 - h_D)^2} \left((1 - h_D) m_k^D + \frac{1}{2} {s_k^D}^2 \right) } \\
&= e^{\frac{1}{(1 - h_D)^2} \left(m_k^D + \frac{1}{2} {s_k^D}^2 \right) } e^{\frac{-h_D}{(1 - h_D)^2} m_k^D} \\
&= \left( \frac{\mu_k^D}{{M_k^D}^h_D} \right)^{\frac{1}{(1 - h_D)^2}}
\end{split}
\end{equation}

Where $\mu_k^D = E(\beta_k^D)$, and $M_k^D$ is the median of $\beta_k^D$.

Under the assumption of lognormally distributed economic yields, then, the aggregate demand curve may be rewritten as follows.

\begin{equation}
Q_D = N_D \left( \frac{\alpha_D}{P} \right)^{\frac{\varepsilon - \alpha_D}{1 - h_D} + 1} \left( y_0^D b \frac{ \beta_x^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}} \left( \frac{\mu_k^D}{{M_k^D}^{h_D}} \right)^{\frac{1}{(1 - h_D)^2}} \left( \frac{{\mu_{\lambda}^D}^{h_D}}{M_{\lambda}^D} \right)^{\frac{h_D}{(1 - h_D)^2}} \Phi(\bar{\gamma}_D)
\label{eq:QDHull}
\end{equation}

### The output price elasticity of aggregate demand \label{sec:pElastQD}

In section \ref{sec:consDem} it was shown that the consumer demand curve is a power law. The aggregate demand curve derived in equation \ref{eq:QD} is also a power law. This becomes more evident if the equation is expressed in the following compact form.

\begin{equation}
Q_D = \theta_D P^{\eta(P, Q_D)}
\label{eq:QDcompact}
\end{equation}

Where

\begin{equation}
\theta_D = N_D (\alpha_D)^{\frac{\varepsilon - \alpha_D}{1 - h_D} + 1} \left(y_0^D b \frac{\beta_x^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}} \mu_{k*}^D
\end{equation}

And the exponent $\eta(P, Q_D)$ is the farm price elasticity of demand.

\begin{equation}
\begin{split}
\eta(P, Q_D) &= \frac{\partial \ln(Q_D)}{\partial \ln(Q_D)} \\
&= \frac{\varepsilon - \alpha_D}{1 - h_D} - 1
\end{split}
\label{eq:PelasDemAgg}
\end{equation}

Which is the same as the price elasticity of demand at the level of individual consumers, derived in equation \ref{eq:PelasDem}. It follows that the aggregate demand curve is likewise elastic ($\frac{\partial \ln(x_D^*)}{\partial \ln(P)} < -1$) so long as $\varepsilon \in (0, \alpha_D)$, and inelastic ($\frac{\partial \ln(x_D^*)}{\partial \ln(P)} < -1$) over $\varepsilon \in (\alpha_D, 1 - h_D + \alpha_D)$. Like the consumer demand curve, the aggregate demand curve approaches, but never reaches, perfect inelasticity as $\varepsilon$ approaches its upper bound $1 - h_D + \alpha_D$.
<!-- This means that, for relatively input-efficient farm populations ($h > 1 / 2$), the aggregate supply response to an increase in output price is more than proportionate to the price increase; while, for relatively input-inefficient farm populations ($h < 1 / 2$), the aggregate supply response to an increase in output price is less than proportionate to the price increase. -->
<!-- Like the farm supply curve, the aggregate supply curve approaches perfect inelasticity as $h$ approaches $0$, and approaches perfect elasticity as $h$ approaches $1$. However, $\theta_S$ approaches $0$ as $h$ approaches $0$, and tends toward infinity as $h$ approaches $1$, such that neither perfect elasticity nor inelasticity are ever reached; but rather aggregate supply is $0$ at $h = 0$ and infinite at $h = 1$. -->
<!-- ### Aggregating demand over varying prices -->
<!-- Equations \ref{eq:QD} and \ref{eq:QDcompact} give the aggregate demand for a given farm output price $P$. As discussed in previous sections, output price can vary considerably within the farm population, especially in the developing world. To aggregate demand across all prices, then, it is necessary to integrate equation \ref{eq:QD} over the price density. -->
<!-- \begin{equation} -->
<!-- Q_D = N_D \left(\alpha_D \right)^{\frac{\alpha_D}{1 - h_D} + 1} (y_0^D P_D \tilde{\beta}_w^{D - 1} \beta_x^D)^{\frac{1}{1 - h_D}} \mu_P \mu_{k*}^D \int_0^{\bar{\chi}_D} \chi_D f_D \left(\chi_D \right) d \chi_D -->
<!-- \end{equation} -->
<!-- Where -->
<!-- \begin{equation} -->
<!-- \mu_P = \int_0^{\infty} P^{\eta(P, Q_D)} u(P) dP = E \left(P^{\eta(P, Q_D)} \right) -->
<!-- \end{equation} -->
<!-- And where $u()$ is the assumed density function of $P$ (Axiom 8). -->

# Equilibrium price and quantity

A closed form solution for equilibrium price $P_e$ can be derived by setting the aggregate supply and demand curves (equations \ref{eq:QSeqPcompact} and \ref{eq:QDcompact}) equal to each other and then solving for $P$ as follows.

\begin{equation}
\begin{split}
Q_S &= Q_D \\
\theta_S P^{\eta_S} &= \theta_D P^{\eta_D} \\
P_e &= P \bigr|_{Q_S = Q_D} = \left(\frac{\theta_S}{\theta_D} \right)^{\frac{1}{\eta_D - \eta_S}}
\label{eq:defPe}
\end{split}
\end{equation}

Where the shorthands $\eta_S$ and $\eta_D$ have been introduced to stand for the price elasticities of supply and demand, respectively, defined in equations \ref{eq:PelastQS} and \ref{eq:PelasDemAgg}.

The equilibrium quantity $Q_e$ then follows by evaluating either $Q_S$ or $Q_D$ at $P_e$.

\begin{equation}
Q_e = Q_S \bigr|_{P = P_e} = \left( \frac{\theta_S^{\eta_D}}{\theta_D^{\eta_S}} \right)^{\frac{1}{\eta_D - \eta_S}}
\end{equation}

## The impact of new technology on equilibrium price and quantity

### Basal yield enhancing technology and equilibrium price and quantity

The percentage change in equilibrium supply given a $1$% increase in basal yield is given by

\begin{equation}
\begin{split}
\frac{\partial \ln(Q_e)}{\partial \ln(y_0)} &= \frac{\eta_D}{\eta_D - \eta_S} \frac{\partial \ln(\theta_S)}{\partial \ln(y_0)} \\
&= \frac{\eta_D \left(1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right)}{(\eta_D - \eta_S) (1 - h)}
\end{split}
\end{equation}

By Axioms 1-4, $\eta_S > 0$, $\eta_D < 0$, and $0 < h < 1$. The change in equilibrium supply given release of basal yield enhancing technology is thus positive ($\frac{\partial \ln(Q_e)}{\partial \ln(y_0)} > 0$) so long as

\begin{equation}
\partial \ln(y_0) > \boldsymbol{\alpha} \cdot \partial \ln(\mathbf{w})
\label{eq:QeIncCond}
\end{equation}

Which is always true on adopting farms. (Recall the adoption condition derived in inequality \ref{eq:ydAdoptCondy0}.)

The percentage change in equilibrium price given a $1$% increase in basal yield, meanwhile, is given by

\begin{equation}
\begin{split}
\frac{\partial \ln(P_e)}{\partial \ln(y_0)} &= \frac{1}{\eta_D - \eta_S} \frac{\partial \ln(\theta_S)}{\partial \ln(y_0)} \\
&= \frac{\left(1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right)}{(\eta_D - \eta_S)(1 - h)} \\
&= \frac{1}{\eta_D} \frac{\partial \ln(Q_e)}{\partial \ln(y_0)}
\label{eq:dLnPedLny0}
\end{split}
\end{equation}

Again, this implies that the change in equilibrium price is negative so long as inequality \ref{eq:QeIncCond} holds, which it always does on adopting farms.

The changes in equilibrium quantity and price are thus always positive and negative, respectively, under circumstances of voluntary adoption of basal yield enhancing technology. Under circumstances of an exogenous, involuntary increase in basal yield, on the other hand, inequality \ref{eq:QeIncCond} implies that it may be that $Q_e$ decreases while $P_e$ increases.

### Input enhancing technology and equilibrium price and quantity

The percentage change in equilibrium supply per $1$% increase in partial yield $y_v$ is defined as follows.

\begin{equation}
\begin{split}
\frac{\partial \ln(Q_e)}{\partial \ln(y_v)} &= \frac{\partial \ln(Q_e)}{\partial \alpha_v} \\
&= \ln(\theta_S) \frac{\partial}{\partial \alpha_v} \left( \frac{\eta_D}{\eta_D - \eta_S} \right) + \frac{\eta_D}{\eta_D - \eta_S} \frac{\partial \ln(\theta_S)}{\partial \alpha_v} - \ln(\theta_D) \frac{\partial}{\partial \alpha_v} \left( \frac{\eta_S}{\eta_D - \eta_S} \right)
\end{split}
\label{eq:dLnQedai}
\end{equation}

Where

\begin{equation}
\begin{split}
\frac{\partial}{\partial \alpha_v} \left( \frac{\eta_D}{\eta_D - \eta_S} \right) &= \frac{\eta_D}{(\eta_D - \eta_S)^2} \frac{\partial \eta_S}{\partial \alpha_v} \:\:;\:\:\: \frac{\partial \eta_S}{\partial \alpha_v} = \frac{\partial}{\partial \alpha_v}\left( \frac{h}{1 - h} \right) = \frac{1}{(1 - h)^2} \\
&= \frac{\eta_D}{(\eta_D - \eta_S)^2 (1 - h)^2}
\end{split}
\end{equation}

And

\begin{equation}
\frac{\partial}{\partial \alpha_v} \left( \frac{\eta_S}{\eta_D - \eta_S} \right) = \frac{\partial}{\partial \alpha_v} \left( \frac{\eta_D}{\eta_D - \eta_S} \right)
\end{equation}

So that equation \ref{eq:dLnQedai} can be rewritten

\begin{equation}
\begin{split}
\frac{\partial \ln(Q_e)}{\partial \alpha_v} &= \frac{\eta_D}{(\eta_D - \eta_S)^2 (1 - h)^2} \ln \left(\frac{\theta_S}{\theta_D} \right) + \frac{\eta_D}{\eta_D - \eta_S} \frac{\partial \ln(\theta_S)}{\partial \alpha_v} \\
&= \frac{\eta_D}{\eta_D - \eta_S} \left( \frac{\ln(P_e)}{(1 - h)^2} + \frac{\partial \ln(\theta_S)}{\partial \alpha_v} \right)
\end{split}
\end{equation}

Where equation \ref{eq:defPe} has been invoked to substitute for $\ln(\theta_S / \theta_D)$ in the second line.

This implies that the change in aggregate equilibrium supply given release and voluntary uptake of input enhancing technology is positive so long as

\begin{equation}
P_e > e^{-(1 - h)^2 \frac{\partial \ln(\theta_S)}{\partial \alpha_v}}
\label{eq:QePoscondAi}
\end{equation}

Where the derivative $\frac{\partial \ln(\theta_S)}{\partial \alpha_v}$ works out to

\begin{equation}
\begin{split}
\frac{\partial \ln(\theta_S)}{\partial \alpha_v} &= \frac{1}{1 - h} \left( \frac{\partial \ln(\beta_x)}{ \partial \alpha_v} - \frac{\partial \ln(\beta_w)}{\partial \alpha_v} \right) + \frac{1}{(1 - h)^2} \ln \left( \frac{\beta_x}{\beta_w} \right) + \frac{\partial \ln(\mu_{k*})}{\partial \alpha_v} +\frac{\partial}{\partial \alpha_v} \ln \left( \int_h^{\infty} \lambda^{\frac{-h}{1 - h}} f_{\lambda}(\lambda) \: d \lambda \right) \\
&= \frac{1}{1 - h} \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \mathbf{w}}{\partial \alpha_v} + \ln \left( \frac{\alpha_v}{w_v} \right) \right) + \frac{1}{(1 - h)^2} \ln \left( \frac{\beta_x}{\beta_w} \right) + \frac{\partial \ln(\mu_{k*})}{\partial \alpha_v} + \frac{\partial \ln(u)}{\partial \alpha_v} 
\end{split}
\label{eq:dLnThetaSdai}
\end{equation}
<!-- &= \frac{1}{1 - h} \left[1 - \boldsymbol{\alpha} \cdot \frac{\partial \mathbf{w}}{\partial \alpha_v} + \ln \left( \frac{\alpha_v}{w_v} \right) + \ln(\theta_S) - \ln(\mu_{k*}) - \ln(F(\bar{\chi})) \right] + \frac{\partial \ln(\mu_{k*})}{\partial \alpha_v} + \frac{\ln(F(\bar{\chi}))}{\partial \alpha_v} -->

Where

\begin{equation}
u = \int_h^{\infty} \lambda^{\frac{-h}{1 - h}} f_{\lambda}(\lambda) \: d \lambda
\end{equation}

And the last two terms work out as follows.

\begin{equation}
\begin{split}
\frac{\partial \ln(\mu_{k*})}{\partial \alpha_v} &= \frac{1}{\mu_{k*}} \int_0^{\infty} \frac{\partial}{\partial \alpha_v} \beta_k^{\frac{1}{1 - h}} f_k(\beta_k) \: d \beta_k \\
&= \frac{1}{\mu_{k*} (1 - h)} \int_0^{\infty} \beta_k^{\frac{h}{1 - h}} f_k(\beta_k) \: d \beta_k \\
&= \frac{1}{\mu_{k*} (1 - h)} E(\beta_k^{\frac{h}{1 - h}}) \\
&= \frac{1}{1 - h} \frac{\mu_{\partial k}}{\mu_{k*}} \:\: ; \:\:\: \mu_{\partial k} = E(\beta_k^{\frac{h}{1 - h}})
\end{split}
\end{equation}

\begin{equation}
\begin{split}
\frac{\partial \ln(u)}{\partial \alpha_v} &= \frac{1}{u} \frac{\partial}{\partial \alpha_v} \left( \int_h^{\infty} \lambda^{\frac{-h}{1 - h}} f_{\lambda}(\lambda) \: d \lambda \right) \\
&= \frac{1}{u} \left( -h^{\frac{-h}{1 - h}} f_{\lambda}(h) - \frac{h}{1 - h} \int_h^{\infty} \lambda^{\frac{-1}{1 - h}} f_{\lambda}(\lambda) \: d \lambda \right) \\
&= -\frac{1}{u} \left( h^{\frac{-h}{1 - h}} f_{\lambda}(h) + u_{\partial} \frac{h}{1 - h} \right) \:\:; \:\:\: u_{\partial} = \int_h^{\infty} \lambda^{\frac{-1}{1 - h}} f_{\lambda}(\lambda) \: d \lambda
\end{split}
\end{equation}

If economic yields are lognormally distributed, then by Hull's result^[See the end of section \ref{sec:aggSupply}] this further reduces to

\begin{equation}
\frac{\partial \ln(u)}{\partial \alpha_v} = -\frac{1}{\mu_{\ell} \Phi(\bar{\gamma})} \left( h^{\frac{-h}{1 - h}} + \mu_{\partial \lambda} \Phi \left(\bar{\gamma} - \frac{1}{1 - h} s_{\lambda} \right) \frac{h}{1 - h} \right)
\end{equation}

Where

\begin{equation}
\mu_{\partial \lambda} = e^{\frac{-1}{1 - h} m_{\lambda} + \frac{1}{2} \frac{1}{(1 - h)^2} s_{\lambda}^2 }
\end{equation}
<!-- \bar{\gamma}_{\partial} &= -\frac{\ln(h) - m_{\lambda}}{s_{\lambda}} - \frac{1}{1 - h} s_{\lambda} = \bar{\gamma} - \frac{1}{1 - h} s_{\lambda}  -->

Without toiling through the considerable ambiguity of the derivative in equation \ref{eq:dLnThetaSdai}, it is already clear from the farm level analysis in section \ref{sec:techChangeAi} that, under Axioms 1-3, all adopting farms find it in their best economic interest to increase output given the new input enhancing technology. It follows, therefore, that $\frac{\partial \ln(Q_e)}{\partial \alpha_v} > 0$. Combining this knowledge with the aggregate expansion condition in inequality \ref{eq:QePoscondAi}, it follows, moreover, that

\begin{equation}
\frac{\partial \ln(\theta_S)}{\partial \alpha_v} > -\frac{\ln(P_e)}{(1 - h)^2}
\end{equation}

The percentage change in equilibrium price given a $1$% increase in the partial yield $y_v$, meanwhile, works out to

\begin{equation}
\begin{split}
\frac{\partial \ln(P_e)}{\partial \ln(y_v)} &= \frac{\partial \ln(P_e)}{\partial \alpha_v} \\
&= \frac{1}{\eta_D - \eta_S} \left( \frac{\ln(P_e)}{(1 - h)^2} + \frac{\partial \ln(\theta_S)}{\partial \alpha_v} \right) \\
&= \frac{1}{\eta_D} \frac{\partial \ln(Q_e)}{\partial \alpha_v}
\label{eq:dLnPedav}
\end{split}
\end{equation}

By which it follows that the change in equilibrium price under release and voluntary uptake of the input enhancing technology is negative so long as inequality \ref{eq:QePoscondAi} is true.

Under circumstances of an involuntary increase in the input elasticity, on the other hand, inequality \ref{eq:QePoscondAi} implies that equilibrium supply may decrease while the equilibrium price rises.

## Estimation of the technology adoption rate

Estimation of the technology adoption rate hinges upon whether the technology is basal yield or input enhancing, and upon the corresponding assumed density function.

In the case of basal yield enhancing technology, the adoption condition derived in inequality \ref{eq:ydAdoptCondy0} (the technology adjusted price/productivity tightrope) implies the following adoption rate.

\begin{equation}
a = \int_0^{\partial \ln(y_0)} \omega(\boldsymbol{\alpha} \cdot \partial \ln(\mathbf{w}) - \partial \ln(P) ) \: d(\boldsymbol{\alpha} \cdot \partial \ln(\mathbf{w}) - \partial \ln(P))
\end{equation}

Where a new Axiom has been introduced.

\begin{framed}
   \textbf{Axiom 9} \\ The technology adjusted price/productivity tightrope density function, $\omega(\boldsymbol{\alpha} \cdot \partial \ln(\mathbf{w}) - \partial \ln(P) )$.
\end{framed}

For practical purposes, $\partial \ln(y_0)$, $\partial \ln(\mathbf{w})$, and $\partial \ln(P)$ may be interpreted as the percentage change in the basal yield $y_0$, the percentage change in input prices $\mathbf{w}$ dotted by their input elasticities $\boldsymbol{\alpha}$, and the percentage change in the farm output price $P$, respectively, under release of the new technology.

This provides a way to estimate the adoption rate at different farm output prices leading up to the new equilibrium price $P_e$. The adoption rate at the new equilibrium can be found by using equation \ref{eq:dLnPedLny0} to evaluate inequality \ref{eq:ydAdoptCondy0} at $P_e$, resulting in the following condition.

\begin{equation}
\begin{split}
\frac{\partial \ln(P_e)}{\partial \ln(y_0)} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} + 1 &> 0 \\
\frac{1}{(\eta_D - \eta_S)(1 - h)} &> -1 \\
\frac{1}{1 - h} &< -(\eta_D - \eta_S) \\
\frac{-1 + h}{1 - h} &> \eta_D \\
-1 &> \eta_D
\end{split}
\label{eq:adoptCondy0atPe}
\end{equation}

The domain of $\eta_D$ derived in equation \ref{eq:domainEtaD} then implies the following adoption rate at the new equilibrium.

\begin{equation}
a = \int_{-\infty}^{-1} \: f_{\eta}^D(\eta_D) \: d \eta_D
\end{equation}

Where a new Axiom has been introduced.

\begin{framed}
   \textbf{Axiom 10} \\ The density of the farm price elasticity of demand, $f_{\eta}^D(\eta_D)$.
\end{framed}

Note that conditions \ref{eq:adoptCondy0atPe} and \ref{eq:domainEtaD} imply an adoption rate of zero if all consumers have $\varepsilon > \alpha_D$.

In the case of input enhancing technology, inequality \ref{eq:adoptCondai} implies the following adoption rate.

\begin{equation}
a = \frac{\int_{\underline{y}^*}^{\bar{y}^*} f(y^*) dy^*}{\int_{0}^{\bar{y}^*} f(y^*) dy^*}
\end{equation}

Where $f(y^*)$ is the assumed density of $y^*$ (Axiom 7). More compactly,

\begin{equation}
a = \frac{F(\bar{y}^*) - F(\underline{y^*}_{\mathcal{L}})}{F(\bar{y}^*)}
\end{equation}

Where $F(\tau)$ is the cumulative distribution function corresponding to $f(y^*)$.

\begin{equation}
F(\tau) = \int_{0}^{\tau} f(y^*) dy^*
\end{equation}
<!-- Moreover, it is first necessary to convert the technology adjusted price/productivity tightrope into a form that can be evaluated as a bound of integration. This is done by integrating and rearranging inequality \ref{eq:ydAdoptCondy0}. -->
<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- \int \partial \ln(y_0) &> \int \boldsymbol{\alpha} \cdot \partial \ln(\mathbf{w}) - h \int \partial \ln(P) \\ -->
<!-- \ln(y_0) &> \boldsymbol{\alpha} \cdot \ln(\mathbf{w}) - h \ln(P) + K -->
<!-- \end{split} -->
<!-- \end{equation} -->
<!-- Assuming the constant of integration $K$ is zero, -->
<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- -\ln(y_0) &< \ln(r) \\ -->
<!-- 1 / y_0 &< r -->
<!-- \end{split} -->
<!-- \end{equation} -->
<!-- _Adoption rate is endogenous to the model._ -->

# Measuring the welfare impact of new technology
<!-- The aggregate change in net benefit resulting from new technology -->

The aggregate change in net benefit, or welfare impact, resulting from new technology uptake is comprised of two components: 1) the aggregate change in producer net benefit, and 2) the aggregate change in demand side net benefit.

Again, impacts vary considerably depending upon whether the technology change is basal yield enhancing or input enhancing.

## Aggregate change in producer net benefit, basal yield enhancing technology

For a given basal yield enhancing technology, the aggregate change in producer net benefit $\psi^S$ is, by definition, the change in farm level net benefit integrated over its density.

The change in farm level net benefit due to basal yield enhancing technology is just the percentage increase in the basal yield times the percentage change in net benefit per $1$% change in the basal yield, times the baseline net benefit. Mathematically, this may be expressed as follows.

\begin{equation}
\begin{split}
\text{Change in Net Benefit} &= \rho_0 \frac{\partial \ln(\mathcal{L}^*)}{\partial \ln(y_0)} \mathcal{L}^* \\
&= \rho_0 \frac{\partial \mathcal{L}^*}{\partial \ln(y_0)}
\end{split}
\end{equation}

Where $\rho_0$ is the percentage change in basal yield. The aggregate change is thus

\begin{equation}
\psi^S = \rho_0 \int \frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} \nu \left(\frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} \right) d \left( \frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} \right)
\end{equation}

Recalling the expression for $\frac{\partial \ln(\mathcal{L}^*)}{\partial \ln(y_0)}$ derived in equation \ref{eq:prodNBy0}, this can be rewritten

\begin{equation}
\begin{split}
\psi^S &= \rho_0 \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} + \frac{\partial \ln(P)}{\partial \ln(y_0)} \right) P N_S \int y^* f(y^*) d y^* \\
&= \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} + \frac{\partial \ln(P)}{\partial \ln(y_0)} \right) P Q_S
\end{split}
\end{equation}

Where the law of the unconscious statistician has been invoked to replace $\nu \left( \frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} \right) d \left( \frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} \right)$ with $N_S f(y^*) d y^*$.

At equlibrium, this becomes

\begin{equation}
\psi_e^S = \rho_0 \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} + \frac{\partial \ln(P_e)}{\partial \ln(y_0)} \right) P_e Q_e
\end{equation}

Using equation \ref{eq:dLnPedLny0} to substitute for $\frac{\partial \ln(P_e)}{\partial \ln(y_0)}$, this can be rewritten as follows.

\begin{equation}
\begin{split}
\psi_e^S &= \rho_0 \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} + \frac{1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)}}{(\eta_D - \eta_S) (1 - h)} \right) P_e Q_e \\
&= \rho_0 \left(1 + \frac{1}{(\eta_D - \eta_S) (1 - h)} \right) \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right) P_e Q_e \\
&= \frac{\varepsilon -\alpha_D}{(\eta_D - \eta_S) (1 - h_D)} \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right) P_e Q_e
\end{split}
\end{equation}

## Aggregate change in demand side net benefit, basal yield enhancing technology

The aggregate change in demand side net benefit due to basal yield enhancing technology $\psi^D$ is derived through an analogous set of steps. By definition, the aggregate change in demand side net benefit is the change in consumer level net benefit integrated over its density.

\begin{equation}
\psi^D = \rho_0 \int \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_0)} \mathcal{L}_D^* \nu_D \left( \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_0)} \mathcal{L}_D^* \right) d \left( \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_0)} \mathcal{L}_D^* \right)
\end{equation}

But $\frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_0)} \mathcal{L}_D^* = \frac{\partial \mathcal{L}_D^*}{\partial \ln(y_0)}$, and so, recalling the expression for $\frac{\partial \mathcal{L}_D^*}{\partial \ln(y_0)}$ derived in equation \ref{eq:consNBy0}, the integral can be rewritten

\begin{equation}
\begin{split}
\psi^D &= \rho_0 (\varepsilon - \alpha_D) P_D \frac{\partial \ln(P)}{\partial \ln(y_0)} N_D \int y_D^* f_D(y_D^*) d y_D^* \\
&= (\varepsilon - \alpha_D) P_D Q^D \frac{\partial \ln(P)}{\partial \ln(y_0)}
\end{split}
\end{equation}

Where the law of the unconscious statistician has been invoked to replace $\nu_D \left( \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_0)} \mathcal{L}_D^* \right) d \left( \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_0)} \mathcal{L}_D^* \right)$ with $N_D f(y_D^*) d y_D^*$.

Here it is important to distinguish $Q^D$, the demand side output, from $Q_D$, the demand curve. When the consumers are mills or factories, $Q^D$ has an interpretation in concrete terms of aggregate output of flour, starch, bioethanol, etc., as the case may be. When the consumers are people, $Q^D$ must be interpreted in terms of aggregate labor, or still more abstract terms of aggregate utility.

At equilibrium,

\begin{equation}
\begin{split}
\psi_e^D &= \rho_0 (\varepsilon -\alpha_D) P_D Q^D \frac{\partial \ln(P_e)}{\partial \ln(y_0)} \\
&= \rho_0 \frac{\varepsilon - \alpha_D}{(\eta_D - \eta_S) (1 - h)} P_D Q^D \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right) P_D Q^D
\end{split}
\end{equation}

## Total change in welfare, basal yield enhancing technology

Adding $\psi_e^S$ and $\psi_e^D$ together gives the equilibrium total aggregate change in net benefit due to release and voluntary uptake of the new basal yield enhancing technology.

\begin{equation}
\begin{split}
\psi_e &= \psi_e^S + \psi_e^D \\
&= \frac{\varepsilon -\alpha_D }{\eta_D - \eta_S} \rho_0 \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right) \left( \frac{P_e Q_e}{1 - h_D} + \frac{P_D Q^D}{1 - h} \right)
\end{split}
\end{equation}

Dividing $\psi_e^S$ and $\psi_e^D$ by $\psi_e$ gives the respective shares of net benefit.

\begin{equation}
\frac{\psi_e^S}{\psi_e^D} = \frac{(1 - h) P_e Q_e}{(1 - h) P_e Q_e + (1 - h_D) P_D Q^D}
\end{equation}

\begin{equation}
\frac{\psi_e^D}{\psi_e^D} = \frac{(1 - h_D) \rho_0 P_D Q^D}{(1 - h) \rho_0 P_e Q_e + (1 - h_D) \rho_0 P_D Q^D}
\end{equation}

## Aggregate change in producer net benefit, input enhancing technology

For a given input enhancing technology, the aggregate change in producer net benefit $\psi^S$ is, by definition, the change in farm level net benefit integrated over its density.

The change in farm level net benefit due to input enhancing technology is just the percentage increase in the partial yield times the percentage change in net benefit per $1$% change in the partial yield, times the baseline net benefit. Mathematically, this may be expressed as follows.

\begin{equation}
\begin{split}
\text{Change in Net Benefit} &= \rho_v \frac{\partial \ln(\mathcal{L}^*)}{\partial \ln(y_0)} \mathcal{L}^* \\
&= \rho_v \frac{\partial \mathcal{L}^*}{\partial \ln(y_0)}
\end{split}
\end{equation}

Where $\rho_v$ is the percentage change in partial yield. The aggregate change is thus

\begin{equation}
\psi^S = \rho_v \int \frac{\partial \mathcal{L}^*}{\partial \ln(y_v)} \nu \left(\frac{\partial \mathcal{L}^*}{\partial \ln(y_v)} \right) d \left( \frac{\partial \mathcal{L}^*}{\partial \ln(y_v)} \right)
\end{equation}

Recalling the expression for $\frac{\partial \ln(\mathcal{L}^*)}{\partial \ln(y_v)}$ derived in equation \ref{eq:dLdai}, this can be rewritten as follows.

\begin{equation}
\psi^S = \rho_v (1 - h) P \int \left[ y^* \left( \frac{\partial \ln(P)}{\partial \alpha_v} - \frac{1}{1 - h} \right) + \frac{\partial y^*}{\partial \alpha_v} \right] N_S f(y^*) dy^*
\end{equation}

Where the law of the unconscious statistician has been invoked to replace $\nu \left( \frac{\partial \mathcal{L}^*}{\partial \ln(y_v)} \right) d \left( \frac{\partial \mathcal{L}^*}{\partial \ln(y_v)} \right)$ with $N_S f(y^*) d y^*$.

This further simplifies to

\begin{equation}
\begin{split}
\psi^S &= \rho_v (1 - h) P \left[ \left( \frac{\partial \ln(P)}{\partial \alpha_v} - \frac{1}{1 - h} \right) \int y^* f(y^*) \: dy^* + \int \frac{\partial y^*}{\partial \alpha_v} f(y^*) \: dy^* \right] \\
&= \rho_v (1 - h) \left[ \left( \frac{\partial \ln(P)}{\partial \alpha_v} - \frac{1}{1 - h} \right) P Q_S + P N_S \int \frac{\partial y^*}{\partial \alpha_v} f(y^*) \: dy^* \right]
\end{split}
\label{eq:psiSyv0}
\end{equation}

The last integral in this expression works out as follows.

\begin{equation}
\begin{split}
N_S \int \frac{\partial y^*}{\partial \alpha_v} f(y^*) \: dy^* &= \frac{1}{1 - h} \left[ \frac{N_S}{h} \int y^* \ln(y^*) f(y^*) dy^* - k N_S \int y^* f(y^*) \: dy^* \right] \\
&= \frac{1}{1 - h} \left[ \frac{N_S}{h} E(y^* \ln(y^*)) - k Q_S \right]
\end{split}
\label{eq:lastInt}
\end{equation}

Where

\begin{equation}
k = \frac{1}{h} (\ln(y_0) + \ln(\beta)) - \ln \left( \frac{\alpha_v}{w_v} \right) - h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - 1
\end{equation}

Substituting equation \ref{eq:lastInt} into equation \ref{eq:psiSyv0} and simplifying, $\psi^S$ works out as follows.

\begin{equation}
\begin{split}
\psi^S &= \rho_v \left[ (1 - h) \frac{\partial \ln (P)}{\partial \alpha_v} P Q_S + P \left( \frac{N_S}{h} E(y^* \ln(y^*)) - k Q_S \right) \right] \\
&= \rho_v \left[ \left( (1 - h) \frac{\partial \ln(P)}{\partial \alpha_v} - 1 - k \right) P Q_S + \frac{N_S}{h} P E(y^* \ln(y^*)) \right] \\
&= \rho_v \left[ \left( \ln \left( \frac{\alpha_v}{w_v} \right) - \frac{1}{h} (\ln(y_0) + \ln(\beta)) + \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} \right) P Q_S + \frac{N_S}{h} P E(y^* \ln(y^*)) \right]
\end{split}
\end{equation}

At equlibrium, this becomes

\begin{equation}
\psi_e^S = \rho_v \left[ \left( \ln \left( \frac{\alpha_v}{w_v} \right) - \frac{1}{h} (\ln(y_0) + \ln(\beta)) + \frac{\partial \ln(P_e)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} \right) P_e Q_e + \frac{N_S}{h} P_e E(y^* \bigr|_{P_e} \ln(y^* \bigr|_{P_e})) \right]
\end{equation}

Using equation \ref{eq:dLnPedav} to substitute for $\frac{\partial \ln(P_e)}{\partial \alpha_v}$, this can be rewritten as follows.

\begin{equation}
\psi_e^S = \rho_v \left[ \left( \ln \left( \frac{\alpha_v}{w_v} \right) - \frac{1}{h} (\ln(y_0) + \ln(\beta)) + \frac{1}{\eta_D - \eta_S} \left( \frac{\ln(P_e)}{(1 - h)^2} +\frac{\partial \ln(\theta_S)}{\partial \alpha_v} \right) - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} \right) P_e Q_e + \frac{N_S}{h} P_e E(y^* \bigr|_{P_e} \ln(y^* \bigr|_{P_e})) \right]
\end{equation}

## Aggregate change in demand side net benefit, input enhancing technology

By definition, the aggregate change in demand side net benefit resulting from input enhancing technology is the change in consumer level net benefit integrated over its density.

\begin{equation}
\psi^D = \rho_v \int \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_v)} \mathcal{L}_D^* \nu_D \left( \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_v)} \mathcal{L}_D^* \right) d \left( \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_v)} \mathcal{L}_D^* \right)
\end{equation}

But $\frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_v)} \mathcal{L}_D^* = \frac{\partial \mathcal{L}_D^*}{\partial \ln(y_v)}$, and so, recalling the expression for $\frac{\partial \mathcal{L}_D^*}{\partial \ln(y_v)}$ derived in equation \ref{eq:consNByv}, the integral can be rewritten

\begin{equation}
\begin{split}
\psi^D &= \rho_v \int \frac{\partial \mathcal{L}_D^*}{\partial \ln(y_v)} \: d \left( \frac{\partial \mathcal{L}_D^*}{\partial \ln(y_v)} \right)\\
&= \rho_v (\varepsilon - \alpha_D) \frac{\partial \ln(P)}{\partial \alpha_v} P_D Q^D
\end{split}
\end{equation}

The demand side impact at the new equilibrium can be found by combining this equation with equation \ref{eq:dLnPedav}.

\begin{equation}
\begin{split}
\psi_e^D &= \rho_v (\varepsilon - \alpha_D) \frac{\partial \ln(P_e)}{\partial \alpha_v} P_e Q_e \\
&= \rho_v \frac{\varepsilon - \alpha_D}{\eta_D - \eta_S} \left( \frac{\ln(P_e)}{(1 - h)^2} +\frac{\partial \ln(\theta_S)}{\partial \alpha_v} \right) P_D Q^D
\end{split}
\end{equation}

## Total change in welfare, input enhancing technology

The equilibrium total aggregate change in net benefit due to release and voluntary uptake of the new input enhancing technology is found by adding $\psi_e^S$ and $\psi_e^D$, as defined in the previous two sections.

\begin{equation}
\begin{split}
\psi_e &= \psi_e^S + \psi_e^D \\
&= \rho_v \left[ \left( (\varepsilon - \alpha_D) P_D Q^D + P_e Q_e \right) \frac{\partial \ln(P_e)}{\partial \alpha_v} + t P_e Q_e + \frac{N_S}{h} P_e E(y^* \bigr|_{P_e} \ln(y^* \bigr|_{P_e})) \right]
\end{split}
\end{equation}

Where $\frac{\partial \ln(P_e)}{\partial \alpha_v}$ is defined in equation \ref{eq:dLnPedav}, and

\begin{equation}
t = \ln \left( \frac{\alpha_v}{w_v} \right) - \frac{1}{h}(\ln(y_0) + \ln(\beta)) - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v}
\end{equation}

Dividing $\psi_e^S$ and $\psi_e^D$ by $\psi_e$ gives the respective shares of net benefit.

\begin{equation}
\frac{\psi_e^S}{\psi_e} = \frac{\left( t + \frac{\partial \ln(P_e)}{\partial \alpha_v} \right) P_e Q_e + \frac{N_S}{h} P_e E(y^* \bigr|_{P_e} \ln(y^* \bigr|_{P_e}))}{\left( (\varepsilon - \alpha_D) P_D Q^D + P_e Q_e \right) \frac{\partial \ln(P_e)}{\partial \alpha_v} + t P_e Q_e + \frac{N_S}{h} P_e E(y^* \bigr|_{P_e} \ln(y^* \bigr|_{P_e}))}
\end{equation}

\begin{equation}
\frac{\psi_e^D}{\psi_e} = \frac{(\varepsilon - \alpha_v) \frac{\partial \ln(P_e)}{\partial \alpha_v} P_D Q^D}{\left( (\varepsilon - \alpha_D) P_D Q^D + P_e Q_e \right) \frac{\partial \ln(P_e)}{\partial \alpha_v} + t P_e Q_e + \frac{N_S}{h} P_e E(y^* \bigr|_{P_e} \ln(y^* \bigr|_{P_e}))}
\end{equation}

## "Economic surplus"

Many economists prefer to express benefits in terms of something called "economic surplus", which is in turn composed of "consumer surplus" and "producer surplus". Consumer surplus is defined as "the level of benefit (utility) that consumers derive by being able to purchase a product for a price that is less than the maximum they would be willing to pay" [@Mahmood2016]; and producer surplus is, by analogy, the level of benefit that producers derive from selling their product for a price that is greater than the minimum they would be willing to accept.

### A problematic welfare measure

The widespread acceptance of economic surplus as a standard welfare measure stands in stark contrast to the long history of controversy and ambiguity surrounding the method's theoretical foundations and empirical applicability.^[See, for example, [@foster1974ambiguity;@mishan1977plain;@dooley1983consumer;@currie1971concept].] The concept is, in many respects, a perfect example of the hand-wavy mathiness identified by Von Neumann et al. and Romer (see Introduction) at the root of so much frustration with economic modeling. Here, again, "one is offered not proofs but mere assertions which are really no better than the same assertions given in literary form"; and "valuable surmises and inspiring anticipations of results" are confused with genuine results [@morgenstern1953theory].

The method of calculating consumer surplus---as the area between the demand curve and the equilibrium price---is a case in point. This method was proposed by Depuit in 1844 as a surmise without any mathematical justification [@currie1971concept; @burns1973note]. Much later, Marshall offered a more verbose and belabored verbal argument, which he ammended several times over the course of twenty years, and which likewise falls far short of a theoretical justification _more mathematico_. Most economists, even today, would probably struggle to explain the connection between Depuit's calculation (more commonly known as the "Marshallian triangle") and the verbal definition of consumer surplus given above. Nonetheless, Depuit's surmise persisted through more than a century of heated debate, more or less unquestioned, while many other, less critical aspects of consumer's surplus fell under intense scrutiny. Only in the early 1970s did mathematically rigorous attempts to explain the connection between the Marshallian triangle and the verbal definition of consumer's surplus begin to appear in print [@burns1973note]. And even these theoretical derivations are seriously flawed in light of the axiomatic derivation pursued in the previous sections, as will become evident below in the course of the derivation of consumer and producer surplus from the axiomatically derived theoretical framework described in the previous sections.   [Burns' explanation flawed because lambda in the demand equation, thus integrating doesn't give the area under demand curve but rather the area under the demand curve times lambda, also an issue with linearly homogenous utility]

[Furthermore, ]The disordered, piecemeal [(or cavalier, to put it charitably)] progression in the mathematical treatment of consumer's surplus generated considerable ambiguity surrounding the concept. In his critique, Samuelson remarks that "the Marshallian concept of consumer's surplus does not refer to any one thing, but to at least half a dozen interrelated expressions" [Samuelson in @burns1973note]. And Currie et al.'s extensive review of the debate finds that "Marshall's somewhat confusing presentation of this subject is open to more than one interpretation" [-@currie1971concept]. This confusion is precisely the sort of ambiguity that Von Neumann et al. another aspect of the frustration with economic modeling says renders mathematical tools useless Von Neumann et al.  "There is no point in using exact methods where there is no clarity in the concepts and issues to which they are to be applied" [@morgenstern1953theory].
<!-- "the economic problems were not formulated clearly and are often stated in such vague terms as to make mathematical treatment _a priori_ appear hopeless because it is quite uncertain what the problems really are" [@morgenstern1953theory]. -->

The upshot: After more than century of debate, the consensus among economists seems to be that the economic surplus measure of welfare is, at best, "useful as a heuristic device---so long as its limitations are understood" [Little in @currie1971concept].^[Empirical studies have shown these limitations to be quite severe. See, for example, Johnson [-@johnson1985imprecision] and Bacon [-@bacon1995measurementstudies].] The continued popularity of the method in spite of its fundamental drawbacks is attributed to the ever growing demand for welfare impact studies to inform policy decisions, on the one hand, and to a dismal lack of "workable alternatives" to meet this demand, on the other [@currie1971concept].
<!-- The consensus seems to be that "[w]hile it is easy to raise objections to the use of the concept of economic surplus for providing answers for policy formulation, it is difficult to find any workable alternative" [@currie1971concept]. -->

The approach proposed in the sections above is intended as a workable alternative. It is a straightforward, natural [outgrowth of the PE theory] ...

Nonetheless because CS and PS is such a big things deeply entrenched, below I show how it works in the framework of the PE model derived above...

dPSdlny0 < 0 if demand inelastic (as it always is under Axiom 6)
dPSdlny0 > 0 if demand elastic (as it always is if P_D independent of P)

This agrees with early criticism of the Economic Surplus method (particularly Lindner and Jarret [-@lindner1978supply]).

"When  supply  shifts  in  parallel,  producers  always  benefit  from  research unless supply is perfectly elastic or demand is perfectly inelastic, and even in these extreme cases, producers are no worse off as a result of research. On the other hand, as noted above, with a pivotal shift, producers benefit only when demand is elastic; when demand is inelastic, producers necessarily lose from a pivotal supply shift (e.g., Lindner and Jarrett 1978)" [@alston1995science].









<!-- Many of the key points of theoretical contention are not controversial in light of the partial equilibrium model derived in the preciding sections. Many critics took issue with the method's assumption that a given consumer's budget shadow price is constant, for example.  Much of the criticism has focused on 4 key assumptions underpinning the method: 1) utility is additive, 2) budgets, like any other good, follow the law of diminishing marginal returns, and the budget shadow price^[This is referred to as the "marginal utility of money" in the literature.] is constant for a given consumer, 3) changes in the price of the good in question have no effect on the prices of other goods in the consumer's basket, and 4) interpersonal comparisons of utility are possible [@dooley1983consumer]. Others have noted that empirical imprecision... -->

<!-- Assumptions 1 and 2 are not controversial in the context of the partial equilibrium model derived in the preceding sections. As discussed in section \ref, the mathematically trivial issue of additivity vanishes with a coordinate transformation. The consumer's budget is assumed to follow the law of diminishing marginal returns like any other commodity; and this assumption was used in section \ref to derive the log-log form corresponding empirical consumer expenditure laws such as Engel's law. The budget shadow price $\lambda$ (or $\lambda_D$ on the demand side), meanwhile, is shown to be proportionate to each consumer's expected benefit-to-cost ratio (equation \ref), and thus constant for a given consumer. Assumption 3 is ...prices... Assumption 4 interpersonal comparisons possible when the good is productively consumed, which is generally the case in resource poor farming communities in the developing world. -->

<!-- However, in the context of the partial equilibrium model derived in the preceding sections, there arise three issues not yet enumerated in the literature. -->

To begin with, consider the typical method of calcuating an individual consumer's surplus as the area between the individual consumer's demand curve and the equilibrium price. For many practitioners, the connection between this calculation and the verbal definition of consumer's surplus above is less than intuitive. For Marshall [@], the connection went something like this:

+ a) Assuming consumers want to maximize net benefit, they spend such that their marginal benefit is equal to the price of the good; and so the marginal cost curve is equivalent to the consumer's marginal benefit curve. The individual's demand curve is therefore equivalent to their marginal benefit curve.

\begin{equation}
\max_{\mathbf{x}_D} \: U_D - C_D \:\: \rightarrow \:\: \frac{\partial U_D^*}{\partial x_D^*} = P
\end{equation}

+ b) The difference between a point along the demand curve and the equilibrium price is thus equivalent to the difference between the marginal benefit of the good to the consumer and the equilibrium price. This difference may be called the individual's marginal consumer surplus ($cs$) at a given point along the curve.

\begin{equation}
\frac{\partial cs}{\partial x_D^*} = \frac{\partial U_D^*}{\partial x_D^*} - P
\end{equation}

+ c) The individual's consumer surplus then follows as the integral of the marginal consumer surplus over the price domain, from zero to the equilibrium price, which is equivalent to the area between the individual's demand curve and the equilibrium price.




The definition of consumer's surplus can be derived as follows. First consider that the difference between the marginal benefit of a good and its price may be expressed as follows.

\begin{equation}
\frac{\partial \text{cs}}{}
\end{equation}


  , which in turn is equal to marginal benefit under the assumption that the consumer wishes to maximize net benefit. Integrating the demand curve up to the equilibrium price is thus equivalent to integrating the marginal consumer surplus, which gives the consumer surplus.  However, this identity between marginal cost and marginal benefit holds only when no budget constraint is included in the consumer's net benefit maximization problem. When a budget constraint is included, as in Axiom 2, the identity no longer holds. Rather,

\begin{equation}
\begin{split}
\frac{\partial R_D^*}{\partial x_D^*} &= P_D \frac{y_D^*}{x_D^*} \alpha_D \\
&= \lambda_D P
\end{split}
\end{equation}

That is to say, when a budget constraint is included, the marginal benefit is proportionate to, but not equal to, price.

Moreover, it is the net benefit ($\mathcal{L}_D^*$), not benefit, that really matters. An individual consumer's surplus can be positive even though the consumer is in fact experiencing a net benefit loss. A more informative welfare measure would thus be

\begin{equation}
\int_0^{x_D^e} \frac{\partial \mathcal{L}_D^*}{\partial x_D^*} \: d x_D^* = \int_{P_e}^{\infty} (1 - h_D) \lambda_D P \: dP
\end{equation}



Consumer surplus is typically calculated as the area between the aggregate demand curve and equilibrium price. Producer surplus is typically calculated as the area between the equilibrium price and the aggregate supply curve.
<!-- "[t]he excess of the price which he would be willing to pay rather than go without the thing, over that which he actually does pay, is the economic measure of this surplus satisfaction".[Marshall] -->

 <!-- Here, I demonstrate that the concept is mathematically ill-posed as stated, and that the calculation of consumer surplus does not match its verbal definition. I end with an emphatic reminder that consumer and producer surplus do not correspond to a real, i.e. tangible, bankable value that is ever realized in the real world. -->

The definition of consumer surplus quoted above makes no mention of the quantities of the "product" acquired at the equilibrium price and the maximum price the consumer would be willing to pay. The implication appears to be that the two quantities are the same at these two different prices. Marshall's earlier definition of consumer surplus as "[t]he excess of the price which he would be willing to pay rather than go without the thing, over that which he actually does pay" [Marshall], leaves no room for doubt: In the definition of consumer surplus, the quantities acquired at the equilibrium price and at the "maximum price the consumer is willing to pay" are the same.

The notion that consumers are willing to pay different prices for the same quantity of a product, combined with the notion that there is a maximum price $P_{max}$ they are willing to pay for this quantity, effectively implies the following piecewise functional form for individual demand.

\begin{equation}
x_D^* = 
\begin{cases}
q, & \text{if $P_e \in (0, P_{max})$} \\
0, & \text{if $P_e > P_{max}$}
\end{cases}
\label{eq:csDem}
\end{equation}

That is, the demand curves of individual consumers are perfectly elastic over the price range $(0, P_{max})$, such that consumers demand a particular quantity $q$ over this range, and demand zero quantity at prices above $P_{max}$. ($P_{max}$ and $q$ can vary from consumer to consumer.)

This is a reasonable demand model in the case of products that can only be demanded in a particular quantity. The number of heavy machines demanded by a manufacturer is often determined by the number of such machines that can fit in their factory, for example. The owner of a car requiring a new alternator usually wants to buy just one replacement alternator, and is not coaxed into buying two or three by a reduction in the price of alternators.

These are special cases, however, which are quite removed from the experience in agricultural markets.
This is a far cry from the individual demand curve derived from Axioms 1 and 2 in equation \ref. Recall, moreover, that equation \ref implies that and individual's demand can approach, but never reach, perfect elasticity. This means that consumers demand different quantities of the product at different prices. Prices along the demand curve above the equilibrium price therefore cannot be interpreted as representing higher prices that the consumer is willing to pay for the quantity acquired at the eqilibrium price.

Even supposing equation \ref{eq:csDem} is a reasonable demand function, the calculation of consumer's surplus as the area between the demand curve and the equilibrium price does not in fact equal the sum of all individual consumer surpluses. In order to achieve this result, the distance between the demand curve and the equilibrium price must be integrated over the density of consumers at each price along the curve.      method of calculating the sum of every individual's consumer surplus by  then the   Consumer surplus is typically calculated as the area between the demand curve and equilibrium price. This is based on the notion that prices on the demand curve above $P_e$ represent higher prices that consumers are willing to pay for the same quantity of the product acquired at the equilbrium price, rather than go without it. However, this notion is valid only if the demand curves of individual consumers are perfectly elastic over the price range $(0, P_{max})$, where $P_{max}$ is the maximum price the individual consumer is willing to pay  with $0$ demand      if the demand curves of individual consumers are not perfectly elastic, then prices   correspond to different quantities of the 

<!-- There are two fundamental flaws with this notion. First of all, if prices on the demand curve above $P_e$ truly represent prices that consumers are willing to pay for the quantity of product acquired at the -->

The definition of consumer surplus implies that the product in question is sold in a quantity  if it is to make any sense at all, implies a peculiar type of aggregate demand curve whereby individuals either buy or do not buy the product at the given price. The quantity purchased by each consumer is the same across all prices.  In other words, individual consumer demand curves are all perfectly elastic over a specific price domain $(0, P_{max})$. The aggregate quantity of the product sold at different prices thus changes based only on the number of consumers purchasing the product, not by the amount each consumer purchases at different prices.


The maximum price a consumer is willing to pay for a product, rather than go without the product, is, presumably, no greater than the marginal net benefit of the product. The individual consumer surplus may thus be expressed mathematically as follows.

\begin{equation}
cs = \frac{\partial \mathcal{L_D}^*}{\partial x_D^*} - P
\end{equation}

Considering the consumer's net benefit envelope derived in equation \ref, this can be rewritten as follows.

\begin{equation}
\begin{split}
cs &= (1 - h_D) P_D \frac{\partial y_D^*}{\partial x_D^*} - P \\
&= (1 - h_D) P_D \frac{y_D^*}{x_D^*} \alpha_D - P
\end{split}
\end{equation}

Using the consumer demand function derived in equation \ref to substitute for $x_D^*$, this reduces to

\begin{equation}
cs = P ((1 - h_D) P_D \lambda_D - 1 )
\end{equation}

The individual consumer's surplus is thus positive so long as their returns to scale are decreasing ($h_D \in (0, 1)$). (Recall from section \ref that demand side increasing returns to scale are possible if $\varepsilon > \alpha_D$.)

Aggregate consumer surplus is then found by integrating individual consumer surplus over the scaled density of $\lambda_D$.

\begin{equation}
\begin{split}
CS &= P \int_{h_D}^{\infty} ((1 - h_D) P_D \lambda_D - 1) N_{\lambda}^D f_{\lambda}^D (\lambda_D) \: d \lambda_D \\
&= P N_{\lambda}^D \left[ (1 - h_D) P_D \int_{h_D}^{\infty} \lambda_D f_{\lambda}^D (\lambda_D) \: d \lambda_D - \int_{h_D}^{\infty} f_{\lambda}^D (\lambda_D) \: d \lambda_D  \right]
\end{split}
\end{equation}

If demand side economic yield (or utility) is lognormally distributed, then so is $\lambda_D$; and by Hull's result^[See Appendix.] this can be rewritten as follows.

\begin{equation}
CS = P N_{\lambda}^D \left[ (1 - h_D) P_D \mu_{\lambda}^D \left(1 - \Phi \left( \frac{\ln(h_D) - m_{\lambda}^D }{s_{\lambda}^D} - s_{\lambda}^D \right) \right) -  \left(1 - \Phi \left( \frac{\ln(h_D) - m_{\lambda}^D }{s_{\lambda}^D} \right) \right) \right]
\end{equation}

Like the individual consumer's surplus, aggregate consumer surplus is positive so long as demand side returns to scale are decreasing.

On the producer sidde...

Awkward issue #2: Economists don't actually compute consumer surplus this way, but rather (almost by convention) as the area between the aggregate demand curve and the equilibrium price... If this rather arbitrary representation of consumer surplus were to be at all an accurate representation of cs, it would have to be integrated over the density of consumers at each price along the curve... This would result in substantially lower calculations of consumer surplus, as the highest prices at the top of the curve would be scaled by a very low consumer density.

The areas under the demand and supply curves in fact correspond to no tangible, fungible value ever realized in the real world. If they did, then world GDP would be several orders of magnitude greater than it is.

# Example application

Research question: How much of the non-adopting maize farm population in Kenya can be induced to adopt hybrid maize given different levels of seed and/or fertilizer subsidy? And what are the corresponding impacts on the equilibrium maize supply and price in Kenya?

## Data

## Estimation

## Results

## Conclusion

# References {-}

<div id="refs"></div>

\pagebreak

# Appendix

## Hull's result

This is a slightly modified version of the "key result" derived by Hull in the appendix to chapter 15 of his book "Options, futures, and other derivatives" (9th edition) [-@hull9thEdition].

Hull's result may be stated as follows.

If $u$ is a random variable with lognormal density function $f(u)$, then the definite integral of $u f(u)$ over a specific domain $(\underline{u}, \bar{u})$, where $\underline{u}$ is the lower and $\bar{u}$ the upper bound of the domain (and where at least one of the bounds is finite), may be expressed as follows.

\begin{equation}
\int_{\underline{u}}^{\bar{u}} u f(u) \: du = \mu_u (\Phi(\bar{z}) - \Phi(\underline{z}))
\label{eq:hullsResult}
\end{equation}

Where $\mu_u$ is the mean of $u$, defined

\begin{equation}
\mu_u = e^{m_u + s_u^2 / 2} \:\:;\:\:\: m_u = E(\ln(u)), \:\: s_u^2 = Var(\ln(u))
\end{equation}

And where $\Phi(t)$ is the standard normal cumulative distribution function, defined

\begin{equation}
\Phi(\tau) = \frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{\tau} e^{-t^2 / 2} \: dt
\end{equation}

And where $\bar{z}$ and $\underline{z}$ are defined as follows.

\begin{equation}
\begin{split}
\bar{z} &= \frac{\ln(\bar{u}) - m_u}{s_u} - s_u \\
\underline{z} &= \frac{\ln(\underline{u}) - m_u}{s_u} - s_u
\end{split}
\end{equation}

_Proof:_

Let $t$ be defined

\begin{equation}
t = \frac{\ln(u) - m_u}{s_u}
\label{eq:subThis1}
\end{equation}

Then

\begin{equation}
\frac{dt}{d \ln(u)} = \frac{1}{s_u}\: \rightarrow \: d \ln(u) = s_u dt
\label{eq:subThis2}
\end{equation}

Given the definition of the lognormal density function,

\begin{equation}
f(u) = \frac{1}{s_u \sqrt{2 \pi}} \int_{\underline{u}}^{\bar{u}} e^{-t^2 / 2} \:d \ln(u)
\end{equation}

And using equations \ref{eq:subThis1} and \ref{eq:subThis2} to substitute for $\frac{\ln(u) - m_u}{s_u}$ and $d \ln(u)$, this can be rewritten as follows.

\begin{equation}
\begin{split}
f(u) &= \frac{1}{\sqrt{2 \pi}} \int_{\underline{u}}^{\bar{u}} e^{t s_u + m_u} e^{-t^2 / 2} \: dt \\
&= \frac{1}{\sqrt{2 \pi}} \int_{\underline{u}}^{\bar{u}} e^{-1 / 2 (t^2 - 2 t s_u - 2 m_u)} \: dt
\end{split}
\end{equation}

Completing squares, this works out to

\begin{equation}
\begin{split}
\int_{\underline{u}}^{\bar{u}} u f(u) \: du &= \frac{1}{\sqrt{2 \pi}} \int_{\underline{u}}^{\bar{u}} e^{-\frac{(t^2 - s_u)^2}{2} + m_u + \frac{s_u^2}{2}} \: d \ln(u) \\
&= \frac{1}{\sqrt{2 \pi}} \int_{\underline{u}}^{\bar{u}} e^{-\frac{(t^2 - s_u)^2}{2}} e^{m_u + \frac{s_v^2}{2}} \: dt \\
&= \frac{\mu_u}{\sqrt{2 \pi}} \int_{\underline{u}}^{\bar{u}} e^{-\frac{(t^2 - s_u)^2}{2}} \: dt
\end{split}
\end{equation}

Or, more compactly written,

\begin{equation}
\int_{\underline{u}}^{\bar{u}} u f(u) \: du = \mu_u (\Phi(\bar{z}) - \Phi(\underline{z}))
\end{equation}

$\blacksquare$

<!-- ### Derivation of the baseline yield threshold for adoption of input enhancing technology \label{sec:derivYdCond1} -->

<!-- \begin{equation} -->
<!-- \mathcal{L}^* = Py^* - \lambda (C^* - B) -->
<!-- \end{equation} -->

<!-- But recall that dotting the first order conditions in equations \ref{eq:eqFOC} gives the handy expression -->

<!-- \begin{equation} -->
<!-- P y^* h - \lambda C^* = 0 -->
<!-- \end{equation} -->

<!-- Hence, using this to substitute for $\lambda C^*$ in the previous equation and simplifying, -->

<!-- \begin{equation} -->
<!-- \mathcal{L}^* = (1 - h) P y^* + \lambda B -->
<!-- \end{equation} -->

<!-- Differentiating with respect to $\alpha_i$, -->

<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- \frac{\partial \mathcal{L}^*}{\partial \alpha_i} &= P [-y^* + (1 - h) \frac{\partial y^*}{\partial \alpha_i}] \\ -->
<!-- &= (1 - h) P y^* (\frac{\partial \ln(y^*)}{\partial \alpha_i} - \frac{1}{1 - h}) -->
<!-- \end{split} -->
<!-- \end{equation} -->

<!-- The adoption condition $\frac{\partial \mathcal{L}^*}{\partial \alpha_i} > 0$ thus implies -->

<!-- \begin{equation} -->
<!-- \frac{\partial \ln(y^*)}{\partial \alpha_i} > \frac{1}{1 - h} -->
<!-- \label{eq:adoptCondInpElasAPP} -->
<!-- \end{equation} -->

<!-- The derivative on the lefthand side of this inequality works out as follows. -->

<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- \frac{\partial \ln(y^*)}{\partial \alpha_i} &= \frac{\partial}{\partial \alpha_i} \left[\frac{1}{1 - h} (\ln(y_0) - h \ln(P / \lambda) - \ln(\beta_w) + \ln(\beta_x) + \ln(\beta_k)) \right] \\ -->
<!-- &= \frac{1}{1 - h} \left(\ln(y^*) + \ln(P / \lambda) + h \frac{\partial \ln(P)}{\partial \alpha_i} - \boldsymbol{\alpha} \cdot \frac{\partial \mathbf{w}}{\partial \alpha_i} + \ln(\alpha_i / w_i) + 1 \right) -->
<!-- \end{split} -->
<!-- \label{eq:dLnYstardaiAPP} -->
<!-- \end{equation} -->

<!-- Substituting this into the adoption condition (equation \ref{eq:adoptCondInpElasAPP}) and simplifying, -->

<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- \frac{1}{1 - h} \left(\ln(y^*) + \ln(P / \lambda) + h \frac{\partial \ln(P)}{\partial \alpha_i} - \boldsymbol{\alpha} \cdot \frac{\partial \mathbf{w}}{\partial \alpha_i} + \ln(\alpha_i / w_i) + 1 \right) &= \frac{1}{1 - h} \\ -->
<!-- \ln(y^*) + \ln(P / \lambda) + h \frac{\partial \ln(P)}{\partial \alpha_i} - \boldsymbol{\alpha} \cdot \frac{\partial \mathbf{w}}{\partial \alpha_i} + \ln(\alpha_i / w_i) > 0 -->
<!-- \end{split} -->
<!-- \end{equation} -->

<!-- But note that the yield envelope can be solved to give an expression for the term $\ln(P / \lambda)$ as follows. -->

<!-- \begin{equation} -->
<!-- \ln \left(\frac{P}{\lambda} \right) = 1 / h [(1 - h) \ln(y^*) - \ln(y_0) + \ln(\beta_w) - \ln(\beta_x) - \ln(\beta_k)] -->
<!-- \label{eq:LnPoLambda} -->
<!-- \end{equation} -->

<!-- Substituting this into the previous equation and solving for $\ln(y^*)$, -->

<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- \ln(y^*) &> \ln(w_i / \alpha_i) + \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_i} - h \frac{\partial \ln(P)}{\partial \alpha_i} - 1 / h ((1 - h) \ln(y^*) - \ln(y_0 \beta_w^{-1} \beta_x \beta_k)) \\ -->
<!-- \ln(y^*) &> (1 - h) \left(\ln(w_i / \alpha_i) + 1 / h \ln(y_0 \beta_w^{-1} \beta_x \beta_k) + \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_i} - h \frac{\partial \ln(P)}{\partial \alpha_i} -->
<!-- \end{split} -->
<!-- \end{equation} -->

<!-- Taking the exponential function then gives the baseline yield threshold for adoption of the input enhancing technology. -->

<!-- \begin{equation} -->
<!-- y^* > \left[w_i / \alpha_i (y_0 \beta_w^{-1} \beta_x \beta_k)^{1 / h} e^{\boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_i} - h \frac{\partial \ln(P)}{\partial \alpha_i}} \right] -->
<!-- \label{eq:ydCond1APP} -->
<!-- \end{equation} -->

<!-- This condition says that adoption will result in higher net benefit on farms with yields above the righthand side of the condition, but lower net benefit on farms with baseline yields below the righthand side of the condition. Assuming technology adoption is voluntary and that farms want to maximize their net benefit, the theory derived above says that those farms with baseline yields below the righthand side of the condition will not adopt. -->

<!-- Given an exogenously imposed, involuntary change in input elasticity of yield, condition \ref{eq:ydCond1APP} implies that the lower centiles of the yield distribution would suffer a decrease in their net benefit. -->

<!-- ### Derivation of the baseline yield threshold for increased output under input enhancing technology \label{sec:derivYdIncCond1} -->

<!-- Applying the increased output condition ($\frac{\partial y^*}{\partial \alpha_i}$) to equation \ref{eq:dLnYstardaiAPP} and simplifying gives -->

<!-- \begin{equation} -->
<!-- \ln(y^*) + \ln(P / \lambda) + h \frac{\partial \ln(P)}{\partial \alpha_i} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_i} + \ln(\alpha_i / w_i + 1) > 0 -->
<!-- \end{equation} -->

<!-- Using equation \ref{eq:LnPoLambda} to substitute for the term $\ln(P / \lambda)$ and solving for $\ln(y^*)$, -->

<!-- \begin{equation} -->
<!-- \ln(y^*) > (1 - h) \left(1 / h \ln(y_0 \beta_w^{-1} \beta_x \beta_k) - \ln(\alpha_i / w_i) + \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_i} - h \frac{\partial \ln(P)}{\partial \alpha_i} - 1 \right) -->
<!-- \end{equation} -->

<!-- Taking the exponential function then gives the baseline yield threshold for increased output under input enhancing technology. -->

<!-- \begin{equation} -->
<!-- y^* > \left[w_i / \alpha_i (y_0 \beta_w^{-1} \beta_x \beta_k)^{1 / h} e^{\boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_i} - h \frac{\partial \ln(P)}{\partial \alpha_i} - 1} \right]^{1 - h} -->
<!-- \label{eq:YdIncCond1} -->
<!-- \end{equation} -->

<!-- Farms with baseline yields greater than the righthand side of this condition find it in their best interest to increase output given new input enhancing technology. Note that the righthand side of this condition is less than the righthand side of the baseline yield adoption threshold (inequality \ref{eq:ydCond1APP}) by a factor of $e^{h - 1}$. Therfore, all adopting farms find it in their best interest to increase output. -->

<!-- Given an exogenously imposed, involuntary change in input elasticity of yield, condition \ref{eq:YdIncCond1} implies that the lower centiles of the yield distribution would choose to reduce ouput. -->











<!-- Clipboard: -->
<!-- In 1944, John Von Neumann et al. observed that "part of the feeling of dissatisfaction with the mathematical treatment of economic theory derives largely from the fact that frequently one is offered not proofs but mere assertions which are really no better than the same assertions given in literary form" and from the fact that genuine results are often confused with "very valuable surmises and inspiring anticipations of results" (2006). -->
<!-- It can be added that these "assertions", "valuable surmises", and "inspiring anticipations of results", when made by celebrated scholars, have often taken on the character of, if not proofs, then axioms that-consciously or unconsciously-prefigure all subsequent inquiry, regardless of their truth value. In a recent critique of macroeconomic models, former World Bank director Paul Romer characterized such economic assertions as "Facts With Unknown Truth Value" (2016). Here we prefer to use the term "axioms" or "celebrity axioms", in order to underscore that these assertions are not verified facts, but rather, as Von Neumann said, the opinions and surmises of celebrated scholars. -->
<!-- The infallible, axiomatic air that is retrospectively attributed to these surmises contrasts with the provisional, diffident, and sometimes mistaken terms in which they were originally uttered. Consider, for example, these early formulations of the concept of elasticity: [.]. A review of the foundational works (of Marshall, Jevons, and Pareto, in particular) turns up many such awkward moments and downright errors in mathematical reasoning. -->
<!-- But no one reads the classics anymore. [But "no one is paying attention to the math," writes Romer.] The codification of assertive statements about economic systems into formal language has too often been premature and over-confident, leading to the situation identified by Von Neumann et al., where "economic problems [are] not formulated clearly and are often stated in such vague terms as to make mathematical treatment a priori appear hopeless because it is quite uncertain what the problems really are" (2006). Moreover, much scientific inquiry has then been organized around, and mistaken for, the defense and preservation of badly incomplete, inconsistent, and/or over-simplistic formalisms, making it difficult for subsequent generations of researchers to distinguish between the genuine challenges posed by the problem to be addressed and "challenges" which are merely artifacts of the formalism. The very merit of research questions is likewise judged not from elementary theoretical premises or empirical observations, but rather on the basis of the question's compatibility with the predominant narrative that has grown out of the celebrity axioms. -->
<!-- Much economic theory is built upon  are  The theory of the firm, for example, is built upon the linear demand curve. But this implies either homothetic preferences or, worse, that all households have the same income. Either one of these assumptions is  especially inappropriate in the agricultural sector, where empirical observations (Engel's Law) rule out homothetic preferences.     that they invite confusion  has been that they are then all the more difficult to correct if they arWhile one can certainly point to instances where the mathematical codification of assertions has led to new insights, the works of . confuses theory with empirical content, adding a shield of opacity to cover academically political motives. Romer calls such indiscretions "mathiness". . elasticity diffidence. -->


<!-- Take the upward sloping supply curve as an example. Many problems in economics are considered intractable given the "difficulty" of aggregating firm supply curves into an industry wide curve. But this "difficulty" refers merely to the difficulty of adding up a large number of discrete linear equations. Why discrete linear equations? Because celebrated economists long ago decided that this was equivalent to .  -->

<!--  "There is no point in using exact methods where there is no clarity in the concepts and issues to which they are to be applied" (Neumann et al., 2006). -->
<!-- . -->
<!-- One axiom is that of the upward sloping supply curve.  -->
<!-- . -->



<!-- In economics,  -->


<!-- To precisely determine the supply curve shift "would require either (a) precise econometric evidence or (b) detailed information on the effects on individual agents, details of industry structure including details on exit and entry of firms, and a complete theory of aggregation. This information is not available; assumptions are unavoidable" (Alston, Norton, & Pardey, 1995). -->