---
title: "DEPEMap: An axiomatic, distributionally explicit partial equilibrium model with endogenous adoption rate"
subtitle: |
  | "(Working Paper)"
author: Benjamin Schiek, Senior Research Associate, Bioversity-CIAT Alliance
#  - name: Benjamin Schiek, Senior Research Associate
#     email: b.schiek@cgiar.org
#     affiliation: Alliance Bioversity-CIAT
#     corresponding: b.schiek@cgiar.org
# email: b.schiek@cgiar.org
# address:
#   - code: Alliance Bioversity-CIAT
#     address: Alliance Bioversity-CIAT, Km 17 Recta Cali-Palmira, Valle del Cauca, Colombia, CP 763537
date: "`r Sys.Date()`"
abstract: |
  This is the abstract.

  It consists of two paragraphs.
bibliography: New PE model.bib
biblio-style: apalike
header-includes:
  - \usepackage{setspace}\doublespacing
  - \usepackage{float}
  - \floatplacement{figure}{H}
  - \usepackage{amsmath}
  - \numberwithin{equation}{section}
output: 
  pdf_document:
    fig_caption: true
    number_sections: true
    latex_engine: xelatex
mainfont: Garamond
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE,
                      dev = c("png", "tiff"),
                      dpi = 300)

```

# Introduction

-Incredulous results - donors now weary of the cavalier approach

there is evidence that donor patience with the cavalier approach has worn thin. Hurley et al. [-@hurley2014re; -@hurley2016returns] note a growing "disconnect" between donor funding levels and modeled AR4D rates of return. They concede that this is likely because donors have simply stopped believing the steady stream of ex-ante impact assessments reporting implausibly high estimates of returns---59.5% on average---to AR4D investments.

>"Agricultural R&D spending by the United States Department of Agriculture and state agricultural experiment stations was $4.1 billion in 2000. With an annual rate of return equal to the average internal rate of return of 59.5 percent, such an investment would be worth $56.3 quintillion ($56.3 x 1018) in 2050---a value that is more than 2.3 million times the projected size of the global gross domestic product in 2050" [@hurley2016returns].

Alston and Pardey made a similar observation many years earlier [-@alston2001attribution]. Hurley et al. [-@hurley2016returns] propose to correct for any methodological flaw in the modeling by replacing the internal rate of return (IRR) calculation with the more conservative "modified IRR".

-Model is a collection of surmises based on preference rather than a theory derived from axioms (Von Neumann)

In 1944, John Von Neumann et al. observed that "part of the feeling of dissatisfaction with the mathematical treatment of economic theory derives largely from the fact that frequently one is offered not proofs but mere assertions which are really no better than the same assertions given in literary form" [@morgenstern1953theory].
<!-- and from the fact that genuine results are often confused with "very valuable surmises and inspiring anticipations of results" -->

-Well known issues: homothetic pref or identical farms, pivot or shift, negative quantities,  

there was considerable debate in the 1970s over whether the research-induced supply curve shift should be modeled as a parallel shift or a pivot [@alston1995science; @norton1981evaluating; @lindner1978supply]. The debate was further complicated by differing views as to whether supply should be modeled as a linear or a curved CE function. Without a theoretical framework to link parameter values and functional forms to real world conditions, the debate was ultimately inconclusive. The answers to the questions left unresolved by the debate have come down to us today as a matter of preference. In their highly influential book, _Science Under Scarcity_, Alston et al. indicate their preference for the linear parallel shift [-@alston1995science]; and AR4D partial equilibrium impact studies generally follow suit.

-experimental yields and economic yields
-ambiguous benefits of increased efficiency --> Adoption rates less than 100%
-tech backlogs, yield gaps
-which centiles adopt (distributional question). The predominant PE model used for parsimonious ex-ante impact assessment of agricultural research offers no insight into this question. The model authors dismiss the distributional question as irrelevant to agricultural research.

"Research can have significant distributional implications, but this need not mean that research should be directed to pursue distributional objectives." [@alston1995science]

"Agricultural research is conducted in the context of other economic and agricultural policies, but research is only one instrument of social policy, and most non efficiency-related [i.e. non-distributional] objectives  are  more effectively pursued using other policy instruments." [@alston1995science]

"Many economists view agricultural research as a blunt instrument for achieving nonefficiency objectives." [@alston1995science]

Most people working in the field today disagree with this opinion. Even at the time, research stemming from the green revolution was infused with a pro-poor mandate.

Pareto efficiency counts for very little in pro-poor development (Sen, 2001).

"An economy can be optimal in this sense even when some people are rolling in luxury and others are near starvation as long as the starvers cannot be made better off without cutting into the pleasures of the rich. If preventing  the burning of Rome would have made Emperor Nero feel worse off, then letting him burn Rome would have been Pareto-optimal. In short, a society or an  economy can be Pareto-optimal and still be perfectly disgusting." [@sen2017collective]

The new agricultural paradigm...engine of pro-poor growth [@byerlee2009agriculture]. Evidence now abounds that of high inequality and growth being co-dependent rather than mutually exclusive or unrelated objectives [@berg2017inequality].

inconsistent with a long history of responding to the needs of resource-poor farmers (IR20, cassava, beans, etc., smallholder focus), and, more recently with new research perspectives that cast agriculture as a potential engine of pro-poor growth [@byerlee2009agriculture], and with studies showing that economic growth and equitability are two sides of the same coin [@berg2017inequality; @ostry2014redistribution; @berg2012makes]

In its very earliest days, in Mexico, the green revolution was unabashedly oriented towards relatively wealthy, commercial farms. This quickly changed in the 60s and 70s. Scientists developed varieties oriented towards relatively poor farms. Biofortification (vit. A defficiency, malnutrition, stunting, these are pro-poor issues)

.	Recent studies confirm that labor intensive, inclusive growth is much more sustainable than capital intensive forms of growth (based, for eg., on natural resource rents); i.e. pro-poor and pro-growth are "two sides of the same coin" (Berg & Ostry, 2011; Berg, Ostry, & Zettelmeyer, 2012; Dabla-norris & Kochhar, 2015; Ostry, Berg, & Tsangarides, 2014). Agri-food systems are naturally labor-intensive sectors with high participation from lower income centiles, and thus uniquely suited to drive such pro-poor, sustainable growth.
.	After a long period of "agricultural pessimism" and  "urban bias" which has viewed agriculture as the "handmaiden of industrialization", there is now talk of a "new agricultural paradigm" of sustainable, equitable growth (Byerlee, de Janvry, & Sadoulet, 2009; Byerlee, Diao, & Jackson, 2005; Lipton, 2006; von Braun, 2009).

An initiative of the International Food  Policy  Research  Institute  (IFPRI)  in  the  early  2000s  called  "A  2020  Vision  for  Food,  Agriculture,  and  the  Environment"  was  instrumental  in  focusing  research  and  development  policy  attention  on  a  broad  approach  to  the  three  critical  issues  of  securing  future  world  food  needs,  reducing  hunger  and  poverty,  and  protecting  the  environment. It aimed at developing a shared vision and a consensus for taking action. The summary of an international consultation process identifies five priority areas for action:  i)  focus  on  inclusive  growth;  ii)  improve  access  to  assets  and  markets;  iii)  phase  in  social  protection;  iv)  accelerate  investments  in  health  and  nutrition  pro-grammes;  and  v)  include  the  excluded  (VON BRAUN  and  PANDYA-LORCH,  2007)


Axiom 1: the law of diminishing marginal returns
Axiom 2: Farms want to maximize their net benefit subject to a budget constraint
Axiom 3: Upward sloping supply curves
Axiom 4: Downward sloping demand curves
Axiom 5: Farms will not enter the market if their expected net benefit is negative.
Axiom 6: The functional form of the relation between consumer output price and farm output price
Axiom 7: The farm yield density function
Axiom 8: The consumer demand density function
Axiom 9: The consumer percentage markup density function
, consumer yield/utility, [technology adjusted price ratio]

The meaning of consumer yield and technology adjusted price ratio become evident below.

# Derivation of the yield function from Axiom 1 (diminishing marginal returns)

Throughout much of written history, astute observers have noticed that the usefulness of increments in the quantity of an input (in the case of producer yield functions) or good or service (in the case of consumer utility functions) is inversely proportional to amount of the input or good or service already acquired [@kauder1953genesis]. In 1738, Daniel Bernoulli put it this way:

>\singlespacing "In the absence of the unusual, the utility resulting from any small increase in wealth will be inversely proportionate to the quantity of goods previously possessed" [@bernoulli1954exposition].

\doublespacing

Today, this is known as the "law of diminishing marginal returns". Formalization of Bernoulli's statement depends upon how one defines "small increase". If "small increase" means a marginal increase, then Bernoulli's statement can be written down as follows.^[Bernoulli himself could not have had "marginal increase" in mind per se, as calculus had not yet been invented.]

\begin{equation}
\frac{\partial \ln(y)}{\partial x} \sim \frac{1}{x}
\label{eq:dimUtilDefine}
\end{equation}

Where, to be clear, the term $\partial \ln(y) / \partial x$ is the percentage change in utility given a marginal increase in the quantity of good $x$, and "$\sim 1 / x$", means "inversely proportionate to the quantity of good $x$ already acquired". An expression $y(x)$ for the yield of good $x$ can then be obtained by integrating Bernoulli's statement.

\begin{equation}
\begin{split}
\int \frac{\partial \ln(y)}{\partial x} \: dx &= \int \alpha \frac{d \ln(x)}{dx} \: dx \\
\ln(y(x))  &= \alpha \ln(x) + k \\
y(x) &= e^k x^{\alpha}
\end{split}
\label{eq:integrate_lny}
\end{equation}

Where the proportionality constant $\alpha = \partial \ln(y)/ \partial \ln(x)$ is the input elasticity of yield, i.e., the percentage change in yield given a $1$ percent increase in input $x$.

In the multivariate case, an expression $y(\mathbf{x})$ for yield as a function of a vector of $n$ goods $\mathbf{x} = [x_1,x_2,...,x_n]$ can be obtained as follows.

\begin{equation}
\int \nabla_{\mathbf{x}} \ln(y) \cdot d \mathbf{x} = \int D(\boldsymbol{\alpha}) \nabla_{\mathbf{x}} \ln(\mathbf{x}) \cdot d \mathbf{x}
\end{equation}

\begin{equation}
\begin{split}
\ln(y(\mathbf{x})) &= \boldsymbol{\alpha} \cdot \ln(\mathbf{x}) + \alpha_0 \\
y &= e^{\alpha_0} \prod_i x_i^{\alpha_i}
\end{split}
\label{eq:cobbDoug}
\end{equation}

where $\boldsymbol{\alpha}$ is the vector of input elasticities corresponding to each $x_i$, the notation $D(\boldsymbol{\alpha})$ indicates a diagonal matrix with the elements of $\boldsymbol{\alpha}$ along its diagonal, and

\begin{equation}
\nabla_{\mathbf{x}} \ln(y) = \left[ \begin{matrix} \frac{\partial \ln(y)}{\partial x_1} \\
\frac{\partial \ln(y)}{\partial x_2} \\
\vdots \\
\frac{\partial \ln(y)}{\partial x_n}
\end{matrix} \right]
\end{equation}

Equation \ref{eq:cobbDoug} is well-known to economists as the Cobb-Douglas form. As mentioned above, this result depends on a definition of small increase as a marginal increase. Other forms result from other definitions of small increase. If small increase is defined as a percentage increase, for example, a functional form involving Lambert's W function results (left as an exercise for the reader). The Cobb-Douglas function is selected from among these two choices on empirical grounds. (The Cobb-Douglas function is famous for how well it fits economic data across many contexts and scales.)

In an actual analysis, exogenously given control variables ($k_i$) are usually included in the model. These typically include demographic variables such as age, education, household size, as well as agroclimatic variables such as temperature, precipitation, soil attributes, and so forth. In some cases the $k_i$ might also include cell phone coverage, distance to input and/or output markets, distance to nearest paved road, and so forth. It really just depends on what data is available. Analysis is said to be "ceteris paribus" when these variables are held constant at a particular value across the population. Equation \ref{eq:cobbDoug} is thus henceforth rewritten as follows.

\begin{equation}
y = y_0 \prod_i x_i^{\alpha_i} \prod_i k_i^{\kappa_i}
\label{eq:cobbDoug2}
\end{equation}

where the $\kappa_i$ are the control variable elasticities of yield. Note that, by Axiom 2, the input elasticities $\alpha_i$ must be positive. (Farmers will not apply an input if it reduces yield.) But the control variable elasticities $\kappa_i$ may be positive or negative.

In equation \ref{eq:cobbDoug2}, the shorthand $y_0 = e^{\alpha_0}$ has also been introduced. The scale factor $y_0$ is the yield when inputs $\mathbf{x}$ are set to 1 and the control variables $\mathbf{k}$ are also set to 1. It may thus be interpreted as the "unit input yield" or "unit input ceteris paribus yield", to be more precise. "Basal yield" is henceforth used as a shorthand.

Many economists prefer to call $y_0$ the "total factor productivity" (TFP). This is because $y_0$ equals, in some sense, the "yield per unit all inputs" when it is isolated on one side of the equation. However, the presence of control variables complicates this interpretation. Moreover, TFP implies bizarre and rather useless units of measurement. For example, if the inputs $x_i$ are labor and pesticide, while the control variables $k_i$ are rainfall, temperature, and farmer age, then the TFP $y_0$ has units of kg hectare$^{-1}$ manhour$^{-1}$ liter$^{-1}$ millimeter$^{-1}$ degree Celsius$^{-1}$ years$^{-1}$, each of which is raised to various exponents (the respective elasticities $\alpha_i$ and $\kappa_i$). Because of the exponents, a more accurate name for TFP would be the "technology adjusted total factor productivity".

Nonetheless, a very mature literature has developed around TFP, and the reader is encouraged to continue thinking of $y_0$ in terms of TFP if that is what they are most comfortable with. The "basal yield" interpretation is merely provided here as an alternative for those of us who wrestle with the idea of TFP or are not yet familiar with it.
<!-- exogenously given control variables like age, soil quality, or climate variables. -->

# Derivation of the yield envelope from Axiom 2 (net benefit maximization)

Equation \ref{eq:cobbDoug2} captures yield response to inputs and control variables in accordance with Axiom 1, the law of diminishing marginal returns.

The assumption that farmers want to maximize their net benefit subject to a budget constraint (Axiom 2) implies that farmers apply inputs such that revenue is maximized, given a budget constraint. The problem of finding the optimal input quantities that achieve this goal can be formalized as follows.

\begin{equation}
\max_{\mathbf{x}} Py \:\:\: s.t. \:\:\: C \leq B
\end{equation}

where $P$ is the output price, $B$ is the farmer's budget, $C$ is the cost function, defined

\begin{equation}
C = \mathbf{w} \cdot \mathbf{x}
\end{equation}

and $\mathbf{w}$ is the vector of input prices corresponding to each input in $\mathbf{x}$.

The Lagrangian is then

\begin{equation}
\mathcal{L} = Py - \lambda (C - B)
\end{equation}

Where $\lambda$ is the farm budget shadow price, that is, the marginal benefit to the farm of a marginal increase in budget.

\begin{equation}
\frac{\partial \mathcal{L}}{\partial B} = \lambda
\end{equation}

The first order conditions for a maximum work out to:

\begin{equation}
\nabla_{\mathbf{x}} \mathcal{L} = Py D(\mathbf{x})^{-1} \boldsymbol{\alpha} - \lambda \mathbf{x} = \mathbf{0}
\label{eq:eqFOC}
\end{equation}

Where the $\mathbf{0}$ indicates a vector of zeroes equal to the length of $\mathbf{x}$. This is then solved for the optimal input levels $\mathbf{x}^*$.

\begin{equation}
\mathbf{x}^* = P y^* / \lambda D(\mathbf{w})^{-1} \boldsymbol{\alpha}
\end{equation}

Or, alternatively,

\begin{equation}
x_v^* = \frac{P y^* \alpha_v}{\lambda w_v}
\label{eq:inputDem1}
\end{equation}

The optimal yield, or yield envelope, or economic yield, $y^*$ is then found by evaluating $y$ at $\mathbf{x}^*$.

\begin{equation}
y^* = y(\mathbf{x}^*; y_0, \boldsymbol{\alpha}, \mathbf{k}, \boldsymbol{\kappa}) = y_0 \prod_i \left(\frac{P y^* \alpha_i}{\lambda w_i} \right)^{\alpha_i} \prod_i k_i^{\kappa_i}
\end{equation}

Taking logs and factoring out $\ln (P y^*/\lambda)$,

\begin{equation}
\ln(y^*) = \alpha_0 + \ln \left(\frac{P y^*}{\lambda} \right) \sum_i \alpha_i + \sum_i \alpha_i \ln \left(\frac{\alpha_i}{w_i} \right) + \sum_i \kappa_i \ln(k_i) 
\end{equation}

But note that, by Euler's homogenous function theorem,

\begin{equation}
\sum_i \alpha_i = h
\end{equation}

where $h$ is the degree of homogeneity of $y$. Hence the previous equation can be rewritten

\begin{equation}
\ln(y^*) = \alpha_0 + h \ln \left(\frac{P y^*}{\lambda} \right) + \sum_i \alpha_i \ln \left(\frac{\alpha_i}{w_i} \right) + \sum_i \kappa_i \ln(k_i) 
\label{eq:eulerInvokd}
\end{equation}

Solving for $\ln(y^*)$,

\begin{equation}
\ln(y^*) = \frac{1}{1 - h} \left(\alpha_0 + h \ln \left(\frac{P}{\lambda} \right) + \sum_i \alpha_i \ln \left(\frac{\alpha_i}{w_i} \right) + \sum_i \kappa_i \ln(k_i) \right)
\end{equation}

And taking the exponential function of this then gives the yield envelope.

\begin{equation}
y^* =  \left(y_0 \left(\frac{P}{\lambda}\right)^h \prod_i \left(\frac{\alpha_i}{w_i}\right)^{\alpha_i} \prod_i k_i^{\kappa_i} \right)^{\frac{1}{1 - h}}
\label{eq:YdEnv1}
\end{equation}

Economic yield is thus a function of:

1) Input prices $\mathbf{w}$

2) The output price $P$

3) The input elasticities of yield $\boldsymbol{\alpha}$ (i.e. the technology)

4) The control variables $\mathbf{k}$

5) Their control variable elasticities of yield $\boldsymbol{\kappa}$

6) The farm budget shadow price $\lambda$

To reduce notational clutter, the yield envelope is henceforth rewritten as follows.

\begin{equation}
y^* = \left(y_0 \left(\frac{P}{\lambda} \right)^h \frac{\beta_x \beta_k}{\beta_w} \right)^{\frac{1}{1 - h}}
\label{eq:YdEnvCompact}
\end{equation}

Where the following shorthands have been introduced:
<!-- r &= \frac{P^h}{\beta_w} \:\:\:; \:\: \beta_w = \prod_i w_i^{\alpha_i} \\ -->

\begin{equation}
\begin{split}
\beta_w &= \prod_i {w_i}^{\alpha_i} \\
\beta_x &= \prod_i {\alpha_i}^{\alpha_i} \\
\beta_k &= \prod_i {k_i}^{\kappa_i}
\end{split}
\end{equation}

The steps followed above more or less align with the standard derivation of the Cobb-Douglas yield envelope found in textbooks, with the important exception of the invocation of Euler's homogenous function theorem in equation \ref{eq:eulerInvokd}. By invoking Euler's theorem, the yield degree of homogeneity $h$ is made explicit in the yield envelope; and this lays bare some interesting critical properties.

## The degree of homogeneity and output price elasticity of yield \label{sec:degHomog}

Note, first of all, that the yield envelope is undefined at $h = 1$. The theory constructed so far from Axioms 1 and 2 thus contradicts the deeply entrenched surmise among economists, going back to Solow [-@solow1957technical], that yield functions are homogeneous of degree 1.

The appearance of $h$ in the yield envelope also offers an instructive expression for the output price elasticity of yield,

\begin{equation}
\frac{\partial \ln(y^*)}{\partial \ln(P)} = \frac{h}{1 - h}
\label{eq:PelastYstar}
\end{equation}

Where Axiom 3 (upward sloping supply curves) requires that $\frac{\partial \ln(y^*)}{\partial \ln(P)} > 0$, thus imposing the following domain on $h$.

\begin{equation}
h \in (0, 1)
\end{equation}

Farms are thus limited to decreasing returns to scale, since increasing returns to scale ($h > 1$) imply a negatively sloped supply curve, in violation of Axiom 3, and the yield envelope is undefined at constant returns to scale ($h = 1$).

In section \ref{sec:PDfunP}, circumstances are explored under which increasing returns to scale are possible. However, these circumstances generally apply to mills and factories, and not to farms.

The domain of $h$ derived above in turn implies the following bounds on the price elasticity of yield.

\begin{equation}
\frac{\partial \ln(y^*)}{\partial \ln(P)} \in (0, \infty)
\end{equation}

Note, in passing, that the input price elasticity of yield likewise bears the expected sign only under decreasing returns to scale.

\begin{equation}
\frac{\partial \ln(y^*)}{\partial \ln(w_i)} = \frac{-\alpha_v}{1 - h}
\end{equation}

With domain

\begin{equation}
\frac{\partial \ln(y^*)}{\partial \ln(w_v)} \in (-\infty, -\alpha_v)
\end{equation}

The yield envelope derived in equation \ref{eq:YdEnvCompact} implies that the farm supply curve^["Farm supply curve" is used as a shorthand for the "yield envelope as a function of price $P$, with all other variables held constant".] is a power law---or, in economics jargon, a constant elasticity of supply curve. This becomes clearer if the yield envelope is rewritten as follows.

\begin{equation}
y^* = t P^{\eta(P, y^*)}
\end{equation}

Where

\begin{equation}
t = \left(y_0 \frac{\beta_x \beta_k}{\lambda^h \beta_w} \right)^{\frac{1}{1 - h}}
\end{equation}

And $\eta(P, y^*)$ is the price elasticity of yield defined in equation \ref{eq:PelastYstar}.

<!-- Both the scale parameter $t$ and exponent $\eta(P, y^*)$ depend critically upon the degree of homogeneity. -->
The price elasticity of yield implies that the farm supply curve is elastic for $h \in (1 / 2 , 1)$, and inelastic for $h \in (0, 1 / 2)$, and linear with slope $t$ when $h = 1 / 2$. The curve approaches, but never reaches, perfect elasticity as $h$ approaches $1$; and approaches, but never reaches, perfect inelasticity as $h$ approaches $0$.

This is important information. This means that (insofar as Axioms 1-3 are true) for a given increase in output price, the supply response in a population of farms with inefficient input elasticities (such that $h < 1 / 2$) will be less than proportionate to the increase in price. In a population of relatively input-efficient farms (such that $h > 1 / 2$), on the other hand, the supply response will be more than proportionate to the increase in price.

## Input demand \label{sec:inDem}

Using equation \ref{eq:YdEnvCompact} to substitute for $y^*$ in input demand (equation \ref{eq:inputDem1}) gives the following expression for input demand as a function of basal yield, prices, input elasticities, the budget shadow price, and control variables together with their respective elasticities.

\begin{equation}
x_v^* = \frac{\alpha_v}{w_v} \left( y_0 \frac{P \beta_x \beta_k}{\lambda \beta_w} \right)^{\frac{1}{1 - h}}
\label{eq:inputDem2}
\end{equation}

Note that input demand, like optimal yield, is undefined at $h = 1$. The own price elasticity of input demand is

\begin{equation}
\begin{split}
\frac{\partial \ln(x_v^*)}{\partial \ln(w_v)} &= - 1 - \frac{1}{1 - h} \frac{\partial \ln(\beta_w)}{\partial \ln(w_v)} \\
&= \frac{-\alpha_v}{1 - h} - 1
\end{split}
\label{eq:ownPriceElas}
\end{equation}

Where Axiom 4 (negatively sloped demand curves) requires $\frac{\partial \ln(x_v^*)}{\partial \ln(w_v)} < 0$ ($(\forall v$), thus imposing the following domain on $h$.

\begin{equation}
h \in (-\infty, 1 + \underline{\alpha}) \:\:; \:\:\: \underline{\alpha} = \min(\boldsymbol{\alpha})
\end{equation}

Considering that $\underline{\alpha} > 0$, the effective domain of $h$ satisfying both Axioms 3 and 4 (upward sloping supply curves and downward sloping demand curves) is

\begin{equation}
h \in (0, 1)
\end{equation}

The effective domain of $h$ in turn implies the following bounds on the own price elasticity of input demand.

\begin{equation}
\frac{\partial \ln(x_v^*)}{\partial \ln(w_v)} \in (\infty, -1)
\end{equation}

The input demand curve is thus always elastic, such that the increase in farm level demand resulting from a decrease in the input price is always more than proportionate to the fall in price.

Note that the cross price elasticity of input demand also bears the expected sign under the effective domain of $h$,

\begin{equation}
\frac{\partial \ln(x_v^*)}{\partial \ln(w_{j \neq v})} = \frac{-\alpha_j}{1 - h}
\label{eq:CrossPriceElas}
\end{equation}

As does the output price elasticity of input demand,

\begin{equation}
\frac{\partial \ln(x_v^*)}{\partial \ln(P)} = \frac{1}{1 - h}
\end{equation}

Equation \ref{eq:inputDem2} implies that the input demand curve^["Input demand curve" is used as a shorthand for the "optimal input level as a function of its price, with all other variables held constant".] is a power law. This is more evident when expressed in the following compact form.

\begin{equation}
x_v^* = z w_v^{\eta(w_v, x_v^*)}
\end{equation}

Where

\begin{equation}
z = \left(y_0 \frac{\beta_x \beta_k}{\lambda^h \tilde{\beta}_w} \right)^{\frac{1}{1 - h}} \:\:;\:\:\: \tilde{\beta}_w = w_v^{-\alpha_v}\beta_w
\end{equation}

And $\eta(w_v, x_v^*)$ is the own price elasticity of input demand, derived in equation \ref{eq:ownPriceElas}.

## Domains of the budget shadow price, economic yield, and input demand

Dotting the first order conditions (equations \ref{eq:eqFOC}) through by $\mathbf{x}$ and rearranging gives the following formula for the farm budget shadow price.

\begin{equation}
\lambda = \frac{P y^*}{C^*} h
\label{eq:lambdaHandy}
\end{equation}

That is, a farm's budget shadow price is equal to its revenue to cost ratio, scaled by the degree of homogeneity.

Assuming that farms only enter production if their expected revenue is greater than their cost (Axiom 5), then the following lower bound on $\lambda$ may be readily deduced.

\begin{equation}
\lambda > h
\label{eq:lamLoBound}
\end{equation}

This, in turn, implies the following upper bound on optimal yield.

\begin{equation}
y^* <  \left(y_0 \left(\frac{P}{h} \right)^h \frac{\beta_x \beta_k}{\beta_w} \right)^{\frac{1}{1 - h}}
\label{eq:ydUpBound}
\end{equation}

Note, in passing, that the notion of an upper bound on economic yields agrees with empirical observation [@herdt1988increasing; @pingali2001cereal]. In Pingali and Heisey's words:

>"The best yields obtained on experiment stations are often used as the indicator of technology potential. Experiment stations are often located on the best lands within a region and have reliable irrigation water supplies. Agronomic yield potential determined on experiment stations, with no physical, biological, or economic constraints, is the maximum achievable yield.... When the objective of the experiment is changed from maximizing yields to maximizing profits, the yields obtained by experiment station researchers drop significantly..." [@pingali2001cereal]

The lower bound on $\lambda$ likewise implies the following upper bound on input demand.

\begin{equation}
x_v^* < \frac{\alpha_v}{w_v} \left(y_0 \frac{P \beta_x \beta_k}{h \beta_w} \right)
\label{eq:inputUpBound}
\end{equation}

Recall that the upper bound on optimal expenditure is not derived but assumed as Axiom 5: $C^* < Py^*$.

## Income elasticity of demand revisited

Using equation \ref{eq:lambdaHandy} to substitute for $\lambda$ in equation \ref{eq:inputDem1} gives yet another instructive expression for input demand.

\begin{equation}
x_v^* = \frac{C^* \alpha_v}{h w_v}
\end{equation}

By which it follows that

\begin{equation}
\frac{\partial \ln(x_v^*)}{\partial \ln(C^*)} = 1
\label{eq:optExpElasInpDem}
\end{equation}

Most economists interpret this as meaning that the income elasticity of demand is $1$. If this is true, then the Cobb-Douglas model contradicts well documented empirical laws, particularly Engel's law, that clearly indicate changing demand for different items in the consumer's basket as income changes. (See Figure \ref{fig:otherLaws}.)

```{r Fig10, fig.show = "hold", fig.width = 5, fig.height=6, fig.align="center", fig.cap="\\label{fig:otherLaws}A log-log relation exists between demand and GDP per capita for all major consumer good categories. World Bank International Comparison Program 2017 data for 152 countries. GDP is at the market exchange rate, current prices.", echo = FALSE}

#===========================================================================
# Create Engel's law graphic for next chunk, also get slope and N for text.
#===========================================================================
this_file <- "Engels Law WB ICP data.csv"
df_icp <- read.csv(this_file, stringsAsFactors = F)
colnames(df_icp) <- gsub("US\\.\\.", "US$", colnames(df_icp))
colnames(df_icp) <- gsub("\\.\\.", ", ", colnames(df_icp))
colnames(df_icp) <- gsub("\\.", " ", colnames(df_icp))
colnames(df_icp) <- gsub("billions ", "billions", colnames(df_icp))
#unique(df_icp$Element)
these_elements <- c("Expenditure per capita, market exchange rate-based (US$)",
                    "Expenditure component share of GDP (GDP = 100%)")
# these_elements <- c("Expenditure per capita, PPP-based (US$)",
#                     "Expenditure, PPP-based (US$, billions)")
df_icp <- subset(df_icp, Element %in% these_elements)

df_icp$Element[grep("share", df_icp$Element)] <- "Expenditure (as % of GDP)"
# df_icp$Element[grep("per capita", df_icp$Element)] <- "expenditure/capita (USD)"
# df_icp$Element[grep("billions", df_icp$Element)] <- "expenditure (billion USD)"


all_goods <- unique(df_icp$Good)
df_icpOther <- df_icp

df_icpOther$Good[grep("1101100:FOOD", df_icpOther$Good)] <- "Food"
df_icpOther$Good[grep("RESTAURANTS", df_icpOther$Good)] <- "Restaurants and hotels"
df_icpOther$Good[grep("EDUCATION", df_icpOther$Good)] <- "Education"
df_icpOther$Good[grep("RECREATION", df_icpOther$Good)] <- "Recreation and culture"
df_icpOther$Good[grep("CLOTHING", df_icpOther$Good)] <- "Clothing and footwear"
df_icpOther$Good[grep("CONSTRUCTION", df_icpOther$Good)] <- "Construction"
df_icpOther$Good[grep("MACHINERY", df_icpOther$Good)] <- "Machinery and equipment"
df_icpOther$Good[grep("FURNISHINGS", df_icpOther$Good)] <- "Furnishings, hh equip., &\nroutine hh maintenance"
df_icpOther$Good[grep("ACTUAL HOUSING", df_icpOther$Good)] <- "Housing, electricity,\n& other utilities"
df_icpOther$Good[grep("VEHICLES", df_icpOther$Good)] <- "Purchase of vehicles"
df_icpOther$Good[grep("1107000:TRANSPORT", df_icpOther$Good)] <- "Transport" #"1107300:TRANSPORT SERVICES"
df_icpOther$Good[grep("COMMUNICATION", df_icpOther$Good)] <- "Communication"
df_icpOther$Good[grep("HEALTH", df_icpOther$Good)] <- "Health"

not_these <- all_goods[grep("[0-9]", all_goods)]
not_these <- c(not_these, "Communication", "Purchase of vehicles",
               "Furnishings, hh equip., &\nroutine hh maintenance",
               "Machinery and equipment", "Construction", "Transport")
#not_these <- c(not_these, "Food")
this_element <- "Expenditure per capita, market exchange rate-based (US$)"
# this_element <- "Expenditure (as % of GDP)"
df_plot <- subset(df_icpOther, !(Good %in% not_these) &
                    Element == this_element &
                    Region != "Aggregated")
#unique(df_icpOther$Good)
#colnames(df_icpOther)
#unique(df_icpOther$Element)

df_plot$`GDP/capita (USD), logged` <- log(df_plot$`GDP per capita, market exchange rate based, US$`)

these_goods <- unique(df_plot$Good)
facet_labels <- c()
adjR2_vec <- c()
for(i in 1:length(these_goods)){
  this_good <- these_goods[i]
  this_df_plot <- subset(df_plot, Good == this_good)
  mod <- lm(`Expenditure, logged` ~ `GDP/capita (USD), logged`, this_df_plot)
  #summary(mod)
  m <- round(mod$coefficients[2], 3)
  b <- round(mod$coefficients[1], 3)
  df_out <- as.data.frame(broom::glance(mod))
  adjR2 <- round(df_out$adj.r.squared, 2)
  N <- df.residual(mod)
  facet_labels[i] <- paste0(this_good, "\nAdj. R-squared = ", adjR2, "\nSlope = ", m, "\nY intercept = ", b)
  adjR2_vec[i] <- adjR2
  #print(N)
}

names(facet_labels) <- these_goods

library(tidyverse)
shape_vec <- c(21:24, 4)
# point_size <- 1.5
smallPoint_size <- 1
# label_size <- 2.5
# smallLabel_size <- 2
# title_size <- 8
# subtitle_size <- 7
legendText_size <- 7
axisText_size <- 6
axisTitle_size <- 7
facetTitle_size <- 7
n <- length(unique(df_plot$Good))
bag_of_colors <- randomcoloR::distinctColorPalette(k = 2 * n)
color_vec <- sample(bag_of_colors, n)

shift_legend2 <- function(p) {
  # ...
  # to grob
  gp <- ggplotGrob(p)
  facet.panels <- grep("^panel", gp[["layout"]][["name"]])
  empty.facet.panels <- sapply(facet.panels, function(i) "zeroGrob" %in% class(gp[["grobs"]][[i]]))
  empty.facet.panels <- facet.panels[empty.facet.panels]
  
  # establish name of empty panels
  empty.facet.panels <- gp[["layout"]][empty.facet.panels, ]
  names <- empty.facet.panels$name
  # example of names:
  #[1] "panel-3-2" "panel-3-3"
  
  # now we just need a simple call to reposition the legend
  #lemon::reposition_legend(p, 'center', panel=names)
  p_out <- lemon::reposition_legend(p, 'center', panel=names)
  #class(lemon::reposition_legend(p, 'center', panel=names))
  return(p_out)
}



colnames(df_plot) <- gsub("Expenditure, logged", "Expenditure/capita (USD), logged", colnames(df_plot))
gg <- ggplot(df_plot, aes(x = `GDP/capita (USD), logged`,
                          y = `Expenditure/capita (USD), logged`,
                          #label = label_these,
                          group = Region, fill = Region, shape = Region))
gg <- gg + geom_point(alpha = 0.6, size = smallPoint_size, color = "black", stroke = 0.5)
gg <- gg + scale_fill_manual(values = color_vec)
gg <- gg + scale_shape_manual(values = shape_vec)
#gg <- gg + geom_smooth(method = lm, se = F)
gg <- gg + facet_wrap(~Good, ncol = 3,
                      labeller = labeller(Good = facet_labels))
#gg <- gg + geom_text_repel(color = "black", size = smallLabel_size)
gg <- gg + theme(strip.background = element_blank(),
                 strip.text.x = element_text(hjust = -0.01, size = facetTitle_size),
                 legend.position = "bottom",
                 legend.spacing.x = unit(0.25, 'cm'),
                 legend.title = element_blank(),
                 legend.text = element_text(size = legendText_size),
                 axis.text = element_text(size = axisText_size),
                 axis.title = element_text(size = axisTitle_size))
gg <- gg + guides(fill = guide_legend(nrow = 3, byrow = T, override.aes = list(linetype = 0)),
                  color = guide_legend(override.aes = list(linetype = 0)))
gg <- shift_legend2(gg)
gg <- ggplotify::as.ggplot(gg)





# Look at food groups
#unique(df_icp$Good)
# all_goods <- unique(df_icp$Good)
# df_icpOtherFood <- df_icp
# u <- df_icpOtherFood$Good
# df_icpOtherFood$Good[which(u == "1101190:Food products n.e.c. (Class)")] <- "Other food"
# df_icpOtherFood$Good[grep("Oils and fats", u)] <- "Oils and fats"
# df_icpOtherFood$Good[grep("Sugar, jam", u)] <- "Sugary and sweet"
# df_icpOtherFood$Good[grep("Milk, cheese and eggs", u)] <- "Milk, cheese and eggs"
# df_icpOtherFood$Good[grep("Fish and seafood", u)] <- "Fish and seafood"
# df_icpOtherFood$Good[grep("Meat", u)] <- "Meat"
# df_icpOtherFood$Good[grep("Vegetable", u)] <- "Bread, cereals, and vegetables"
# df_icpOtherFood$Good[grep("Bread", u)] <- "Bread, cereals, and vegetables"
# df_icpOtherFood$Good[grep("Fruit", u)] <- "Fruit"
# df_icpOtherFood$Good[grep("1101100:FOOD", u)] <- "Food"
# 
# not_these <- all_goods[grep("[0-9]", all_goods)]
# not_these <- c(not_these, "Food")
# #unique(df_icpOtherFood$Element)
# #this_element <- "Expenditure (as % of GDP)"
# this_element <- "Expenditure per capita, market exchange rate-based (US$)"
# df_plot <- subset(df_icpOtherFood, !(Good %in% not_these) &
#                     Element == this_element &
#                     Region != "Aggregated")
# #colnames(df_plot)
# df_plot$`GDP/capita (USD), logged` <- log(df_plot$`GDP per capita, market exchange rate based, US$`)
# 
# 
# gg <- ggplot(df_plot, aes(x = `GDP/capita (USD), logged`,
#                           y = `Expenditure, logged`,
#                           #label = label_these,
#                           group = Region, fill = Region, shape = Region))
# gg <- gg + geom_point(alpha = 0.6, size = smallPoint_size, color = "black", stroke = 0.5)
# gg <- gg + scale_fill_manual(values = color_vec)
# gg <- gg + scale_shape_manual(values = shape_vec)
# #gg <- gg + geom_smooth(method = lm, se = F)
# gg <- gg + facet_wrap(~Good, ncol = 4)#,
#                       #labeller = labeller(Good = facet_labels))
# #gg <- gg + geom_text_repel(color = "black", size = smallLabel_size)
# gg <- gg + theme(strip.background = element_blank(),
#                  strip.text.x = element_text(hjust = -0.01, size = facetTitle_size),
#                  #legend.direction = "vertical",
#                  #legend.spacing.y = unit(1, 'cm'),
#                  legend.title = element_blank(),
#                  legend.text = element_text(size = legendText_size),
#                  axis.text = element_text(size = axisText_size),
#                  axis.title = element_text(size = axisTitle_size))
# gg <- gg + guides(fill = guide_legend(#nrow = 2,
#   override.aes = list(linetype = 0)),
#   color = guide_legend(override.aes = list(linetype = 0)))
# gg

```


However, no such contrdiction in fact arises since $C^*$ does not represent income or budget ($B$), but rather _optimal expenditure_. Optimal expenditure is defined as

\begin{equation}
C^* = \sum_i x_i^* w_i
\end{equation}

Or, rearranging equation \ref{eq:lambdaHandy},

\begin{equation}
C^* = Py^* h / \lambda
\label{eq:cStar}
\end{equation}

In either case, it is straightforward to see that $C^*$ is a function of basal yield, prices, the budget shadow price, input elasticities, and control variables together with their respective elasticities, in which income $B$ plays no part. $C^*$ is therefore something very different from $B$, and may be greater or less than $B$.
<!-- equations \ref{eq:inputDem2} and \ref{eq:YdEnvCompact} clearly demonstrate that -->
<!-- More generally, the forgoing sections demonstrate that, under Axioms 1 and 2, optimal yield, input demand, and expenditure are all invariant under changes in $B$. -->

To be clear, then, equation \ref{eq:optExpElasInpDem} says that the income elsticity of _optimal expenditure_, _not of income_, is equal to $1$. A relationship between demand $x_v^*$ and budget $B$ does not follow from Axioms 2 and 3. However, the empirical consumer expenditure laws observed in Figure \ref{fig:otherLaws} can be derived from Axiom 1 alone.

_Proof:_

The net change in utility given a change in expenditure on good $x_v$ is the change in utility resulting from the acquisition of the good minus the change in utility resulting from the corresponding depletion of the budget. This may be formally expressed as follows. 

\begin{equation}
\frac{\partial \ln(U)}{\partial (w_v x_v)} = \frac{\partial \ln(U)}{\partial x_v} - \frac{\partial \ln(U)}{\partial B}
\end{equation}

Applying the first order condition for a maximum ($\partial \ln(U) / \partial (w_v x_v) = 0$) and rearranging,
<!-- Assuming that a consumer will part with money ($B$) for a good $x_v$ only such that the decrease in utility resulting from the loss of money is offset by the increase in utility resulting from the acquisition of the good, then -->

\begin{equation}
\frac{\partial \ln(U)}{\partial x_v} = \frac{\partial \ln(U)}{\partial B}
\end{equation}

By Axiom 1 (equation \ref{eq:dimUtilDefine}), this can be rewritten

\begin{equation}
\alpha_B \frac{d \ln(B)}{d B} = \alpha_v \frac{d \ln(x_v)}{d x_v}
\label{eq:margUtilAssump}
\end{equation}

But note that, assuming expenditures on other goods or inputs are held constant,

\begin{equation}
\frac{d \ln(B)}{d B} = \frac{\partial \ln(B)}{\partial (w_v x_v)}
\end{equation}

And so the previous equation can again be rewritten,

\begin{equation}
\begin{split}
\alpha_B \frac{\partial \ln(B)}{\partial (w_v x_v)} &= \alpha_v \frac{d \ln(x_v)}{dx_v} \\
\frac{\alpha_B}{w_v} \frac{\partial \ln(B)}{\partial x_v} &= \alpha_v \frac{d \ln(x_v)}{dx_v}
\end{split}
\label{eq:margUtilAssump}
\end{equation}

Integrating both sides then gives

\begin{equation}
\begin{split}
\frac{\alpha_B}{w_v} \int \frac{d \ln(B)}{d x_v} \: dx_v &= \alpha_v \int \frac{d \ln(x_v)}{d x_v} \: dx_v \\
\frac{\alpha_B}{w_B} (\ln(B) + k_B)  &= \alpha_v (\ln(x_v) + k_v)
\end{split}
\end{equation}

Where $k_B$ and $k_v$ are constants of integration. This can then be rearranged into the familiar double log expression seen in Figure \ref{fig:otherLaws}.

\begin{equation}
\ln(x_v) = m_v \ln(B) + b_v
\label{eq:generalLaw}
\end{equation}

Where the income elasticity of good $x_v$ (i.e. slope) $m_v$ and y intercept $b_v$ are defined

\begin{equation}
m_v = \frac{\alpha_B}{w_v \alpha_v}, \:\:\: b_v = \frac{\alpha_B}{w_v\alpha_v} k_B - k_v
\label{eq:incomElast}
\end{equation}
<!-- The double log consumer expenditure laws thus follow from Axiom 1 and the consumer's conservation of utility condition (equation \ref{eq:condEqualU}). Bennett's law may likewise be derived if income $B$ is constrained to refer to the consumer's food budget, and goods are limited to food items. -->

## Marginal cost

From equation \ref{eq:cStar} it follows that the marginal cost of output is

\begin{equation}
\frac{\partial C^*}{\partial y^*} = \frac{P h}{\lambda} = \frac{C^*}{y^*}
\end{equation}

Under Axioms 1 and 2, then, the marginal cost of output is constant with respect to output. This agrees with empirical evidence [@lavoie2014post]. It also contradicts the theory of the firm presented in most microeconomic textbooks, which assumes (with no evidentiary basis) increasing marginal cost as output rises.

## The farm net benefit envelope

The optimized objective function or "net benefit envelope" $\mathcal{L}^*$ is just the objective function $\mathcal{L}$ evaluated at the optimal yield $y^*$.

\begin{equation}
\mathcal{L}^* = \mathcal{L} \bigr|_{y = y^*} = P y^* - \lambda (C^* - B)
\end{equation}

Note that, applying the handy relation in equation \ref{eq:lambdaHandy}, the net benefit envelope can be rewritten without the optimal expenditure term $C^*$.

\begin{equation}
\mathcal{L}^* = (1 - h) P y^* + \lambda B
\label{eq:NBenv}
\end{equation}

# Consumer utility and demand

The Axioms from which the equations of supply side behavior are derived also apply to the demand side. This means that the consumer utility, utility envelope, and demand equations take the same form as the producer yield, yield envelope, and input demand equations, respectively.^["Consumer" here can refer to individual people or to demand side firms (mills, factories, etc.). Likewise, consumer utility can refer either to the utility of individual people, or to mill or factory yield.]

Consumer utility (or yield, in the case of mills, factories, etc.) is therefore just the demand side analogue of the farm yield envelope derived in equation \ref{eq:YdEnvCompact}.

\begin{equation}
y_D^* = \left(y_0^D \left( \frac{P_D}{\lambda_D} \right)^{h_D} \frac{\beta_x^D \beta_k^D}{\beta_w^D} \right)^{\frac{1}{1 - h_D}}
\end{equation}

Where $y_D^*$, $y_0^D$, $P_D$, $\lambda_D$, $h_D$, $\beta_x^D$, $\beta_k^D$, and $\beta_w^D$, are the respective demand side analogues of $y^*$, $y_0$, $P$, $\lambda$, $h$, $\beta_x$, $\beta_k$, and $\beta_w$.

Consumer demand for the given farm output $x_v^{D*}$ is likewise just the demand side analogue of farm input demand, which was derived above in equation \ref{eq:inputDem2}.

\begin{equation}
\begin{split}
x_v^{D*} &= \frac{P_D y_D^* \alpha_v^D}{\lambda_D P} \\
&= \frac{\alpha_v^D}{P} \left (y_0^D \frac{P_D \beta_x^D \beta_k^D}{\lambda_D  \beta_w^D} \right)^{\frac{1}{1 - h_D}}
\end{split}
\end{equation}

Where $w_v^D$ and $\alpha_v^D$ are the respective demand side analogues of $w_v$ and $\alpha_v$.

But note that the consumer's input price $w_v^D$ is just the producer's output price $P$. Substituting $P$ for $w_v^D$ and factoring out $P$, then, optimal consumer yield and demand can be rewritten in a way that clarifies the role of farm output price $P$.

\begin{equation}
y_D^* = P^{\frac{-\alpha_D}{1 - h_D}} \left(y_0^D \left( \frac{P_D}{\lambda_D} \right)^h_D \frac{\beta_x^D \beta_k^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}}
\label{eq:consYdEnv0}
\end{equation}

\begin{equation}
x_D^* = \alpha_D P^{\frac{-\alpha_D}{1 - h_D} - 1} \left(y_0^D \frac{P_D}{\lambda_D} \frac{\beta_x^D \beta_k^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}}
\label{eq:inputDemDEM0}
\end{equation}

Where, to reduce notational clutter, the index $v$ has been dropped such that $x_v^{D*}$ is replaced with $x_D^*$ and $\alpha_v^D$ is replaced with $\alpha_D$; and where $\tilde{\beta}_w^D = P^{-\alpha_D}\beta_w^D$.

The consumer's price elasticity of demand then follows as

\begin{equation}
\frac{\partial \ln(x_D*)}{\partial \ln(P)} = \frac{-\alpha_D}{1 - h_D} - 1
\label{eq:PelasDem0}
\end{equation}

Which is just the demand side analogue of the own price elasticity of input demand derived in equation \ref{eq:ownPriceElas}. Note, moreover, that changes in the price of other goods in the consumer's basket also influence their demand for a given farm output of interest.

\begin{equation}
\frac{\partial \ln(x_D*)}{\partial \ln(w_{j \neq i}^D)} = \frac{-\alpha_D}{1 - h_D}
\label{eq:crossPelasDem}
\end{equation}

Where this is just the demand side analogue of the cross price elasticity of farm input demand derived in equation \ref{eq:CrossPriceElas}.

## Consumer output price as a function of the farm output price \label{sec:PDfunP}

When $x_D$ is feedstock in some consumer's production process (as in the case of mills and factories, for example), then a close relationship often exists between $P$ and $P_D$. A reasonable first attempt at formalization of this relation is $P_D = b P$, where $b > 1$ is the factory markup. However, substituting $b P$ for $P_D$ in equation \ref{eq:inputDemDEM0} results in the following price elasticity of demand,

\begin{equation}
\frac{\partial \ln(x_D*)}{\partial \ln(P)} = \frac{1 - \alpha_D}{1 - h_D} - 1
\end{equation}

Which is impossible under Axiom 4 since the assumption that $\frac{\partial \ln(x_D*)}{\partial \ln(P)} < 0$ (negatively sloped demand curves) would thereby imply that $\alpha_D > h_D$, when in fact $h_D = \sum_i \alpha_i^D$ (and $\alpha_i^D > 0$ for all $i$).

This consideration leads to a more informed second attempt at formalization of the relation between $P$ and $P_D$.

\begin{equation}
P_D = b P^{\varepsilon} \:\:;\:\:\:P_D > P
\label{eq:PDasFunOfP}
\end{equation}

Where the exponent $\varepsilon$ is the percentage change in the consumer's output price $P_D$ given a $1$% increase in the farm product price $P$.

\begin{equation}
\frac{\partial \ln(P_D)}{\partial \ln(P)} = \varepsilon
\end{equation}

Equation \ref{eq:PDasFunOfP} is an ansatz, and not a result derived from the Axioms. For this reason, it takes its place among the Axioms as Axiom 6.

Using equation \ref{eq:PDasFunOfP} to substitute for $P$ and factoring out $P_D$ gives the following modified form of consumer yield.

\begin{equation}
y_D^* = P_D^{\frac{h_D - \alpha_D / \varepsilon}{1 - h_D}} \left(y_0^D b^{\alpha_D / \varepsilon} \frac{\beta_k^D \beta_x^D}{\lambda_D^{h_D} \tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}}
\label{eq:consYdEnv}
\end{equation}

(If there is no relation between $P$ and $P_D$, then the original consumer yield and demand expressions in equations \ref{eq:consYdEnv0} and \ref{eq:inputDemDEM0} are recovered by setting $b = P_D$ and $\varepsilon = 0$.)

Using equation \ref{eq:PDasFunOfP} to substitute for $P_D$ and factoring out $P$ then gives the following modified version of consumer demand $x_D^*$.

\begin{equation}
x_D^* = \alpha_D P^{\frac{\varepsilon - \alpha_D}{1 - h_D} - 1} \left(y_0^D b \frac{\beta_x^D  \beta_k^D}{\lambda_D \tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}}
\label{eq:inputDemDEM}
\end{equation}

The consumer's output price ($P_D$) elasticity of yield then follows as

\begin{equation}
\frac{\partial \ln(y_D^*)}{\partial \ln(P_D)} = \frac{h_D - \alpha_D / \varepsilon}{1 - h_D}
\label{eq:PDelasydD}
\end{equation}

And the consumer's feedstock (farm output) price ($P$) elasticity of demand then follows as

\begin{equation}
\frac{\partial \ln(x_D*)}{\partial \ln(P)} = \frac{\varepsilon - \alpha_D}{1 - h_D} - 1
\label{eq:PelasDem}
\end{equation}

By which it can be seen that Axioms 3 and 4 impose the following domain on $\varepsilon$.

\begin{equation}
\varepsilon \in (\alpha_D / h_D, 1 + \alpha_D - h_D)
\label{eq:domEpsilon}
\end{equation}

Considering that $h_D = \sum_i \alpha_i^D$ and $\alpha_i^D > 0$ for all $i$, the lower bound $\alpha_D / h_D$ is always greater than $0$ and less than $1$. Note, moreover, that $\alpha_D - h_D < 0$, and so the upper bound is also less than $1$.

Is the upper bound always greater than the lower bound? Supposing it is, then,

\begin{equation}
\begin{split}
\alpha_D / h_D &< 1 + \alpha_D - h_D \\
\alpha_D (1 / h_D - 1) &< 1 - h_D \\
\alpha_D / h_D (1 - h_D) &< 1 - h_D \\
\alpha_D / h_D &< 1
\end{split}
\end{equation}

Which has just been shown to be true. Thus the supposition, that $\varepsilon$'s upper bound is always greater than its lower bound, is true.

Under Axiom 4, the elasticity of demand in equation \ref{eq:PelasDem} requires that

\begin{equation}
h_D \in (-\infty, \min(1 + \underline{\alpha}_D, 1 - \varepsilon + \alpha_D))
\end{equation}

Where $\underline{\alpha}_D$ is the smallest of the consumer's input elasticities of utility. The upper bound on the righthand side of this expression can be simplified considering the upper bound of $\varepsilon$ derived in expression \ref{eq:domEpsilon}, and the lower bound placed on $\underline{\alpha}_D$ by equation \ref{eq:PelasDem} and Axiom 4. That is to say, evaluating $\min(1 + \underline{\alpha}_D, 1 - \varepsilon + \alpha_D)$ at $\max(\varepsilon)$, gives

\begin{equation}
\min(1 + \underline{\alpha}_D, 1 - \varepsilon + \alpha_D) \bigr|_{\varepsilon = \max(\varepsilon)} = \min(1 + \underline{\alpha}_D, h_D)
\end{equation}

But, by equation \ref{eq:PelasDem} and Axiom 4,

\begin{equation}
\begin{split}
\frac{-\underline{\alpha}_D}{1 - h_D} -1 &< 0 \\
-\underline{\alpha}_D &< 1 - h_D \\
1 + \underline{\alpha}_D &< h_D
\end{split}
\end{equation}

Hence,

\begin{equation}
\min(1 + \underline{\alpha}_D, 1 - \varepsilon + \alpha_D) \bigr|_{\varepsilon = \max{\varepsilon}} = h_D
\end{equation}

Moreover, since $1 - \varepsilon + \alpha_D$ is decreasing in $\varepsilon$, then the following must hold true more generally, for all possible values of $\varepsilon$.

\begin{equation}
\min(1 + \underline{\alpha}_D, 1 - \varepsilon + \alpha_D)  = 1 - \varepsilon + \alpha_D
\end{equation}

The domain of $h_D$ imposed by Axiom 4 thus reduces to

\begin{equation}
h_D \in (-\infty, 1 - \varepsilon + \alpha_D)
\end{equation}

Meanwhile, Axiom 3 (positively sloped supply curves) and equation \ref{eq:PDelasydD} also constrain the domain of $h_D$ as follows.

\begin{equation}
h_D \in
\begin{cases}
(\alpha_D / \varepsilon, 1), & \text{if $\varepsilon > \alpha_D$} \\
(1, \alpha_D / \varepsilon), & \text{if $\varepsilon < \alpha_D$}
\end{cases}
\end{equation}

The effective domain of $h_D$ satisfying both Axioms 3 and 4, then, is

\begin{equation}
h_D \in
\begin{cases}
(\alpha_D / \varepsilon, 1 - \varepsilon + \alpha_D), & \text{if $\varepsilon > \alpha_D$} \\
(1, 1 - \varepsilon + \alpha_D), & \text{if $\varepsilon < \alpha_D$}
\end{cases}
\end{equation}

Under Axiom 6, then, increasing returns to scale are possible if $\varepsilon < \alpha_D$. Note that, as a general rule, Axiom 6 applies to mills and factories, but not to farms. Farms are generally not at liberty to raise their output price in response to a higher input price, especially not in the developing world. An important asymmetry is thereby introduced between the supply and demand side of the primary sector, whereby producers are limited to decreasing returns to scale while consumers may attain increasing returns to scale if the condition $\varepsilon < \alpha_D$ is met.

The effective domain of $h_D$ in turn imposes the following domains on the consumer's output price elasticity of supply and the consumer's feedstock (farm output) price elasticity of demand, respectively.

\begin{equation}
\frac{\partial \ln(y_D^*)}{\partial \ln(P_D)} \in
\begin{cases}
(0, 1 / \varepsilon - 1), & \text{if $\varepsilon > \alpha_D$} \\
(1 / \varepsilon - 1, \infty), & \text{if $\varepsilon < \alpha_D$}
\end{cases}
\end{equation}

\begin{equation}
\frac{\partial \ln(x_D^*)}{\partial \ln(P)} \in
\begin{cases}
(\varepsilon - 1, 0), & \text{if $\varepsilon > \alpha_D$} \\
(-\infty, \varepsilon - 1), & \text{if $\varepsilon < \alpha_D$}
\end{cases}
\label{eq:domainEtaD}
\end{equation}

Under Axiom 6, then, consumer supply and demand can be elastic only when $\varepsilon <\alpha_D$, and are inelastic when $\varepsilon > \alpha_D$.

## Upper bound on consumer demand

Assuming consumers enter the market only if they expect to increase their net utility (Axiom 4), then

\begin{equation}
\lambda_D > h_D
\label{eq:lamLoBoundDEM}
\end{equation}

Which in turn implies the following upper bound on any individual consumer's demand for a given product.

\begin{equation}
x_D^* < \left( \frac{\alpha_D}{P} \right)^{\frac{\alpha_D - \varepsilon}{1 - h_D} + 1} \left(\frac{y_0^D b \tilde{\beta}_x^D \beta_k^D}{h_D \tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}}
\label{eq:inputUpBoundDEM}
\end{equation}

The last two inequalities are the demand side analogues of the results derived in equations \ref{eq:lamLoBound} and \ref{eq:inputUpBound}, respectively.

<!-- ### Proportionality of changes in consumer demand to changes in price -->

<!-- The consumer demand curve derived in equation \ref{eq:inputDemDEM} is a power law. This becomes clearer if the equation is written in the following more compact form. -->

<!-- \begin{equation} -->
<!-- \x_D^* = t_D P^{\eta(P, x_D^*)} -->
<!-- \label{eq:inputDemDEMpwrLaw} -->
<!-- \end{equation} -->

<!-- Where -->

<!-- \begin{equation} -->
<!-- t_D = \alpha_D^{\frac{\alpha_D - \varepsilon}{1 - h_D} + 1} \left(y_0^D \frac{b \tilde{\beta}_x^D  \beta_k^D}{\lambda_D \tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}} -->
<!-- \end{equation} -->

<!-- And where the exponent $\eta(P, x_D^*)$ stands for the consumer's price elasticity of demand, derived in equation \ref{eq:PelasDem}. -->

<!-- By the definition of $\eta(P, x_D^*)$ it is evident that, for consumers with $\varepsilon$ such that $\alpha_D / h_D < \varepsilon < \alpha_D$, the increase in consumer demand resulting from a decrease in price is more than proportionate to the fall in price ($\frac{\partial \ln(x_D^*)}{\partial \ln(P)} < -1$); whereas, for consumers with $\varepsilon$ such that $\alpha_D < \varepsilon < 1 - h_D + \alpha_D$, the increase in consumer demand resulting from a decrease in price is less than proportionate to the fall in price ($0 > \frac{\partial \ln(x_D^*)}{\partial \ln(P)} > -1$). For consumers with $\varepsilon = \alpha_D$, the increase in demand is exactly proportionate to the fall in price. -->

## The demand side net benefit envelope

The demand side net benefit envelope is the optimized demand side objective function, that is, the consumer's objective function evaluated at $x_D^*$.

\begin{equation}
\mathcal{L}_D^* = \mathcal{L_D} \bigr|_{x_D = x_D^*} = P_D y_D^* - \lambda_D (C_D^* - B_D)
\end{equation}

As in equation \ref{eq:NBenv}, the demand side analogue of the handy relation in equation \ref{eq:lambdaHandy} can be applied to rewrite this without the optimal expenditure term $C_D^*$.

\begin{equation}
\mathcal{L}_D^* = (1 - h_D) P_D y_D^* + \lambda_D B_D
\label{eq:NBenvDem}
\end{equation}

Using equations \ref{eq:consYdEnv} and \ref{eq:PDasFunOfP} to substitute for $y_D^*$ and $P_D$, respectively, this can be rewritten as follows.

\begin{equation}
\mathcal{L}_D^* = (1 - h_D) P^{\frac{\varepsilon - \alpha_D}{1 - h_D}} \left(y_0^D b \frac{\beta_x^D \beta_k^D}{\tilde{\beta}_w^D \lambda^{h_D}} \right) + \lambda_D B_D
\label{eq:NBenvDem}
\end{equation}

# The ambiguous benefits of technological change

New technology can be modeled either as a change in the basal yield $y_0$, or as a change in one of the input elasticities $\alpha_i$. Generally speaking, a change in basal yield implies planting an improved variety, whereas a change in one of the input elasticities implies the application of a more efficient input (or a more efficient way of applying the status quo input).

Mathematically, the change in farm level net benefit resulting from introduction of the new technology is measured as the change in the farm's net benefit envelope $\mathcal{L}^*$ (derived in equation \ref{eq:NBenv}).

By Axiom 2, it is assumed that a farm adopts a given new technology only if the expected change in net benefit is positive. Formally, this condition can be expressed for basal yield and input enhancing technology, respectively,

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} &> 0 \\
\frac{\partial \mathcal{L}^*}{\partial \ln(y_i)} &> 0
\label{eq:adoptCondBasic}
\end{split}
\end{equation}

Below, these two conditions are explored in more detail.

## Technology change as a change in basal yield

In most impact assessment studies, technology change comes in the form of a new cultivar with improved germplasm, and/or a package of new management practices, which do not act upon any single input in particular, but generally raise the basal yield. Many such studies specify a Cobb-Douglas yield function and report a statistically significant dummy variable that equals 1 on adopting farms and 0 otherwise. The dummy variable coefficient may then be interpreted as the increase in yield resulting from technology adoption.

The marginal change in farm net benefit given a $1$% increase basal yield is expressed as follows.

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} &= (1 - h) \left( \frac{y^* \partial P}{\partial \ln(y_0)} + P \frac{\partial y^*}{\partial \ln(y_0)} \right) \\
&= (1 - h) P y^* \left( \frac{\partial \ln(P)}{\partial \ln(y_0)}  + \frac{\partial \ln(y^*)}{\partial \ln(y_0)} \right)
\end{split}
\end{equation}

Where

\begin{equation}
\frac{\partial \ln(y^*)}{\partial \ln(y_0)} = \frac{1}{1 - h} \left(1 + h \frac{\partial \ln(P)}{\partial \ln(y_0)} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right)
\label{eq:dLnYstardLny0}
\end{equation}

Substituting this for $\frac{\partial \ln(y^*)}{\partial \ln(y_0)}$ in the previous equation gives

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} &= (1 - h) P y^* \left( \frac{\partial \ln(P)}{\partial \ln(y_0)}  + \frac{1}{1 - h} \left(1 + h \frac{\partial \ln(P)}{\partial \ln(y_0)} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right) \right) \\
&= P y^* \left( \frac{\partial \ln(P)}{\partial \ln(y_0)} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} + 1  \right)
\label{eq:prodNBy0}
\end{split}
\end{equation}

Applying the adoption condition (inequality \ref{eq:adoptCondBasic}) and rearranging,

\begin{equation}
\begin{split}
1 &> \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} - \frac{\partial \ln(P)}{\partial \ln(y_0)} \\
\partial \ln(y_0) &> \boldsymbol{\alpha} \cdot \partial \ln(\mathbf{w}) - \partial \ln(P)
\end{split}
\label{eq:ydAdoptCondy0}
\end{equation}

This condition says that a farm stands to increase its net benefit through adoption of basal yield enhancing technology only if the percentage increase in basal yield is greater than the corresponding percentage increase in input prices (scaled by their respective input elasticities) minus the corresponding percentage change in output price.
<!-- More compactly, it says that the percentage increase in basal yield must be greater than the absolute value of the corresponding percentage decrease in the technology adjusted output-input price ratio ($r$). -->

Here it is important to keep in mind that the release and uptake of yield enhancing technology tends to boost supply, which in turn (by Axiom 3) lowers the output price $P$. At the same time, uptake of the new technology usually implies increased use of (i.e. demand for) inputs, which (by Axiom 4) drives up input prices. Also, the price of improved seeds (an input) is typically higher than the price of the status quo seed variety.

Hence, the general expectation is

\begin{equation}
\begin{split}
\frac{\partial \ln(P)}{\partial \ln(y_0)} &< 0 \\
\frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} &> 0
\end{split}
\end{equation}

Note that the adoption condition in inequality \ref{eq:ydAdoptCondy0} closely resembles the "price/productivity tightrope" formulated by Lipton:

>"New science usually raises farm supply of outputs and demand for inputs. That makes outputs cheaper and inputs more expensive; hence the ratio of farm output prices to input prices falls. Do small and poor farmers gain? If, and only if, this science-induced fall in their relative farm prices is slower than the science-induced rise in their conversion ratio of physical inputs into physical outputs (that is, TFP)." [@lipton2005family]

(Where "TFP" refers to the basal yield, $y_0$.)

The one substantive difference between Lipton's condition and the condition derived in inequality \ref{eq:ydAdoptCondy0}, is that the percentage change in input prices in the latter are scaled by the technology $\boldsymbol{\alpha}$. Inequality \ref{eq:ydAdoptCondy0} might thus be called the "technology adjusted price/productivity tightrope".
<!-- "For new science to help poor farmers and poor food consumers (a lot), it must cut staples prices (a lot) but must raise total factor productivity (TFP) on small farms (a lot) faster.19  -->
<!-- In contrast to the adoption condition derived in the previous section (inequality \ref{eq:ydAdoptCond}), the technology adjusted price/productivity tightrope implies that, for given prices and technology ($y_0$ and $\boldsymbol{\alpha}$), either all farms or no farms adopt.  -->

Since $y_0$ and $\boldsymbol{\alpha}$ are population level parameters (they do not vary from farm to farm), the technology adjusted price/productivity tightrope implies that, for a given set of prices $\{P, \mathbf{w} \}$, all farms in the given population will either adopt or not adopt. In other words, the adoption rate of basal yield enhancing technology must be either 0% or 100% if prices are the same for all farms (i.e., if Jevons' "law of indifference" holds). Conversely, it follows that adoption rates between 0% and 100% imply that prices vary within the farm population.
<!-- Impact assessment studies that assume unique prices while also reporting an adoption rate between 0% and 100% possibly stand in violation of one or more of Axioms 1-3. -->
<!-- In fact, input and output prices often vary considerably within a given farm population, especially in the developing world.  and this is reflected in adoption rates falling somewhere between 0% and 100%. -->

Do adopting farms always find it in their best economic interest to increase output? Note from equation \ref{eq:dLnYstardLny0} that the output expansion condition $\frac{\partial \ln(y^*)}{\partial \ln(y_0)} > 0$ implies

\begin{equation}
\partial \ln(y_0) > \boldsymbol{\alpha} \cdot \partial \ln(\mathbf{w}) - h \partial \ln(P)
\end{equation}

Considering the domain $h \in(0, 1)$ (derived in section \ref{sec:degHomog}, above), it follows that all adopting farms increase their output.

## Technology change as a change in input elasticity \label{sec:techChangeAi}

The change in farm net benefit resulting from input enhancing technology is considerably more complex than the change resulting from basal yield enhancing technology due to the presence of $\alpha_v$ in multiple terms ($h$, $\beta_w$, $\beta_x$) within the net benefit envelope.

The marginal change in net benefit given a $1$% increase in one of the partial yields is expressed as follows.

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}^*}{\partial \ln(y_v)} &= \frac{\partial \mathcal{L}^*}{\partial \alpha_v} \\
&= (1 - h) \left(y^* \frac{\partial P}{\partial \alpha_i} + P \frac{\partial y^*}{\partial \alpha_v} \right) + P y^* \frac{\partial}{\partial \alpha_v} (1 - h) \\
&= P y^* \left(\frac{\partial \ln(y^*)}{\partial \alpha_v} + \frac{\partial \ln(P)}{\partial \alpha_v} - 1 \right) \\
&= (1 - h) P y^* \left(\frac{\partial \ln(y^*)}{\partial \alpha_v} + \frac{\partial \ln(P)}{\partial \alpha_v} - \frac{1}{1 - h} \right)
\label{eq:dLdai}
\end{split}
\end{equation}
<!-- Note that multiplying this through by $\alpha_i$ gives an instructive alternative expression. -->

<!-- \begin{equation} -->
<!-- \frac{\partial \mathcal{L}^*}{\partial \ln(\alpha_i)} = P y^* (1 - h) (\frac{\partial \ln(y^*)}{\partial \ln(\alpha_i)} + \frac{\partial \ln(y^*)}{\partial \ln(w_i)} - 1) -->
<!-- \end{equation} -->

<!-- Where (recall from section \ref{sec:inDem}) $\frac{\partial \ln(y^*)}{\partial \ln(w_i)}$ is the own price elasicity of demand for the input in question. -->

Where

\begin{equation}
\begin{split}
\frac{\partial \ln(y^*)}{\partial \alpha_v} &= \frac{\ln(y^*)}{1 - h} + \frac{1}{1 - h} \left(\ln \left(\frac{P}{\lambda} \right) + h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \ln(w_v) + \ln(\alpha_v) + 1 \right) \\
&= \frac{1}{1 - h} \left( \ln(y^*) + \ln \left(\frac{P}{\lambda} \right) + \ln \left(\frac{\alpha_v}{w_v} \right) + h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} + 1\right)
\end{split}
\end{equation}

But note from equation \ref{eq:YdEnvCompact} that

\begin{equation}
\ln \left( \frac{P}{\lambda} \right) = \frac{1}{h} ((1 - h) \ln(y^*) - \ln(y_0) - \ln(\beta)) \:\:; \:\:\: \beta = \frac{\beta_x \beta_k}{\beta_w}
\end{equation}

Substituting for $\ln(P / \lambda)$ in the previous equation then gives an expression in prices and population level parameters only.

\begin{equation}
\begin{split}
\frac{\partial \ln(y^*)}{\partial \alpha_v} &= \frac{1}{1 - h} \left(\ln(y^*) + \frac{1}{h} ((1 - h) \ln(y^*) - \ln(y_0) - \ln(\beta)) + \ln \left(\frac{\alpha_v}{w_v} \right) + h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} + 1 \right) \\
&= \frac{1}{1 - h} \left( \frac{1}{h} (\ln(y^*) - \ln(y_0) - \ln(\beta)) + \ln \left( \frac{\alpha_i}{w_v} \right) + h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} + 1 \right)
\end{split}
\label{eq:dLnyStardav}
\end{equation}

Substituting this expression for $\frac{\partial \ln(y^*)}{\partial \alpha_v}$ in equation \ref{eq:dLdai} then gives

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}^*}{\partial \ln(y_v)} &= (1 - h) Py^* \left[ \frac{1}{1 - h} \left( \frac{1}{h} (\ln(y^*) - \ln(y_0) - \ln(\beta)) + \ln \left( \frac{\alpha_v}{w_v} \right) + h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} + 1 \right) + \frac{\partial \ln(P)}{\partial \alpha_v} - \frac{1}{1 - h} \right] \\
&= Py^* \left[ \frac{1}{h} (\ln(y^*) - \ln(y_0) - \ln(\beta)) + \ln \left( \frac{\alpha_v}{w_v} \right) + h \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} + (1 - h) \frac{\partial \ln(P)}{\partial \alpha_v} \right] \\
&= Py^* \left[ \frac{1}{h} (\ln(y^*) - \ln(y_0) - \ln(\beta)) + \ln \left(\frac{\alpha_v}{w_v} \right) + \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} \right]
\end{split}
\end{equation}

The adoption condition $\frac{\partial \mathcal{L}^*}{\partial \ln(y_v)} > 0$ then implies

\begin{equation}
\frac{1}{h} (\ln(y^*) - \ln(y_0) - \ln(\beta)) + \ln \left(\frac{\alpha_v}{w_v} \right) + \frac{\partial \ln(P)}{\partial \alpha_v} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} > 0
\end{equation}

Which can be rearranged

\begin{equation}
\begin{split}
\frac{1}{h} (\ln(y^*) - \ln(y_0) - \ln(\beta)) &> \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \frac{\partial \ln(P)}{\partial \alpha_v} - \ln \left(\frac{\alpha_v}{w_v} \right) \\
\ln(y^*) &> h \left( \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \frac{\partial \ln(P)}{\partial \alpha_v} + \ln \left(\frac{w_v}{\alpha_v} \right) \right) + \ln(y_0) + \ln(\beta) \\
y^* &> y_0 \beta \left(\frac{w_v}{\alpha_v} \right)^h e^{h \left( \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \frac{\partial \ln(P)}{\partial \alpha_v} \right)}
\label{eq:adoptCondai}
\end{split}
\end{equation}
<!-- Now, it is not immediately self-evident from either of these equations whether $\frac{\partial \mathcal{L}^*}{\partial \alpha_i}$ is positive or negative for a given farm. By Axiom 2, only farms that stand to increase their net benefit will be interested in adoption of the new technology. That is, a farm is assumed to adopt only if $\frac{\partial \mathcal{L}^*}{\partial \ln(\alpha_i)} > 0$. Below, this condition is applied to equation \ref{eq:dLdai} to derive a measurable baseline yield adoption threshold. -->

That is to say, under Axioms 1-3, only farms with baseline yields greater than the righthand side of this inequality find it in their best economic interest to adopt the input enhancing technology. Farms with a baseline yield less than this would incur a decrease in their net benefit if they were to adopt.

How do adopting farms change their output given the new technology? Equation \ref{eq:dLnyStardav} together with the output expansion condition $\frac{\partial \ln(y^*)}{\partial \alpha_v} > 0$ imply that adopting farms increase output if

\begin{equation}
\begin{split}
\frac{1}{h} (\ln(y^*)) - \ln(y_0) - \ln(\beta) &> \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \frac{\partial \ln(P)}{\partial \alpha_v} + \ln \left(\frac{w_v}{\alpha_v} \right) - 1 \\
\ln(y^*) &> h \left( \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \frac{\partial \ln(P)}{\partial \alpha_v} + \ln \left(\frac{w_v}{\alpha_v} \right) - 1 \right) + \ln(y_0) + \ln(\beta) \\
y^* &> y_0 \beta \left(\frac{w_v}{\alpha_v} \right)^h e^{h \left( \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_v} - \frac{\partial \ln(P)}{\partial \alpha_v} + \ln \left(\frac{w_v}{\alpha_v} \right) - 1 \right)}
\label{eq:ydIncCondai}
\end{split}
\end{equation}

Which differs from the righthand side of inequality \ref{eq:adoptCondai} by a factor of

\begin{equation}
e^{h \left( (1 - h)\frac{\partial \ln(P)}{\partial \alpha_v} - 1 \right)}
\end{equation}

That is, letting $y^*_y$ denote the righthand side of inequality \ref{eq:ydIncCondai} and $y^*_{\mathcal{L}}$ the righthand side of inequality \ref{eq:adoptCondai},

\begin{equation}
y^*_y = e^{h \left( (1 - h)\frac{\partial \ln(P)}{\partial \alpha_v} - 1 \right)} y^*_{\mathcal{L}}
\label{eq:compLoBounds}
\end{equation}

If $y^*_y < y^*_{\mathcal{L}}$, then all adopting farms find it in their best economic interest to increase output. From equation \ref{eq:compLoBounds} it is clear that this is true if

\begin{equation}
\frac{\partial \ln(P)}{\partial \alpha_v} < \frac{1}{1 - h}
\end{equation}

Which is generally true given the domain of $h$ derived from Axioms 1-3 in section \ref{sec:degHomog}, and since it is generally expected that $\frac{\partial \ln(P)}{\partial \alpha_v} < 0$.

Under circumstances of an exogenously imposed, involuntary increase in one of the input elasticities of yield, condition \ref{eq:ydIncCondai} implies that farms with baseline yields less than $y^*_y$ would choose to reduce ouput. Condition \ref{eq:adoptCondai} likewise implies a reduction in net benefit for farms with baseline yields less than $y^*_{\mathcal{L}}$. Farms with baseline yields between $y^*_y$ and $y^*_{\mathcal{L}}$, meanwhile, would suffer a decrease in net benefit but choose to increase output.
<!-- Note that, in some analyses, technology change may not be voluntary. A study may examine, for example, the possibility of increased fertilizer efficiency resulting from a deterioration extension services. In such cases, the net benefit of both  -->

## The demand side impact of supply side technology change 

As a general rule, demand side technology is left unaltered by a change in farm technology.^[Although there are important exceptions. Small granule cassava simluaneously reduces farm basal yield and increases bioethanol factory efficiency.] However, new farm technology does have an indirect impact on demand side net benefit $\mathcal{L}_D^*$ through its influence on the farm output price. For basal yield enhancing technology, the change in consumer net benefit works out as follows.

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}_D^*}{\partial \ln(y_0)} &= \frac{\partial \mathcal{L}_D^*}{\partial \ln(P)} \frac{\partial \ln(P)}{\partial \ln(y_0)} \\
&= \frac{\partial}{\partial \ln(P)} ((1 - h_D) P_D y_D^* + \lambda_D B_D) \frac{\partial \ln(P)}{\partial \ln(y_0)} \\
&= (1 - h_D) P_D \frac{\partial y_D^*}{\partial \ln(P)} \frac{\partial \ln(P)}{\partial \ln(y_0)} \\
&= -\alpha_D P_D y_D^* \frac{\partial \ln(P)}{\partial \ln(y_0)}
\end{split}
\label{eq:consNBy0}
\end{equation}

For input enhancing technology, the change in consumer net benefit works out as follows.

\begin{equation}
\begin{split}
\frac{\partial \mathcal{L}_D^*}{\partial \alpha_i} &= \frac{\partial \mathcal{L}_D^*}{\partial \ln(P)} \frac{\partial \ln(P)}{\partial \alpha_i} \\
&=
\end{split}
\label{eq:consNBai}
\end{equation}

# Aggregate supply and demand

## Aggregate supply

By definition, aggregate supply is the integral of the yield envelope over its density.

\begin{equation}
Q_S = \int_{0}^{\bar{y}^*} y* N_S f(y^*) dy^*
\end{equation}

Where the density function is scaled by $N_S$, the number of hectares in the population, and $\bar{y}^*$ is the upper bound on economic yield assuming farms only enter production if their expected revenue is greater than their cost (derived in equation \ref{eq:ydUpBound}).

Using equation \ref{eq:YdEnvCompact} to substitute for $y^*$ and factoring out constants, aggregate supply can be rewritten as follows.

\begin{equation}
Q_S = N_S (y_0 r \beta_x)^{\frac{1}{1 - h}} \mu_k \int_{0}^{\bar{\chi}} \chi f(\chi) d\chi
\label{eq:QSeqP}
\end{equation}

Where

\begin{equation}
\begin{split}
\chi &= \lambda^{\frac{-h}{1 - h}} \\
\bar{\chi} &= h^{\frac{-h}{1 - h}} \\
\mu_k &= \int_{-\infty}^{\infty} \beta_k^{\frac{1}{1 - h}} f(\beta_k) d \beta_k = E \left(\beta_k^{\frac{1}{1 - h}} \right)
\end{split}
\end{equation}

And where the law of the unconscious statistician has been invoked to replace $f(y^*) dy^*$ with $f(\chi) d \chi$.

The output price elasticity of aggregate supply is then

\begin{equation}
\frac{\partial \ln(Q_S)}{\partial \ln(P)} = \frac{h}{1 - h}
\label{eq:PelastQS}
\end{equation}

Which is the same as the output price elasticity of supply at the farm level (equation \ref{eq:PelastYstar}).

### Is the supply curve linear?

The functional form in equation \ref{eq:QSeqP} settles two longstanding debates. Firstly, it puts to rest the debate over whether or not the aggregate supply curve is linear. In section \ref{sec:pwrLaw} it was shown that the farm supply curve is a power law with scale and convexity critically dependent upon the degree of homogeneity $h$. Likewise, equation \ref{eq:QSeqP} indicates that (insofar as Axioms 1-4 are true) the aggregate supply curve is also a power law or constant elasticity of supply curve. This becomes more evident if the equation is expressed in following compact form.

\begin{equation}
Q_S = \theta_S P^{\eta(P, Q_S)}
\label{eq:QSeqPcompact}
\end{equation}

Where

\begin{equation}
\begin{split}
\theta_S &= (y_0 \beta_w^{-1} \beta_x)^{\frac{1}{1 - h}} \mu_k F(\bar{\chi}) \\
\eta(P, Q_S) &= \frac{\partial \ln(Q_S)}{\partial \ln(P)}
\end{split}
\end{equation}

As at the farm level, both the scale and convexity of the aggregate supply curve depend critically upon the degree of homogeneity. The exponent $\eta(P, Q_S)$ implies that the aggregate supply curve is convex over $1 / 2 < h < 1$, concave over $0 < h < 1 / 2$, and linear with slope $\theta_S$ at $h = 1 / 2$.

As at the farm level, this means that, for relatively input-efficient farm populations ($h > 1 / 2$), the aggregate supply response to an increase in price is more than proportionate to the price increase; while, for relatively input-inefficient farm populations ($h < 1 / 2$), the aggregate supply response to an increase in price is less than proportionate to the price increase.

The exponent $\eta(P, Q_S)$ also implies that the supply curve approaches, but never reaches, perfect elasticity as $h$ approaches 1, and approaches, but never reaches, perfect inelasticity as $h$ approaches 0.

### Does new technology result in a pivot or shift of the supply curve?

The second debate put to rest by equation \ref{eq:QSeqP} concerns whether the research induced change in the supply curve is best modeled as a "shift" (i.e., a translation) of the curve, or as a "pivot".

If the new technology comes in the form of an increase in the basal yield (as it often does), then from equation \ref{eq:QSeqPcompact} it is clear that the new technology results in an increase in $\theta_S$, which generates a pivot of the supply curve, not a shift.

If the new technology comes in the form of an increase in one of the input elasticities of yield, then the resulting change in the supply curve is considerably more complex since changes occur in both the scale parameter $\theta_S$ and in the exponent $\eta(P, Q_S)$. Nonetheless, even in these cases, it is straightforward to see that the change is never a shift, and can be characterized as a pivot except in cases where the change in the exponent results in a change from convexity to concavity, or vice versa.
<!-- x <- seq(1, 100, 1) -->
<!-- y <- 1.5 * x^0.8 -->
<!-- y2 <-1.6 * x^1.2 -->
<!-- plot(x, y) -->
<!-- points(x, y2) -->

### Aggregating supply over varying prices

Equations \ref{eq:QSeqP} and \ref{eq:QSeqPcompact} refer to the aggregate supply for a given set of output and input prices $\{P, \mathbf{w}\}$. As discussed above, output and input prices can vary considerably within a farm population (i.e., for a given technology $y_0$, $\boldsymbol{\alpha}$), especially in the developing world. To evaluate aggregate supply across all prices, then, it is necessary to integrate the last equation over the density of $r$, giving

\begin{equation}
Q_S = N_S (y_0 \beta_x)^{\frac{1}{1 - h}} \mu_r \mu_k \int_{0}^{\bar{\chi}} \chi f(\chi) d\chi
\end{equation}

Where

\begin{equation}
\mu_r = \int_0^{\infty} r^{\frac{1}{1 - h}} g(r) dr = E \left(r^{\frac{1}{1 - h}} \right)
\end{equation}
<!-- In order to evaluate $Q_S$, it is necessary to settle upon a specific density function. For the purpose of exposition, the lognormal density is assumed. -->
<!-- Note that the adoption yield threshold is same at equilib price as at any other price -->

## Aggregate demand

Aggregate demand, is, by definition, the consumer demand envelope (equation \ref{eq:inputDemDEM}) integrated over its density $f_D \left(x_D^* \right)$.

\begin{equation}
Q_D = \int_0^{\bar{x}_D^*} x_D^* N_D f_D \left(x_D^* \right) d x_D^*
\end{equation}

Where the density is scaled by $N_D$, the number of consumers in the demand side population, and $\bar{x}_D^*$ is the upper bound on any individual consumer's demand (inequality \ref{eq:inputUpBoundDEM}).

Using equation \ref{eq:inputDemDEM} to substitute for $x_D^*$, and factoring out constants, $Q_D$ can be rewritten as follows.

\begin{equation}
Q_D = N_D \left( \frac{\alpha_D}{P} \right)^{\frac{\varepsilon - \alpha_D}{1 - h_D} + 1} \left( \frac{y_0^D b \tilde{\beta}_x^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}} \mu_k^D \int_0^{\bar{\chi}_D} \chi_D f_D \left(\chi_D \right) d \chi_D
\label{eq:QD}
\end{equation}

Where

\begin{equation}
\begin{split}
\chi_D &= \lambda_D^{\frac{-1}{1 - h_D}} \\
\bar{\chi}_D &= h_D^{\frac{-1}{1 - h_D}} \\
\mu_k^D &= \int_0^{\infty} {\beta_k^D}^{\frac{1}{1 - h_D}} f_D(\beta_k^D) d \beta_k^D = E \left( {\beta_k^D}^{\frac{1}{1 - h_D}} \right)
\end{split}
\end{equation}

And where the law of the unconscious statistician has been invoked to replace $f_D \left(x_D^* \right)dx_D^*$ with $f_D \left( \chi_D \right) d\chi_D$.

The price elasticity of aggregate demand is then

\begin{equation}
\frac{\partial \ln(Q_D)}{\partial \ln(Q_D)} = \frac{\varepsilon - \alpha_D}{1 - h_D} - 1
\label{eq:PelasDemAgg}
\end{equation}

Which is the same as the price elasticity of demand at the level of individual consumers, derived in equation \ref{eq:PelasDem}. It follows that the aggregate demand curve is likewise elastic ($\frac{\partial \ln(x_D^*)}{\partial \ln(P)} < -1$) so long as $0 < \varepsilon < \alpha_D$, and inelastic ($\frac{\partial \ln(x_D^*)}{\partial \ln(P)} < -1$) over $\alpha_D < \varepsilon < 1 - h_D + \alpha_D$. Like the consumer demand curve, the aggregate demand curve approaches, but never reaches, perfect inelasticity as $\varepsilon$ approaches its upper bound $1 - h_D + \alpha_D$.

The aggregate demand curve is a power law. This becomes clearer if $Q_D$ is written more compactly as follows.

\begin{equation}
Q_D = \theta_D P^{\eta(P, Q_D)}
\label{eq:QDcompact}
\end{equation}

Where

\begin{equation}
\theta_D = N_D (\alpha_D)^{\frac{\varepsilon - \alpha_D}{1 - h_D} + 1} \left(\frac{y_0^D b \tilde{\beta}_x^D}{\tilde{\beta}_w^D} \right)^{\frac{1}{1 - h_D}} \mu_k^D
\end{equation}

And where the exponent $\eta(P, Q_D)$ is the price elasticity of demand (equation \ref{eq:PelasDemAgg}).

### Aggregating demand over varying prices

Equation \ref{eq:QDcompact} gives the aggregate demand for a given farm output price $P$. As discussed in previous sections, output price can vary considerably within the farm population. To aggregate demand across all prices, then, it is necessary to integrate the last equation over the price density.

\begin{equation}
Q_D = N_D \left(\alpha_D \right)^{\frac{\alpha_D}{1 - h_D} + 1} (y_0^D P_D \tilde{\beta}_w^{D - 1} \beta_x^D)^{\frac{1}{1 - h_D}} \mu_P \mu_k^D \int_0^{\bar{\chi}_D} \chi_D f_D \left(\chi_D \right) d \chi_D
\end{equation}

# Equilibrium price and quantity

A closed form solution for equilibrium price $P_e$ can be derived by setting the aggregate supply and demand curves (equations \ref{eq:QSeqPcompact} and \ref{eq:QDcompact}) equal to each other and then solving for $P$ as follows.

\begin{equation}
\begin{split}
Q_S &= Q_D \\
\theta_S P^{\eta_S} &= \theta_D P^{\eta_D} \\
P_e &= P \bigr|_{Q_S = Q_D} = \left(\frac{\theta_S}{\theta_D} \right)^{\frac{1}{\eta_D - \eta_S}}
\label{eq:defPe}
\end{split}
\end{equation}

Where the shorthands $\eta_S$ and $\eta_D$ have been introduced to stand for the price elasticities of supply and demand, respectively, defined in equations \ref{eq:PelastQS} and \ref{eq:PelasDemAgg}.

The equilibrium quantity $Q_e$ then follows by evaluating either $Q_S$ or $Q_D$ at $P_e$.

\begin{equation}
Q_e = Q_S \bigr|_{P = P_e} = \left( \frac{\theta_S^{\eta_D}}{\theta_D^{\eta_S}} \right)^{\frac{1}{\eta_D - \eta_S}}
\end{equation}

## The impact of basal yield enhancing technology on equilibrium price and quantity

The percentage change in equilibrium supply given a $1$% increase in basal yield is given by

\begin{equation}
\begin{split}
\frac{\partial \ln(Q_e)}{\partial \ln(y_0)} &= \frac{\eta_D}{\eta_D - \eta_S} \frac{\partial \ln(\theta_S)}{\partial \ln(y_0)} \\
&= \frac{\eta_D \left(1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right)}{(\eta_D - \eta_S) (1 - h)}
\end{split}
\end{equation}

By Axioms 1-4, $\eta_S > 0$, $\eta_D < 0$, and $0 < h < 1$. The change in equilibrium supply given release of basal yield enhancing technology is thus positive ($\frac{\partial \ln(Q_e)}{\partial \ln(y_0)} > 0$) so long as

\begin{equation}
\partial \ln(y_0) > \boldsymbol{\alpha} \cdot \partial \ln(\mathbf{w})
\label{eq:QeIncCond}
\end{equation}

Which is always true on adopting farms. (Recall the adoption condition derived in inequality \ref{eq:ydAdoptCondy0}.)

The percentage change in equilibrium price given a $1$% increase in basal yield, meanwhile, is given by

\begin{equation}
\begin{split}
\frac{\partial \ln(P_e)}{\partial \ln(y_0)} &= \frac{1}{\eta_D - \eta_S} \frac{\partial \ln(\theta_S)}{\partial \ln(y_0)} \\
&= \frac{\left(1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right)}{(\eta_D - \eta_S)(1 - h)} \\
&= \frac{1}{\eta_D} \frac{\partial \ln(Q_e)}{\partial \ln(y_0)}
\label{eq:dLnPedLny0}
\end{split}
\end{equation}

Again, this implies that the change in equilibrium price is negative so long as inequality \ref{eq:QeIncCond} holds, which it always does on adopting farms.

The changes in equilibrium quantity and price are thus always positive and negative, respectively, under circumstances of voluntary adoption of basal yield enhancing technology. Under circumstances of an exogenous, involuntary increase in basal yield, on the other hand, inequality \ref{eq:QeIncCond} implies that it may be that $Q_e$ decreases while $P_e$ increases.

## The impact of input enhancing technology on equilibrium price and quantity

The percentage change in equilibrium supply per $1$% increase in partial yield $y_i$ is defined as follows.

\begin{equation}
\begin{split}
\frac{\partial \ln(Q_e)}{\partial \ln(y_i)} &= \frac{\partial \ln(Q_e)}{\partial \alpha_i} \\
&= \ln(\theta_S) \frac{\partial}{\partial \alpha_i} \left( \frac{\eta_D}{\eta_D - \eta_S} \right) + \frac{\eta_D}{\eta_D - \eta_S} \frac{\partial \ln(\theta_S)}{\partial \alpha_i} - \ln(\theta_D) \frac{\partial}{\partial \alpha_i} \left( \frac{\eta_S}{\eta_D - \eta_S} \right)
\end{split}
\label{eq:dLnQedai}
\end{equation}

Where

\begin{equation}
\begin{split}
\frac{\partial}{\partial \alpha_v} \left( \frac{\eta_D}{\eta_D - \eta_S} \right) &= \frac{\eta_D}{(\eta_D - \eta_S)^2} \frac{\partial \eta_S}{\partial \alpha_v} \:\:;\:\:\: \frac{\partial \eta_S}{\partial \alpha_v} = \frac{\partial}{\partial \alpha_v}\left( \frac{h}{1 - h} \right) = \frac{1}{(1 - h)^2} \\
&= \frac{\eta_D}{(\eta_D - \eta_S)^2 (1 - h)^2}
\end{split}
\end{equation}

\begin{equation}
\frac{\partial}{\partial \alpha_v} \left( \frac{\eta_S}{\eta_D - \eta_S} \right) = \frac{\partial}{\partial \alpha_v} \left( \frac{\eta_D}{\eta_D - \eta_S} \right)
\end{equation}

So that equation \ref{eq:dLnQedai} can be rewritten

\begin{equation}
\begin{split}
\frac{\partial \ln(Q_e)}{\partial \alpha_v} &= \frac{\eta_D}{(\eta_D - \eta_S)^2 (1 - h)^2} \ln \left(\frac{\theta_S}{\theta_D} \right) + \frac{\eta_D}{\eta_D - \eta_S} \frac{\partial \ln(\theta_S)}{\partial \alpha_v} \\
&= \frac{\eta_D}{\eta_D - \eta_S} \left( \frac{\ln(P_e)}{(1 - h)^2} + \frac{\partial \ln(\theta_S)}{\partial \alpha_v} \right)
\end{split}
\end{equation}

Where equation \ref{eq:defPe} has been invoked to substitute for $\ln(\theta_S / \theta_D)$ in the second line.

This implies that the change in aggregate equilibrium supply given release and voluntary uptake of input enhancing technology is positive so long as

\begin{equation}
P_e > e^{-(1 - h)^2 \frac{\partial \ln(\theta_S)}{\partial \alpha_v}}
\label{eq:QePoscondAi}
\end{equation}

Where the derivative $\frac{\partial \ln(\theta_S)}{\partial \alpha_v}$ works out to

\begin{equation}
\begin{split}
\frac{\partial \ln(\theta_S)}{\partial \alpha_v} &= \frac{1}{1 - h} \left[1 - \boldsymbol{\alpha} \cdot \frac{\partial \mathbf{w}}{\partial \alpha_v} + \ln(\frac{\alpha_v}{w_v}) + \ln(\theta_S) - \ln(\mu_k) - \ln(F(\bar{\chi})) \right] + \frac{\partial \ln(\mu_k)}{\partial \alpha_v} + \frac{\ln(F(\bar{\chi}))}{\partial \alpha_v}
\label{eq:dLnThetaSdai}
\end{split}
\end{equation}

Without toiling through the considerable ambiguity of the derivative in equation \ref{eq:dLnThetaSdai}, it is already clear from the farm level analysis in section \ref{sec:techChangeAi} that, under Axioms 1-3, all adopting farms find it in their best economic interest to increase output given the new input enhancing technology. It follows, therefore, that $\frac{\partial \ln(Q_e)}{\partial \alpha_v} > 0$. Combining this knowledge with the aggregate expansion condition in inequality \ref{eq:QePoscondAi}, it follows, moreover, that

\begin{equation}
\frac{\partial \ln(\theta_S)}{\partial \alpha_v} > -\frac{\ln(P_e)}{(1 - h)^2}
\end{equation}

The percentage change in equilibrium price given a $1$% increase in the partial yield $y_v$, meanwhile, works out to

\begin{equation}
\begin{split}
\frac{\partial \ln(P_e)}{\partial \ln(y_v)} &= \frac{\partial \ln(P_e)}{\partial \alpha_v} \\
&= \frac{1}{\eta_D - \eta_S} \left( \frac{\ln(P_e)}{(1 - h)^2} + \frac{\partial \ln(\theta_S)}{\partial \alpha_v} \right) \\
&= \frac{1}{\eta_D} \frac{\partial \ln(Q_e)}{\partial \alpha_v}
\label{eq:dLnPedai}
\end{split}
\end{equation}

By which it follows that the change in equilibrium price under release and voluntary uptake of the input enhancing technology is negative so long as inequality \ref{eq:QePoscondAi} is true.

Under circumstances of an involuntary increase in the input elasticity, on the other hand, inequality \ref{eq:QePoscondAi} implies that equilibrium supply may decrease while the equilibrium price rises.

## Estimation of the technology adoption rate at equilibrium

Estimation of the technology adoption rate hinges upon whether the technology is basal yield or input enhancing, and hence upon the corresponding assumed density function (Axiom 7).

In the case of basal yield enhancing technology,

\begin{equation}
\frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} \bigr|_{P = P_e} = Py^* \left( \frac{\partial \ln(P_e)}{\partial \ln(y_0)} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0) + 1} \right) > 0
\end{equation}

Using equation \ref{eq:dLnPedLny0} to substitute for $\frac{\partial \ln(P_e)}{\partial \ln(y_0)}$, this can be rewritten as follows.

\begin{equation}
\frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} \bigr|_{P = P_e} = Py^*\left(\frac{u}{(\eta_D - \eta_S) (1 - h)} + u \right) \:\:\:; \:\: u = 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \end{equation}

Applying the adoption condition $\frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} \bigr|_{P = P_e} > 0$ and simplifying,

\begin{equation}
\begin{split}
\frac{1}{(\eta_D - \eta_S)(1 - h)} &> -1 \\
\frac{1}{1 - h} &< -(\eta_D - \eta_S) \\
\frac{-1 + h}{1 - h} &> \eta_D \\
-1 &> \eta_D
\end{split}
\end{equation}

The domain of $\eta_D$ defined in \ref{eq:domainEtaD} then implies the following adoption rate
<!-- inequality \ref{eq:ydAdoptCondy0} implies the following adoption rate.  -->

at equilibrium

\begin{equation}
a = \frac{\int_{-infty}^{-1} g(\eta_D) d \eta_D}{\int_{-infty}^{\varepsilon - 1} g(\eta_D) d \eta_D}
\end{equation}

Adoption only possible when $\varepsilon < \alpha_D$.

Where $g(\eta_D)$ is the assumed density of $\eta_D$.

In the case of input enhancing technology, inequality \ref{eq:adoptCondai} implies the following adoption rate.

\begin{equation}
a = \frac{\int_{\underline{y}^*}^{\bar{y}^*} f(y^*) dy^*}{\int_{0}^{\bar{y}^*} f(y^*) dy^*}
\end{equation}

Where $f(y^*)$ is the assumed density of $y^*$. More compactly,

\begin{equation}
a = \frac{F(\bar{y}^*) - F(\underline{y^*_{\mathcal{L}}})}{F(\bar{y}^*)}
\end{equation}

Where $F(\tau)$ is the cumulative distribution function corresponding to $f(y^*)$.

\begin{equation}
F(\tau) = \int_{0}^{\tau} f(y^*) dy^*
\end{equation}
<!-- Moreover, it is first necessary to convert the technology adjusted price/productivity tightrope into a form that can be evaluated as a bound of integration. This is done by integrating and rearranging inequality \ref{eq:ydAdoptCondy0}. -->
<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- \int \partial \ln(y_0) &> \int \boldsymbol{\alpha} \cdot \partial \ln(\mathbf{w}) - h \int \partial \ln(P) \\ -->
<!-- \ln(y_0) &> \boldsymbol{\alpha} \cdot \ln(\mathbf{w}) - h \ln(P) + K -->
<!-- \end{split} -->
<!-- \end{equation} -->
<!-- Assuming the constant of integration $K$ is zero, -->
<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- -\ln(y_0) &< \ln(r) \\ -->
<!-- 1 / y_0 &< r -->
<!-- \end{split} -->
<!-- \end{equation} -->
<!-- _Adoption rate is endogenous to the model._ -->

# Measuring the welfare impact of new technology
<!-- The aggregate change in net benefit resulting from new technology -->

The aggregate change in net benefit, or welfare impact, resulting from new technology uptake is comprised of two components: 1) the aggregate change in producer net benefit, and 2) the aggregate change in demand side net benefit.

Again, impacts vary considerably depending upon whether the technology change is basal yield enhancing or input enhancing.

## Aggregate change in producer net benefit, basal yield enhancing technology

For a given basal yield enhancing technology, the aggregate change in producer net benefit $\psi^S$ is, by definition, the change in farm level net benefit integrated over its density.

The change in farm level net benefit due to basal yield enhancing technology is just the percentage increase in the basal yield times the percentage change in net benefit per $1$% change in the basal or partial yield, times the baseline net benefit. Mathematically, this may be expressed as follows.

\begin{equation}
\begin{split}
\text{Change in Net Benefit} &= \rho_0 \frac{\partial \ln(\mathcal{L}^*)}{\partial \ln(y_0)} \mathcal{L}^* \\
&= \rho_0 \frac{\partial \mathcal{L}^*}{\partial \ln(y_0)}
\end{split}
\end{equation}

Where $\rho_q$ is the percentage change in basal or partial yield, as the case may be. The aggregate change is thus

\begin{equation}
\psi^S = \rho_0 \int \frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} v \left(\frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} \right) d \left( \frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} \right)
\end{equation}

Recalling the expression for $\frac{\partial \ln(\mathcal{L}^*)}{\partial \ln(y_0)}$ derived in equation \ref{eq:prodNBy0}, this can be rewritten

\begin{equation}
\begin{split}
\psi^S &= \rho_0 \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} + \frac{\partial \ln(P)}{\partial \ln(y_0)} \right) P \int y^* f(y^*) d y^* \\
&= \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} + \frac{\partial \ln(P)}{\partial \ln(y_0)} \right) P Q
\end{split}
\end{equation}

Where the law of the unconscious statistician has been invoked to replace $v \left( \frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} \right) d \left( \frac{\partial \mathcal{L}^*}{\partial \ln(y_0)} \right)$ with $f(y^*) d y^*$.

At equlibrium, this becomes

\begin{equation}
\psi_e^S = \rho_0 \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} + \frac{\partial \ln(P_e)}{\partial \ln(y_0)} \right) P_e Q_e
\end{equation}

Using equation \ref{eq:dLnPedLny0} to substitute for $\frac{\partial \ln(P_e)}{\partial \ln(y_0)}$, this becomes

\begin{equation}
\begin{split}
\psi_e^S &= \rho_0 \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} + \frac{1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)}}{(\eta_D - \eta_S) (1 - h)} \right) P_e Q_e \\
&= \rho_0 \left(1 + \frac{1}{(\eta_D - \eta_S) (1 - h)} \right) \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right) P_e Q_e \\
&= \frac{\varepsilon -\alpha_D}{(\eta_D - \eta_S) (1 - h_D)} \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right) P_e Q_e
\end{split}
\end{equation}

## Aggregate change in demand side net benefit, basal yield enhancing technology

For a given basal yield enhancing technology, the aggregate change in demand side net benefit $\psi^D$ is derived through an analogous set of steps. By definition, the aggregate change in demand side net benefit is the change in consumer level net benefit integrated over its density.

\begin{equation}
\psi^D = \rho_0^D \int \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_0)} \mathcal{L}_D^* v_D \left( \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_0)} \mathcal{L}_D^* \right) d \left( \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_0)} \mathcal{L}_D^* \right)
\end{equation}

But $\frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_0)} \mathcal{L}_D^* = \frac{\partial \mathcal{L}_D^*}{\partial \ln(y_0)}$, and so, recalling the expression for $\frac{\partial \mathcal{L}_D^*}{\partial \ln(y_0)}$ derived in equation \ref{eq:consNBy0}, the integral can be rewritten

\begin{equation}
\begin{split}
\psi^D &= \rho_0^D (\varepsilon - \alpha_D) P_D \frac{\partial \ln(P)}{\partial \ln(y_0)} \int y_D^* f_D(y_D^*) d y_D^* \\
&= (\varepsilon - \alpha_D) P_D Q^D \frac{\partial \ln(P)}{\partial \ln(y_0)}
\end{split}
\end{equation}

Where the law of the unconscious statistician has been invoked to replace $v \left( \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_0)} \mathcal{L}_D^* \right) d \left( \frac{\partial \ln(\mathcal{L}_D^*)}{\partial \ln(y_0)} \mathcal{L}_D^* \right)$ with $f(y_D^*) d y_D^*$.

Here it is important to distinguish $Q^D$, the demand side output, from $Q_D$, the demand curve. When the consumers are mills or factories, $Q^D$ has an interpretation in concrete terms of aggregate output of flour, starch, bioethanol, etc., as the case may be. When the consumers are people, $Q^D$ must be interpreted in more abstract terms of aggregate utility.

At equilibrium,

\begin{equation}
\begin{split}
\psi_e^D &= \rho_0^D (\varepsilon -\alpha_D) P_D Q^D \frac{\partial \ln(P_e)}{\partial \ln(y_0)} \\
&= \rho_0^D \frac{\varepsilon - \alpha_D}{(\eta_D - \eta_S) (1 - h)} P_D Q^D \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right) P_D Q^D
\end{split}
\end{equation}

## Aggregate net change in net benefit, basal yield enhancing technology

Adding $\psi_e^S$ and $\psi_e^D$ together gives the total aggregate change in net benefit. 

\begin{equation}
\begin{split}
\psi_e &= \psi_e^S + \psi_e^D \\
&= \frac{\varepsilon -\alpha_D }{\eta_D - \eta_S} \left( 1 - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \ln(y_0)} \right) \left(\rho_0 \frac{P_e Q_e}{1 - h_D} + \rho_0^D \frac{P_D Q^D}{1 - h} \right)
\end{split}
\end{equation}

Dividing $\psi_e^S$ and $\psi_e^D$ by $\psi_e$ gives the respective shares of net benefit.

\begin{equation}
\frac{\psi_e^S}{\psi_e^D} = \frac{(1 - h) \rho_0 P_e Q_e}{(1 - h) \rho_0 P_e Q_e + (1 - h_D) \rho_0^D P_D Q^D}
\end{equation}

\begin{equation}
\frac{\psi_e^D}{\psi_e^D} = \frac{(1 - h_D) \rho_0^D P_D Q^D}{(1 - h) \rho_0 P_e Q_e + (1 - h_D) \rho_0^D P_D Q^D}
\end{equation}

## Aggregate change in producer net benefit, input enhancing technology

## Aggregate change in demand side net benefit, input enhancing technology

## Aggregate net change in net benefit, input enhancing technology

## Producer and consumer surplus: a problematic welfare measure

Many economists prefer to express benefits in terms of "consumer surplus" and "producer surplus". This approach is problematic for several reasons, some of which are elucidated by... []. Here, I limit the discussion to issues relevant to the .

Consumer surplus is defined as "the level of benefit (utility) that consumers derive by being able to purchase a product for a price that is less than the maximum they would be willing to pay" [new palgrave]. x has recently demonstrated that consumer surplus is proportionate to consumer welfare only under highly restrictive, unrealistic conditions [].

First of all, the definition of  assumes that consumers _always_ benefit by paying a price that is lower than some higher benchmark or maximum price. The only circumstance under which this would be unambiguously true is if the prices paid were somehow independent from the corresponding quantities purchased, such that the same quantity of a good could be acquired at different prices. But this is never true in any economic context. On the contrary, there exists a one-to-one correspondence between price and quantity called the demand curve, which implies a tradeoff between price and quantity. Lower prices come at the cost of lower quantities acquired, while higher quantities come at the cost of higher prices paid. To determine whether or not a change in price results in increased or decreased net benefit the 

Given the demand model derived from Axioms 1-4 in equation \ref, moreover, the consumer's maximum price is infinity; and the level of net benefit corresponding to the maximum price (derived in equation \ref) is either infinity or 0, depending upon the relation between the farm price $P$ and output price $P_D$ (in particular, depending upon whether $\varepsilon$ is greater than or less than $alpha_D$).  

The demand side net benefit envelope derived in equation. 

For an individual consumer, this is expressed mathematically as follows.




\begin{equation}
\omega^D = \mathcal{L}_D^* (P_{max}) - \mathcal{L}_D^*(P_e)
\end{equation}

Given the form of $\mathcal{L}_D^*$ derived from Axioms 1 and 2 in equation \ref{eq:NBenvDem}, $P_{max} = \infty$, and
<!-- $\mathcal{L}_D^* = $ -->

\begin{equation}
\mathcal{L}_D^* = (1 - h_D) P^{\frac{\varepsilon - \alpha_D}{1 - h_D}} \left(y_0^D b \frac{\beta_x^D \beta_k^D}{\tilde{\beta}_w^D \lambda^{h_D}} \right) + \lambda_D B_D
\label{eq:NBenvDem}
\end{equation}



By convention, consumer surplus is calculated as the area under the demand curve between infinity and the equilibrium price.

Conversely, producer surplus is the level of benefit that producers derive by selling their product at a price that is higher than the minimum they would be willing to accept. By convention, producer surplus is calculated as the area between the equilibrium price and the supply curve.

"[t]he excess of the price which he would be willing to pay rather than go without the thing, over that which he actually does pay, is the economic measure of this surplus satisfaction".[Marshall]


Producer surplus is defined as the area under the supply curve evaluated from zero up to the quantity offered at the equilibrium price.   the difference between the equilibrium price and the price 

# Example application

Research question: How much of the non-adopting maize farm population in Kenya can be induced to adopt hybrid maize given different levels of seed and/or fertilizer subsidy? And what are the corresponding impacts on the equilibrium maize supply and price in Kenya?

## Data

## Estimation

## Results

## Conclusion

# References {-}

<div id="refs"></div>

\pagebreak

## Appendix

<!-- ### Derivation of the baseline yield threshold for adoption of input enhancing technology \label{sec:derivYdCond1} -->

<!-- \begin{equation} -->
<!-- \mathcal{L}^* = Py^* - \lambda (C^* - B) -->
<!-- \end{equation} -->

<!-- But recall that dotting the first order conditions in equations \ref{eq:eqFOC} gives the handy expression -->

<!-- \begin{equation} -->
<!-- P y^* h - \lambda C^* = 0 -->
<!-- \end{equation} -->

<!-- Hence, using this to substitute for $\lambda C^*$ in the previous equation and simplifying, -->

<!-- \begin{equation} -->
<!-- \mathcal{L}^* = (1 - h) P y^* + \lambda B -->
<!-- \end{equation} -->

<!-- Differentiating with respect to $\alpha_i$, -->

<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- \frac{\partial \mathcal{L}^*}{\partial \alpha_i} &= P [-y^* + (1 - h) \frac{\partial y^*}{\partial \alpha_i}] \\ -->
<!-- &= (1 - h) P y^* (\frac{\partial \ln(y^*)}{\partial \alpha_i} - \frac{1}{1 - h}) -->
<!-- \end{split} -->
<!-- \end{equation} -->

<!-- The adoption condition $\frac{\partial \mathcal{L}^*}{\partial \alpha_i} > 0$ thus implies -->

<!-- \begin{equation} -->
<!-- \frac{\partial \ln(y^*)}{\partial \alpha_i} > \frac{1}{1 - h} -->
<!-- \label{eq:adoptCondInpElasAPP} -->
<!-- \end{equation} -->

<!-- The derivative on the lefthand side of this inequality works out as follows. -->

<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- \frac{\partial \ln(y^*)}{\partial \alpha_i} &= \frac{\partial}{\partial \alpha_i} \left[\frac{1}{1 - h} (\ln(y_0) - h \ln(P / \lambda) - \ln(\beta_w) + \ln(\beta_x) + \ln(\beta_k)) \right] \\ -->
<!-- &= \frac{1}{1 - h} \left(\ln(y^*) + \ln(P / \lambda) + h \frac{\partial \ln(P)}{\partial \alpha_i} - \boldsymbol{\alpha} \cdot \frac{\partial \mathbf{w}}{\partial \alpha_i} + \ln(\alpha_i / w_i) + 1 \right) -->
<!-- \end{split} -->
<!-- \label{eq:dLnYstardaiAPP} -->
<!-- \end{equation} -->

<!-- Substituting this into the adoption condition (equation \ref{eq:adoptCondInpElasAPP}) and simplifying, -->

<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- \frac{1}{1 - h} \left(\ln(y^*) + \ln(P / \lambda) + h \frac{\partial \ln(P)}{\partial \alpha_i} - \boldsymbol{\alpha} \cdot \frac{\partial \mathbf{w}}{\partial \alpha_i} + \ln(\alpha_i / w_i) + 1 \right) &= \frac{1}{1 - h} \\ -->
<!-- \ln(y^*) + \ln(P / \lambda) + h \frac{\partial \ln(P)}{\partial \alpha_i} - \boldsymbol{\alpha} \cdot \frac{\partial \mathbf{w}}{\partial \alpha_i} + \ln(\alpha_i / w_i) > 0 -->
<!-- \end{split} -->
<!-- \end{equation} -->

<!-- But note that the yield envelope can be solved to give an expression for the term $\ln(P / \lambda)$ as follows. -->

<!-- \begin{equation} -->
<!-- \ln \left(\frac{P}{\lambda} \right) = 1 / h [(1 - h) \ln(y^*) - \ln(y_0) + \ln(\beta_w) - \ln(\beta_x) - \ln(\beta_k)] -->
<!-- \label{eq:LnPoLambda} -->
<!-- \end{equation} -->

<!-- Substituting this into the previous equation and solving for $\ln(y^*)$, -->

<!-- \begin{equation} -->
<!-- \begin{split} -->
<!-- \ln(y^*) &> \ln(w_i / \alpha_i) + \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_i} - h \frac{\partial \ln(P)}{\partial \alpha_i} - 1 / h ((1 - h) \ln(y^*) - \ln(y_0 \beta_w^{-1} \beta_x \beta_k)) \\ -->
<!-- \ln(y^*) &> (1 - h) \left(\ln(w_i / \alpha_i) + 1 / h \ln(y_0 \beta_w^{-1} \beta_x \beta_k) + \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_i} - h \frac{\partial \ln(P)}{\partial \alpha_i} -->
<!-- \end{split} -->
<!-- \end{equation} -->

<!-- Taking the exponential function then gives the baseline yield threshold for adoption of the input enhancing technology. -->

<!-- \begin{equation} -->
<!-- y^* > \left[w_i / \alpha_i (y_0 \beta_w^{-1} \beta_x \beta_k)^{1 / h} e^{\boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_i} - h \frac{\partial \ln(P)}{\partial \alpha_i}} \right] -->
<!-- \label{eq:ydCond1APP} -->
<!-- \end{equation} -->

<!-- This condition says that adoption will result in higher net benefit on farms with yields above the righthand side of the condition, but lower net benefit on farms with baseline yields below the righthand side of the condition. Assuming technology adoption is voluntary and that farms want to maximize their net benefit, the theory derived above says that those farms with baseline yields below the righthand side of the condition will not adopt. -->

<!-- Given an exogenously imposed, involuntary change in input elasticity of yield, condition \ref{eq:ydCond1APP} implies that the lower centiles of the yield distribution would suffer a decrease in their net benefit. -->

<!-- ### Derivation of the baseline yield threshold for increased output under input enhancing technology \label{sec:derivYdIncCond1} -->

<!-- Applying the increased output condition ($\frac{\partial y^*}{\partial \alpha_i}$) to equation \ref{eq:dLnYstardaiAPP} and simplifying gives -->

<!-- \begin{equation} -->
<!-- \ln(y^*) + \ln(P / \lambda) + h \frac{\partial \ln(P)}{\partial \alpha_i} - \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_i} + \ln(\alpha_i / w_i + 1) > 0 -->
<!-- \end{equation} -->

<!-- Using equation \ref{eq:LnPoLambda} to substitute for the term $\ln(P / \lambda)$ and solving for $\ln(y^*)$, -->

<!-- \begin{equation} -->
<!-- \ln(y^*) > (1 - h) \left(1 / h \ln(y_0 \beta_w^{-1} \beta_x \beta_k) - \ln(\alpha_i / w_i) + \boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_i} - h \frac{\partial \ln(P)}{\partial \alpha_i} - 1 \right) -->
<!-- \end{equation} -->

<!-- Taking the exponential function then gives the baseline yield threshold for increased output under input enhancing technology. -->

<!-- \begin{equation} -->
<!-- y^* > \left[w_i / \alpha_i (y_0 \beta_w^{-1} \beta_x \beta_k)^{1 / h} e^{\boldsymbol{\alpha} \cdot \frac{\partial \ln(\mathbf{w})}{\partial \alpha_i} - h \frac{\partial \ln(P)}{\partial \alpha_i} - 1} \right]^{1 - h} -->
<!-- \label{eq:YdIncCond1} -->
<!-- \end{equation} -->

<!-- Farms with baseline yields greater than the righthand side of this condition find it in their best interest to increase output given new input enhancing technology. Note that the righthand side of this condition is less than the righthand side of the baseline yield adoption threshold (inequality \ref{eq:ydCond1APP}) by a factor of $e^{h - 1}$. Therfore, all adopting farms find it in their best interest to increase output. -->

<!-- Given an exogenously imposed, involuntary change in input elasticity of yield, condition \ref{eq:YdIncCond1} implies that the lower centiles of the yield distribution would choose to reduce ouput. -->











<!-- Clipboard: -->
<!-- In 1944, John Von Neumann et al. observed that "part of the feeling of dissatisfaction with the mathematical treatment of economic theory derives largely from the fact that frequently one is offered not proofs but mere assertions which are really no better than the same assertions given in literary form" and from the fact that genuine results are often confused with "very valuable surmises and inspiring anticipations of results" (2006). -->
<!-- It can be added that these "assertions", "valuable surmises", and "inspiring anticipations of results", when made by celebrated scholars, have often taken on the character of, if not proofs, then axioms that-consciously or unconsciously-prefigure all subsequent inquiry, regardless of their truth value. In a recent critique of macroeconomic models, former World Bank director Paul Romer characterized such economic assertions as "Facts With Unknown Truth Value" (2016). Here we prefer to use the term "axioms" or "celebrity axioms", in order to underscore that these assertions are not verified facts, but rather, as Von Neumann said, the opinions and surmises of celebrated scholars. -->
<!-- The infallible, axiomatic air that is retrospectively attributed to these surmises contrasts with the provisional, diffident, and sometimes mistaken terms in which they were originally uttered. Consider, for example, these early formulations of the concept of elasticity: [.]. A review of the foundational works (of Marshall, Jevons, and Pareto, in particular) turns up many such awkward moments and downright errors in mathematical reasoning. -->
<!-- But no one reads the classics anymore. [But "no one is paying attention to the math," writes Romer.] The codification of assertive statements about economic systems into formal language has too often been premature and over-confident, leading to the situation identified by Von Neumann et al., where "economic problems [are] not formulated clearly and are often stated in such vague terms as to make mathematical treatment a priori appear hopeless because it is quite uncertain what the problems really are" (2006). Moreover, much scientific inquiry has then been organized around, and mistaken for, the defense and preservation of badly incomplete, inconsistent, and/or over-simplistic formalisms, making it difficult for subsequent generations of researchers to distinguish between the genuine challenges posed by the problem to be addressed and "challenges" which are merely artifacts of the formalism. The very merit of research questions is likewise judged not from elementary theoretical premises or empirical observations, but rather on the basis of the question's compatibility with the predominant narrative that has grown out of the celebrity axioms. -->
<!-- Much economic theory is built upon  are  The theory of the firm, for example, is built upon the linear demand curve. But this implies either homothetic preferences or, worse, that all households have the same income. Either one of these assumptions is  especially inappropriate in the agricultural sector, where empirical observations (Engel's Law) rule out homothetic preferences.     that they invite confusion  has been that they are then all the more difficult to correct if they arWhile one can certainly point to instances where the mathematical codification of assertions has led to new insights, the works of . confuses theory with empirical content, adding a shield of opacity to cover academically political motives. Romer calls such indiscretions "mathiness". . elasticity diffidence. -->


<!-- Take the upward sloping supply curve as an example. Many problems in economics are considered intractable given the "difficulty" of aggregating firm supply curves into an industry wide curve. But this "difficulty" refers merely to the difficulty of adding up a large number of discrete linear equations. Why discrete linear equations? Because celebrated economists long ago decided that this was equivalent to .  -->

<!--  "There is no point in using exact methods where there is no clarity in the concepts and issues to which they are to be applied" (Neumann et al., 2006). -->
<!-- . -->
<!-- One axiom is that of the upward sloping supply curve.  -->
<!-- . -->



<!-- In economics,  -->


<!-- To precisely determine the supply curve shift "would require either (a) precise econometric evidence or (b) detailed information on the effects on individual agents, details of industry structure including details on exit and entry of firms, and a complete theory of aggregation. This information is not available; assumptions are unavoidable" (Alston, Norton, & Pardey, 1995). -->
